// For license information, see `http://ep00.epimg.net/js/gdt/0681c221600c/a81a11db86dc/launch-f2b3c876fe9c.js`.
window._satellite=window._satellite||{},window._satellite.container={buildInfo:{minified:!0,buildDate:"2022-12-20T17:36:15Z",turbineBuildDate:"2022-09-28T18:15:16Z",turbineVersion:"27.4.0"},environment:{id:"ENd519c7a61d09411fa2fe65eb49a20def",stage:"production"},dataElements:{geoRegion:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.geoRegion"}},canonicalURL:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.canonicalURL"}},privateMode:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.privateMode"}},referringURL:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.referringURL"}},"date:gmt":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.gmt"}},paywall:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall"}},"omniture:hourSection":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){if(document.documentMode)return"Internet Explorer Visitors";var e=s.getTimeParting("Europe/Madrid"),t="not-set";try{if(e&&e.length>0){e=e.split("|");for(var n=!1,a=0,r=e.length;a<r&&!n;a++)if(-1!=e[a].indexOf("time")){t=e[a].trim().replace(/time\=/gi,"").replace(/ /gi,""),n=!0;var i=/^([0-9]{1,2}):([0-2])[0-9]([P|A]M)/.exec(t),o=/^([0-9]{1,2}):([3-5])[0-9]([P|A]M)/.exec(t);i?t=i[1]+":00"+i[3]:o?t=o[1]+":30"+o[3]:(t="not-set",_satellite.logger.error("Error in <omniture:hourSection> dataElement:tramo horario no encontrado"))}}}catch(e){_satellite.logger.error("Error in <omniture:hourSection> dataElement: "+e)}return t}}},"omniture:newRepeat":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return s.getNewRepeat()}}},destinationURL:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.destinationURL"}},"AppMeasurement:version":{modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"DTM.s.version"}},test:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.test"}},"device:type":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"device.type"}},pageID:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.pageID"}},ssl:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.ssl"}},"date:minutes":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.minutes"}},"paywall:active":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.active"}},"omniture:articleDays":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return DTM.s.articleDays(_satellite.getVar("creationDate"))}}},"omniture:trackingServer":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"1"==_satellite.getVar("ssl")?s.trackingServerSecure:s.trackingServer}}},editionNavigation:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.editionNavigation"}},"paywall:counter":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.counter"}},"DTM:version":{modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"DTM.version"}},pageInstanceID:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInstanceID"}},onsiteSearchResults:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.onsiteSearchResults"}},primaryCategory:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.category.primaryCategory"}},"user:type":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.type"}},"user:country":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.country"}},"omniture:brandedContent":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"1"==_satellite.getVar("brandedContent")?_satellite.getVar("pageName"):""}}},"omniture:paywall:contentBlocked":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"1"==_satellite.getVar("paywall:contentBlocked")?"cerrado":"abierto"}}},"omniture:privateMode":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"1"==_satellite.getVar("privateMode")?"true":"0"==_satellite.getVar("privateMode")?"false":"not-set"}}},referringDomain:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.referringDomain"}},"user:ID":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.ID"}},pageType:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.category.pageType"}},sysEnv:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.sysEnv"}},clickOrigin:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.clickOrigin"}},"paywall:signwallType":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.signwallType"}},"Visitor:version copy":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"undefined"!=typeof Visitor&&void 0!==Visitor.version?"Visitor "+Visitor.version:"Visitor error"}}},"omniture:author":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return DTM.tools.omniture.getDL().authors}}},"omniture:articleURL":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"articulo"==_satellite.getVar("pageType")?"D=g":""}}},businessUnit:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.businessUnit"}},signwall:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.signwallType"}},newsletters:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.newsletters"}},encoded:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.encoded"}},"queryParam:event":{defaultValue:"",modulePath:"core/src/lib/dataElements/queryStringParameter.js",settings:{name:"event",caseInsensitive:!0}},"omniture:tags":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return DTM.tools.omniture.getDL().tags}}},onsiteSearch:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.onsiteSearch"}},"user:profileID":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.profileID"}},"queryParam:prod":{defaultValue:"",modulePath:"core/src/lib/dataElements/queryStringParameter.js",settings:{name:"prod",caseInsensitive:!0}},omniture:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e={};try{e=window.DTM.tools.omniture.getDL()}catch(t){e={}}return e}}},platform:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.platform"}},"omniture:articleTitle":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"articulo"==_satellite.getVar("pageType")?_satellite.getVar("pageTitle"):""}}},pageTypology:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.pageTypology"}},"date:dstStart":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.dstStart"}},author:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.author"}},"user:registeredUserAMP":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.registeredUserAMP"}},"device:platform":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"device.platform"}},brandedContent:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.brandedContent"}},"queryParam:rel":{modulePath:"core/src/lib/dataElements/queryStringParameter.js",settings:{name:"rel",caseInsensitive:!0}},"date:dstEnd":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.dstEnd"}},facebook:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e={};try{e=window.DTM.tools.facebook.getDL()}catch(t){e={}}return e}}},"queryParam:event_log":{defaultValue:"",modulePath:"core/src/lib/dataElements/queryStringParameter.js",settings:{name:"event_log",caseInsensitive:!0}},comscore:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e={};try{e=window.DTM.tools.comscore.getDL()}catch(t){e={}}return e}}},"date:year":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.year"}},urlParams:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.urlParams"}},"paywall:access":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.access"}},domain:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.domain"}},pageTitle:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.pageTitle"}},"date:seconds":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.seconds"}},"user:registeredUser":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.registeredUser"}},"user:name":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.name"}},videoContent:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.videoContent"}},"device:userAgent":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"device.userAgent"}},"omniture:weekDay":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=s.getTimeParting(),t="";try{if(e&&e.length>0){e=e.split("|");for(var n=!1,a=0,r=e.length;a<r&&!n;a++)-1!=e[a].indexOf("day")&&(t=e[a].trim().toLowerCase().replace(/day\=/gi,""),t=(new Date).toLocaleString("es-ES",{weekday:"long"}),n=!0)}}catch(e){_satellite.logger.error("Error in <omniture:weekDay> dataElement: "+e)}return t}}},"paywall:contentBlocked":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.contentBlocked"}},cms:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.cms"}},chartbeat:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e={};try{e=window.DTM.tools.chartbeat.getDL()}catch(t){e={}}return e}}},siteID:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.siteID"}},campaign:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.campaign"}},"device:language":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"device.language"}},"date:fullYear":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.fullYear"}},date:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date"}},subCategory1:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.category.subCategory1"}},"queryParam:o":{defaultValue:"",modulePath:"core/src/lib/dataElements/queryStringParameter.js",settings:{name:"o",caseInsensitive:!0}},"user:subscriptions":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.subscriptions"}},"queryParam:bid":{modulePath:"core/src/lib/dataElements/queryStringParameter.js",settings:{name:"bid",caseInsensitive:!0}},"date:month":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.month"}},elpais:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e={};try{e=window.DTM.tools.elpais.getDL()}catch(t){e={}}return e}}},articleID:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.articleID"}},liveContent:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.liveContent"}},onsiteSearchTerm:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.onsiteSearchTerm"}},translatePage:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.translatePage"}},"device:cookieEnabled":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"device.cookieEnabled"}},"paywall:freePage":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.freePage"}},audioContent:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.audioContent"}},language:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.language"}},"omniture:visitNumDay":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return DTM.s.getVisitNum("d","s_vnum_d","s_invisit_d")}}},pageHeight:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.pageHeight"}},event:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"event"}},"omniture:registeredUser":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"1"==_satellite.getVar("user:registeredUser")?"logueado":"0"==_satellite.getVar("user:registeredUser")?"anonimo":"not-set"}}},publishDate:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.publishDate"}},urlAMP:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.urlAMP"}},"omniture:videoContent":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return!0===_satellite.getVar("videoContent")?"1":!1===_satellite.getVar("videoContent")?"0":"not-set"}}},krux:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e={};try{e=window.DTM.tools.krux.getDL()}catch(t){e={}}return e}}},"queryParam:mid":{modulePath:"core/src/lib/dataElements/queryStringParameter.js",settings:{name:"mid",caseInsensitive:!0}},"omniture:visitNumMonth":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return DTM.s.getVisitNum()}}},thematic:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.thematic"}},"date:hours":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.hours"}},creationDate:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.creationDate"}},server:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.server"}},"cookie:visitorID":{defaultValue:"",modulePath:"core/src/lib/dataElements/cookie.js",settings:{name:"AMCV_2387401053DB208C0A490D4C%40AdobeOrg"}},updateDate:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.updateDate"}},secondaryCategories:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.category.secondaryCategories"}},subCategory2:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.category.subCategory2"}},"paywall:contentAdType":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.contentAdType"}},loadType:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.loadType"}},"paywall:productList":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return{629:{sku:"IDPPAR0001",access:"elpais.com"},630:{sku:"IMGPAR0004",access:"elpais.com"},631:{sku:"IDPPAR0003",access:"elpais.com"},719:{sku:"IDPPAR0002",access:"elpais.com"},720:{sku:"IMGPAR0005",access:"elpais.com"},721:{sku:"CDPEMR0006",access:"elpais.com"},733:{sku:"CDGEMP0008",access:"elpais.com"},739:{sku:"IDGPAR0019",access:"elpais.com"},740:{sku:"IDPPAR0009",access:"elpais.com"},741:{sku:"IDGEMR0011",access:"elpais.com"},742:{sku:"CDGCOR0012",access:"elpais.com"},743:{sku:"CDGCOR0013",access:"elpais.com"},744:{sku:"CDGDEM0014",access:"elpais.com"},745:{sku:"CDGDEM0015",access:"elpais.com"},746:{sku:"CDGDEM0017",access:"elpais.com"},747:{sku:"CDGDEM0016",access:"elpais.com"},748:{sku:"CDGVIP0018",access:"elpais.com"},749:{sku:"IDPEMP0022",access:"elpais.com"},750:{sku:"CDGPAR0021",access:"elpais.com"},751:{sku:"CDGEMP0023",access:"elpais.com"},754:{sku:"IDPPAR0024",access:"elpais.com"},755:{sku:"CDPEMR0025",access:"elpais.com"},756:{sku:"CDPEMR0026",access:"elpais.com"},757:{sku:"CDGDEM0027",access:"elpais.com"},758:{sku:"CDPEMR0029",access:"elpais.com"},759:{sku:"CDPEMR0030",access:"elpais.com"},760:{sku:"CDPEMR0031",access:"elpais.com"},761:{sku:"CDPEMR0032",access:"elpais.com"},762:{sku:"CDPEMR0034",access:"elpais.com"},763:{sku:"CDPEMR0035",access:"elpais.com"},764:{sku:"CDPEMR0036",access:"elpais.com"},765:{sku:"CDPEMR0037",access:"elpais.com"},766:{sku:"CDPEMR0033",access:"elpais.com"},767:{sku:"CDPEMR0038",access:"elpais.com"},768:{sku:"CDPEMR0039",access:"elpais.com"},769:{sku:"IDPEMP0044",access:"elpais.com"},770:{sku:"CDPEMR0040",access:"elpais.com"},771:{sku:"CDPEMR0041",access:"elpais.com"},772:{sku:"CDPEMR0049",access:"elpais.com"},773:{sku:"CDPEMR0042",access:"elpais.com"},774:{sku:"CDPEMR0043",access:"elpais.com"},775:{sku:"CDPEMR0045",access:"elpais.com"},776:{sku:"CDPEMR0046",access:"elpais.com"},777:{sku:"CDPEMR0047",access:"elpais.com"},778:{sku:"CDPOGP0059",access:"elpais.com"},779:{sku:"CDPEMR0048",access:"elpais.com"},782:{sku:"CDPEMR0050",access:"elpais.com"},783:{sku:"CDPEMR0053",access:"elpais.com"},784:{sku:"CDPEMR0051",access:"elpais.com"},785:{sku:"CDPEMR0062",access:"elpais.com"},786:{sku:"CDPEMR0052",access:"elpais.com"},787:{sku:"CDPEMR0063",access:"elpais.com"},788:{sku:"CDPEMR0057",access:"elpais.com"},789:{sku:"CDGEMR0069",access:"elpais.com"},791:{sku:"CDPEMR0064",access:"elpais.com"},795:{sku:"IDGCOR0071",access:"elpais.com"},796:{sku:"CDPEMR0065",access:"elpais.com"},797:{sku:"CDPEMR0072",access:"elpais.com"},805:{sku:"CDPEMR0073",access:"elpais.com"},806:{sku:"CDPEMR0083",access:"elpais.com"},807:{sku:"CDPEMR0075",access:"elpais.com"},808:{sku:"CDPEMR0077",access:"elpais.com"},809:{sku:"CDPEMR0074",access:"elpais.com"},810:{sku:"CDPEMR0076",access:"elpais.com"},811:{sku:"CDPEMR0082",access:"elpais.com"},812:{sku:"CDPEMR0055",access:"elpais.com"},813:{sku:"CDPEMR0078",access:"elpais.com"},815:{sku:"CDPEMR0080",access:"elpais.com"},816:{sku:"CDPEMR0096",access:"elpais.com"},817:{sku:"IDPPAR0095",access:"elpais.com"},818:{sku:"CDPEMR0097",access:"elpais.com"},819:{sku:"CDPEMR0084",access:"elpais.com"},820:{sku:"IDPPAR0099",access:"elpais.com"},821:{sku:"IDPPAR0098",access:"elpais.com"},822:{sku:"CDPEMR0100",access:"elpais.com"},823:{sku:"CDPEMR0079",access:"elpais.com"},824:{sku:"CDPEMR0101",access:"elpais.com"},833:{sku:"CDPEMR0102",access:"elpais.com"},834:{sku:"CDPOGP0070",access:"elpais.com"},835:{sku:"IDPPAR0105",access:"elpais.com"},836:{sku:"XDPPAR0106",access:"brasil.elpais.com"},848:{sku:"CDPEMRE0111",access:"elpais.com"},852:{sku:"CDPEMR0087",access:"elpais.com"},854:{sku:"CDPEMR0085",access:"elpais.com"},855:{sku:"IDPPAR0104",access:"elpais.com"},856:{sku:"XDPPAR0105",access:"elpais.com"},858:{sku:"IDPPARB0114",access:"brasil.elpais.com"},859:{sku:"IDPPARB0113",access:"brasil.elpais.com"},860:{sku:"IDPPARB0112",access:"brasil.elpais.com"},863:{sku:"CDPEMR0090",access:"elpais.com"},864:{sku:"CDPEMRE0119",access:"elpais.com"},865:{sku:"CDPEMPE0120",access:"elpais.com"},866:{sku:"CDPEMRE0122",access:"elpais.com"},867:{sku:"CDPEMRE0116",access:"elpais.com"},869:{sku:"CDPOGPE0108",access:"elpais.com"},870:{sku:"CDPEMRE0123",access:"elpais.com"},871:{sku:"CDGEMPE0124",access:"elpais.com"},874:{sku:"IDPPARA0125",access:"elpais.com"},875:{sku:"CDPEMR0054",access:"elpais.com"},876:{sku:"CDPEMR0056",access:"elpais.com"},877:{sku:"CDPEMR0058",access:"elpais.com"},878:{sku:"CDPEMR0061",access:"elpais.com"},879:{sku:"CDPEMR0066",access:"elpais.com"},880:{sku:"CDPEMR0067",access:"elpais.com"},881:{sku:"CDPEMR0068",access:"elpais.com"},883:{sku:"CDPEMR0081",access:"elpais.com"},884:{sku:"CDPEMR0094",access:"elpais.com"},885:{sku:"CDPEMR0086",access:"elpais.com"},886:{sku:"CDPOGPE0110",access:"elpais.com"},887:{sku:"CDPEMRE0109",access:"elpais.com"},888:{sku:"CDPOGPE0121",access:"elpais.com"},889:{sku:"IDPPARA0126",access:"elpais.com"},890:{sku:"CDPOGPE0128",access:"elpais.com"},891:{sku:"CDPEMRE0129",access:"elpais.com"},892:{sku:"CDPEMRE0130",access:"elpais.com"},893:{sku:"CDPEMRE0131",access:"elpais.com"},894:{sku:"CDPEMRE0132",access:"elpais.com"},895:{sku:"CDPEMRE0133",access:"elpais.com"},896:{sku:"CDPEMRE0146",access:"elpais.com"},897:{sku:"CDPEMRE0136",access:"elpais.com"},898:{sku:"CDPEMRE0135",access:"elpais.com"},899:{sku:"CDPEMRE0134",access:"elpais.com"},900:{sku:"CDPEMRE0151",access:"elpais.com"},905:{sku:"IDPPARE0156",access:"elpais.com"},913:{sku:"CDPEMREN0157",access:"elpais.com"},914:{sku:"IDGPAREN0158",access:"elpais.com"},915:{sku:"IDPPAREN0159",access:"elpais.com"},922:{sku:"IDPPAREN0160",access:"elpais.com"},924:{sku:"IDPPARAN0161",access:"elpais.com"},925:{sku:"CDPEMREN0162",access:"elpais.com"},926:{sku:"IDPPAREN0163",access:"elpais.com"},927:{sku:"IDPPARAN0165",access:"elpais.com"},928:{sku:"IDPPAR0103",access:"elpais.com"},929:{sku:"IDPPARB0117",access:"brasil.elpais.com"},930:{sku:"IDPPARBN0164",access:"brasil.elpais.com"},932:{sku:"CDPEMREN0166",access:"elpais.com"},935:{sku:"CDPEMREN0168",access:"elpais.com"},936:{sku:"IDPPAREN0170",access:"elpais.com"},937:{sku:"IDPPAREN0172",access:"elpais.com"},941:{sku:"IDPPARAN0174",access:"elpais.com"},942:{sku:"IDPPAREN0175",access:"elpais.com"},943:{sku:"IDPPARAN0177",access:"elpais.com"},944:{sku:"IDPPARBN0173",access:"brasil.elpais.com"},945:{sku:"IDPPARBN0176",access:"brasil.elpais.com"},946:{sku:"IDPPAREN0178",access:"elpais.com"},947:{sku:"IDPPARAN0180",access:"elpais.com"},948:{sku:"IDPPARBN0179",access:"brasil.elpais.com"},949:{sku:"CDPEMREN0181",access:"elpais.com"},951:{sku:"IDPPAREN0191",access:"elpais.com"},952:{sku:"IDPPAREN0182",access:"elpais.com"},953:{sku:"IDPPAREN0183",access:"elpais.com"},954:{sku:"IDPPAREN0184",access:"elpais.com"},955:{sku:"IDPPARAN0185",access:"elpais.com"},956:{sku:"IDPPARAN0186",access:"elpais.com"},957:{sku:"IDPPARAN0187",access:"elpais.com"},958:{sku:"IDPPARBN0188",access:"brasil.elpais.com"},959:{sku:"IDPPARBN0189",access:"brasil.elpais.com"},960:{sku:"IDPPARBN0190",access:"brasil.elpais.com"},963:{sku:"IDPPARBN0192",access:"brasil.elpais.com"},964:{sku:"IDPPAREN0193",access:"elpais.com"},965:{sku:"IDGPAREN0194",access:"elpais.com"},966:{sku:"CDPEMREN0196",access:"elpais.com"},968:{sku:"CDPEMREN0198",access:"elpais.com"},969:{sku:"CDPEMREN0199",access:"elpais.com"},970:{sku:"IDPPAREN0200",access:"elpais.com"},971:{sku:"IDGPAREN0201",access:"elpais.com"},972:{sku:"IDGPAREN0202",access:"elpais.com"},973:{sku:"CDPEMREN0203",access:"elpais.com"},974:{sku:"CDPEMRED0204",access:"elpais.com"},976:{sku:"IDPPAREN0205",access:"elpais.com"},977:{sku:"IDPPARAN0206",access:"elpais.com"},978:{sku:"IDPPARBN0207",access:"brasil.elpais.com"},981:{sku:"IDPPAREN0210",access:"elpais.com"},982:{sku:"IDPPARAN0211",access:"elpais.com"},983:{sku:"IDPPARBN0212",access:"brasil.elpais.com"},984:{sku:"CDPEMREN0214",access:"elpais.com"},986:{sku:"CDPEMREN0216",access:"elpais.com"},987:{sku:"CDPEMREN0217",access:"elpais.com"},988:{sku:"IDPPAREN0218",access:"elpais.com"},990:{sku:"IDPPARBN0220",access:"brasil.elpais.com"},991:{sku:"IDPPARAN0221",access:"elpais.com"},992:{sku:"CDPEMREN0222",access:"elpais.com"},993:{sku:"CDPEMREN0223",access:"elpais.com"},994:{sku:"IDPPAREN0224",access:"elpais.com"},995:{sku:"IDPPAREN0225",access:"elpais.com"},996:{sku:"IDPPAREF0226",access:"elpais.com"},997:{sku:"IDPPAREN0227",access:"elpais.com"},989:{sku:"IDPPARAN0219",access:"elpais.com"},1001:{sku:"IDPPARAN0232",access:"elpais.com"},1002:{sku:"IDPPARBN0233",access:"brasil.elpais.com"},1003:{sku:"CDPEMREN0235",access:"elpais.com"},1100:{sku:"IDPPAREN0238",access:"elpais.com"},1101:{sku:"IDPPARAN0241",access:"elpais.com"},1106:{sku:"IDPPARBN0242",access:"brasil.elpais.com"},1102:{sku:"IDPPAREN0237",access:"elpais.com"},1107:{sku:"IDPPARBN0238",access:"brasil.elpais.com"},1103:{sku:"IDPPARAN0239",access:"elpais.com"},1108:{sku:"IDPPAREN0246",access:"elpais.com"},1109:{sku:"IDPPARAN0247",access:"elpais.com"},1110:{sku:"IDPPARBN0248",access:"brasil.elpais.com"},1112:{sku:"IDPPARED0249",access:"elpais.com"},1113:{sku:"IDPPARED0250",access:"elpais.com"},1114:{sku:"IDPPARED0251",access:"elpais.com"},1115:{sku:"IDPPARED0252",access:"elpais.com"},1117:{sku:"CDPEMREN0253",access:"elpais.com"},1125:{sku:"IDPPAREN0261",access:"elpais.com"},1129:{sku:"CDPEMREN0264",access:"elpais.com"},1132:{sku:"IDPPARED0266",access:"elpais.com"},1134:{sku:"IDPPAREN0268",access:"elpais.com"},1135:{sku:"IDPPAREN0269",access:"elpais.com"},1136:{sku:"IDPPAREN0270",access:"elpais.com"},1137:{sku:"CDPEMREN0271",access:"elpais.com"},1139:{sku:"IDPPAREN0272",access:"elpais.com"},1146:{sku:"CDPEMREN0275",access:"elpais.com"},1147:{sku:"CDPEMREN0276",access:"elpais.com"},1149:{sku:"CDPEMREN0277",access:"elpais.com"},1150:{sku:"IDPPARED0278",access:"elpais.com"},1151:{sku:"IDPPAREN0279",access:"elpais.com"},1154:{sku:"IDPPARAN0282",access:"elpais.com"},1155:{sku:"IDPPARBN0283",access:"brasil.elpais.com"},1157:{sku:"CDPEMREN0285",access:"elpais.com"},1158:{sku:"CDPEMREN0286",access:"elpais.com"},1169:{sku:"IGPPAREN0290",access:"elpais.com"},1170:{sku:"CDPEMREN0290",access:"elpais.com"},1171:{sku:"IGPPAREN0291",access:"elpais.com"},1181:{sku:"IDPPAREN0302",access:"elpais.com"},1182:{sku:"IDPPARAN0303",access:"elpais.com"},1183:{sku:"IDPPARBN0304",access:"brasil.elpais.com"},1188:{sku:"IDPPARED0309",access:"elpais.com"},1189:{sku:"IDPPARED0310",access:"elpais.com"},1190:{sku:"IDPPARED0311",access:"elpais.com"},1191:{sku:"IDPPARAD0312",access:"elpais.com"},1192:{sku:"IDPPARBD0313",access:"brasil.elpais.com"},1198:{sku:"CDPEMREN0320",access:"elpais.com"},1199:{sku:"CDPEMREN0324",access:"elpais.com"},1202:{sku:"CDPEMREN0325",access:"elpais.com"},1203:{sku:"CDPEMREN0326",access:"elpais.com"},1204:{sku:"CDPEMREN0327",access:"elpais.com"},1206:{sku:"CDPEMREN0329",access:"elpais.com"},1217:{sku:"CDPEMREN0346",access:"elpais.com"},1220:{sku:"CDPEMREN0348",access:"elpais.com"},1221:{sku:"CDPEMREN0349",access:"elpais.com"},1222:{sku:"CDPEMREN0350",access:"elpais.com"},1228:{sku:"CDPEMREN0357",access:"elpais.com"},1230:{sku:"IDPPAREF0361",access:"elpais.com"},1231:{sku:"IDPPAREF0362",access:"elpais.com"},1233:{sku:"CDPEMREN0366",access:"elpais.com"},1235:{sku:"CDPEMREN0365",access:"elpais.com"},1250:{sku:"IDPPAREN0371",access:"elpais.com"},1251:{sku:"IDPPAREN0372",access:"elpais.com"},1252:{sku:"IDPPAREN0373",access:"elpais.com"},1253:{sku:"IDPPAREN0374",access:"elpais.com"},1254:{sku:"CDPEMREN0376",access:"elpais.com"},1256:{sku:"CDPEMREN0379",access:"elpais.com"},1258:{sku:"IDPPARAN0380",access:"elpais.com"},1259:{sku:"IDPPARBN0381",access:"brasil.elpais.com"},1265:{sku:"IDPPAREN0385",access:"elpais.com"},1266:{sku:"IDPPARAN0386",access:"elpais.com"},1267:{sku:"IDPPARBN0387",access:"brasil.elpais.com"},1268:{sku:"CDPEMREN0388",access:"elpais.com"},1271:{sku:"CDPEMREN0391",access:"elpais.com"},1273:{sku:"CDPEMREN0394",access:"elpais.com"},1274:{sku:"CDPEMREN0395",access:"elpais.com"},1294:{sku:"CDPEMREN0415",access:"elpais.com"},1307:{sku:"CDPEMREN0428",access:"elpais.com"},1309:{sku:"IDPPARED0430",access:"elpais.com"},1311:{sku:"CDPEMREN0432",access:"elpais.com"},1313:{sku:"CDPEMREN0434",access:"elpais.com"},1314:{sku:"CDPEMREN0435",access:"elpais.com"},1317:{sku:"CDPEMREN0438",access:"elpais.com"},1320:{sku:"CDPEMREN0441",access:"elpais.com"},1324:{sku:"CDPEMREN0444",access:"elpais.com"},1326:{sku:"CDPEMREN0446",access:"elpais.com"},1353:{sku:"IDPPAREN0449",access:"elpais.com"},1354:{sku:"IDPPARAN0450",access:"elpais.com"},1358:{sku:"CDPEMREN0455",access:"elpais.com"},1359:{sku:"CDPEMREN0456",access:"elpais.com"},1360:{sku:"IDPPAREN0458",access:"elpais.com"},1361:{sku:"IDPPARAN0459",access:"elpais.com"},1362:{sku:"IDPPAREN0461",access:"elpais.com"},1363:{sku:"IDPPARAN0462",access:"elpais.com"},1364:{sku:"IDPPARBN0457",access:"brasil.elpais.com"},1365:{sku:"IDPPARBN0460",access:"brasil.elpais.com"},1366:{sku:"IDPPARBN0463",access:"brasil.elpais.com"},1368:{sku:"CDPEMREN0465",access:"elpais.com"},1369:{sku:"CDPEMREN0466",access:"elpais.com"},1370:{sku:"CDPEMREN0468",access:"elpais.com"},1371:{sku:"CDPEMREN0469",access:"elpais.com"},1372:{sku:"IDPPAREF0470",access:"elpais.com"},1375:{sku:"CDPEMREN0474",access:"elpais.com"},1381:{sku:"CDPEMREN0479",access:"elpais.com"},1380:{sku:"IDPPAREN0471",access:"elpais.com"},1383:{sku:"CDPEMREN0482",access:"elpais.com"},1385:{sku:"IDPPAREN0483",access:"elpais.com"},1389:{sku:"CDPEMREN0487",access:"elpais.com"},1394:{sku:"CDPEMREN0492",access:"elpais.com"},1399:{sku:"CDPEMREN0498",access:"elpais.com"},1400:{sku:"CDPEMREN0500",access:"elpais.com"},1402:{sku:"CDPEMREN0501",access:"elpais.com"},1407:{sku:"CDPEMREN0508",access:"elpais.com"},1409:{sku:"CDPEMREN0510",access:"elpais.com"},1413:{sku:"CDPEMREN0514",access:"elpais.com"},1417:{sku:"IDPPAREN0529",access:"elpais.com"},1418:{sku:"IDPPAREN0530",access:"elpais.com"},1429:{sku:"CDPEMREN0527",access:"elpais.com"},1430:{sku:"CDPEMREN0528",access:"elpais.com"},1432:{sku:"CDPEMREN0531",access:"elpais.com"},1434:{sku:"CDPEMREN0533",access:"elpais.com"},1435:{sku:"CDPEMREN0534",access:"elpais.com"},1436:{sku:"CDPEMREN0535",access:"elpais.com"},1437:{sku:"CDPEMREN0536",access:"elpais.com"},1441:{sku:"CDPEMREN0540",access:"elpais.com"},1442:{sku:"CDPEMREN0541",access:"elpais.com"},1444:{sku:"CDPEMREN0543",access:"elpais.com"},1445:{sku:"CDPEMREN0545",access:"elpais.com"},1447:{sku:"CDPEMREN0546",access:"elpais.com"},1448:{sku:"CDPEMREN0548",access:"elpais.com"},1449:{sku:"CDPEMREN0547",access:"elpais.com"},1450:{sku:"CDPEMREN0549",access:"elpais.com"},1457:{sku:"CDPEMREN0559",access:"elpais.com"},1462:{sku:"IDPPARAN0589",access:"elpais.com"},1464:{sku:"IDPPAREN0590",access:"elpais.com"},1465:{sku:"IDPPARAN0591",access:"elpais.com"},1466:{sku:"IDPPAREN0593",access:"elpais.com"},1467:{sku:"IDPPAREN0592",access:"elpais.com"},1468:{sku:"CDPEMREN0561",access:"elpais.com"},1470:{sku:"CDPEMREN0563",access:"elpais.com"},1472:{sku:"IDPPAREN0594",access:"elpais.com"},1473:{sku:"IGPPAREN0595",access:"elpais.com"},1474:{sku:"IGPPAREN0596",access:"elpais.com"},1475:{sku:"CDPEMREN0566",access:"elpais.com"},1489:{sku:"IDPPAREN0618",access:"elpais.com"},1518:{sku:"IDPPARAN0621",access:"elpais.com"},1520:{sku:"IDGCOREN0622",access:"elpais.com"},1525:{sku:"IDPPAREN0623",access:"elpais.com"},1526:{sku:"IDPPARAN0624",access:"elpais.com"},1529:{sku:"IDPPARAN0625",access:"elpais.com"},1533:{sku:"IDPPAREN0626",access:"elpais.com"},1534:{sku:"IDPPARAN0627",access:"elpais.com"},1540:{sku:"IDGCOREN0631",access:"elpais.com"},1541:{sku:"IDPPAREN0645",access:"elpais.com"},1545:{sku:"IGPPARAN0648",access:"elpais.com"},1546:{sku:"IGPPARAN0649",access:"elpais.com"},1547:{
sku:"IDPPAREN0650",access:"elpais.com"},1553:{sku:"IDPPAREN0651",access:"elpais.com"},1559:{sku:"IDGCOREN0652",access:"elpais.com"},1561:{sku:"IGPPAREN0653",access:"elpais.com"},1564:{sku:"IDPPAREN0654",access:"elpais.com"},1568:{sku:"ISPPAREN0655",access:"elpais.com"},1569:{sku:"IPPPAREN0656",access:"elpais.com"},1570:{sku:"ISPPAREN0657",access:"elpais.com"},1571:{sku:"ISPPAREN0658",access:"elpais.com"},1572:{sku:"ISPPAREN0659",access:"elpais.com"},1573:{sku:"IPPPAREN0660",access:"elpais.com"}}}}},"omniture:paywall:active":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return!0===_satellite.getVar("paywall:active")?"activo":!1===_satellite.getVar("paywall:active")?"inactivo":"not-set"}}},"omniture:liveContent":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return!0===_satellite.getVar("liveContent")?"1":"0"}}},cleanURL:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.cleanURL"}},pageName:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.pageName"}},"paywall:type":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"paywall.type"}},"date:day":{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.date.day"}},edition:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.edition"}},serverAMP:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.serverAMP"}},"omniture:registeredUserAMP":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"1"==_satellite.getVar("user:registeredUserAMP")?"logueado":"0"==_satellite.getVar("user:registeredUserAMP")?"anonimo":_satellite.getVar("user:registeredUserAMP")}}},validPage:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.validPage"}},"Visitor:version":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"undefined"!=typeof Visitor&&void 0!==Visitor.version?"Visitor "+Visitor.version:"Visitor error"}}},org:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.org"}},publisher:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.publisher"}},tags:{defaultValue:"",modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.tags"}},articleTitle:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.articleTitle"}},articleLength:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.articleLength"}},publisherID:{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"page.pageInfo.publisherID"}},"user:experienceCloudID":{modulePath:"adobe-contexthub/src/lib/dataElement/dataElement.js",settings:{item:"user.experienceCloudID"}}},extensions:{"adobe-mcid":{displayName:"Experience Cloud ID Service",hostedLibFilesBaseUrl:"//ep00.epimg.net/js/gdt/0681c221600c/a81a11db86dc/63f8f5c6c881/hostedLibFiles/EP31a59fd25d824db7be52972a70e94c1c/",settings:{orgId:"2387401053DB208C0A490D4C@AdobeOrg",variables:[{name:"trackingServer",value:"metrics.elpais.com"},{name:"trackingServerSecure",value:"smetrics.elpais.com"},{name:"secureCookie",value:"true"},{name:"sameSiteCookie",value:"none"},{name:"marketingCloudServer",value:"metrics.elpais.com"},{name:"marketingCloudServerSecure",value:"smetrics.elpais.com"}]},modules:{"adobe-mcid/src/lib/sharedModules/mcidInstance.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-document"),i=n("../codeLibrary/VisitorAPI"),o=n("../../view/utils/timeUnits"),s=function(e){return e.reduce((function(e,t){var n=/^(true|false)$/i.test(t.value)?JSON.parse(t.value):t.value;return e[t.name]=n,e}),{})},c=function(e){var t=a.getExtensionSettings();if("string"!=typeof t.orgId)throw new TypeError("Org ID is not a string.");var n=s(t.variables||[]),r=t.doesOptInApply;r&&("boolean"==typeof r?n.doesOptInApply=r:t.optInCallback&&(n.doesOptInApply=t.optInCallback));var i=t.isOptInStorageEnabled;i&&(n.isOptInStorageEnabled=i);var c=t.optInCookieDomain;c&&(n.optInCookieDomain=c);var l=t.optInStorageExpiry;if(l){var u=t.timeUnit;if(u&&o[u]){var d=l*o[u];n.optInStorageExpiry=d}}else!0===i&&(n.optInStorageExpiry=33696e3);var p=t.previousPermissions;p&&(n.previousPermissions=p);var f=t.preOptInApprovals;if(f)n.preOptInApprovals=f;else{var m=t.preOptInApprovalInput;m&&(n.preOptInApprovals=m)}var g=t.isIabContext;g&&(n.isIabContext=g);var h=e.getInstance(t.orgId,n);return a.logger.info('Created instance using orgId: "'+t.orgId+'"'),a.logger.info("Set variables: "+JSON.stringify(n)),h.getMarketingCloudVisitorID((function(e){a.logger.info("Obtained Marketing Cloud Visitor Id: "+e)}),!0),h},l=function(e){return(a.getExtensionSettings().pathExclusions||[]).some((function(t){return t.valueIsRegex?new RegExp(t.value,"i").test(e):t.value===e}))},u=null;_satellite.getVisitorId=function(){return u},l(r.location.pathname)?a.logger.warn("MCID library not loaded. One of the path exclusions matches the current path."):u=c(i),e.exports=u},name:"mcid-instance",shared:!0},"adobe-mcid/src/lib/codeLibrary/VisitorAPI.js":{script:function(e){e.exports=(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(){return{callbacks:{},add:function(e,t){this.callbacks[e]=this.callbacks[e]||[];var n=this.callbacks[e].push(t)-1,a=this;return function(){a.callbacks[e].splice(n,1)}},execute:function(e,t){if(this.callbacks[e]){t=(t=void 0===t?[]:t)instanceof Array?t:[t];try{for(;this.callbacks[e].length;){var n=this.callbacks[e].shift();"function"==typeof n?n.apply(null,t):n instanceof Array&&n[1].apply(n[0],t)}delete this.callbacks[e]}catch(e){}}},executeAll:function(e,t){(t||e&&!R.isObjectEmpty(e))&&Object.keys(this.callbacks).forEach((function(t){var n=void 0!==e[t]?e[t]:"";this.execute(t,n)}),this)},hasCallbacks:function(){return Boolean(Object.keys(this.callbacks).length)}}}function a(e,t,n){var a=null==e?void 0:e[t];return void 0===a?n:a}function r(e){for(var t=/^\d+$/,n=0,a=e.length;n<a;n++)if(!t.test(e[n]))return!1;return!0}function i(e,t){for(;e.length<t.length;)e.push("0");for(;t.length<e.length;)t.push("0")}function o(e,t){for(var n=0;n<e.length;n++){var a=parseInt(e[n],10),r=parseInt(t[n],10);if(a>r)return 1;if(r>a)return-1}return 0}function s(e,t){if(e===t)return 0;var n=e.toString().split("."),a=t.toString().split(".");return r(n.concat(a))?(i(n,a),o(n,a)):NaN}function c(e){return e===Object(e)&&0===Object.keys(e).length}function l(e){return"function"==typeof e||e instanceof Array&&e.length}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};this.log=ue("log",e,t),this.warn=ue("warn",e,t),this.error=ue("error",e,t)}function d(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cookieName,t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).cookies;if(!e||!t)return{get:ke,set:ke,remove:ke};var n={remove:function(){t.remove(e)},get:function(){var n=t.get(e),a={};try{a=JSON.parse(n)}catch(n){a={}}return a},set:function(a,r){r=r||{};var i=n.get(),o=Object.assign(i,a);t.set(e,JSON.stringify(o),{domain:r.optInCookieDomain||"",cookieLifetime:r.optInStorageExpiry||3419e4,secure:r.secure,sameSite:r.sameSite,expires:!0})}};return n}function p(e){this.name=this.constructor.name,this.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack}function f(){function e(e,t){var n=ge(e);return n.length?n.every((function(e){return!!t[e]})):he(t)}function t(){S(_),A(te.COMPLETE),y(b.status,b.permissions),s&&h.set(b.permissions,{optInCookieDomain:c,optInStorageExpiry:l,secure:p,sameSite:f}),v.execute(Te)}function n(e){return function(n,a){if(!be(n))throw new Error("[OptIn] Invalid category(-ies). Please use the `OptIn.Categories` enum.");return A(te.CHANGED),Object.assign(_,ye(ge(n),e)),a||t(),b}}var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=a.doesOptInApply,i=a.previousPermissions,o=a.preOptInApprovals,s=a.isOptInStorageEnabled,c=a.optInCookieDomain,l=a.optInStorageExpiry,u=a.isIabContext,p=a.secureCookie,f=a.sameSiteCookie,m=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).cookies,g=_e(i);Ae(g,"Invalid `previousPermissions`!"),Ae(o,"Invalid `preOptInApprovals`!");var h=d({cookieName:"adobeujs-optin"},{cookies:m}),b=this,y=ee(b),v=se(),E=Pe(g),P=Pe(o),C=s?h.get():{},D={},I=function(e,t){return Ce(e)||t&&Ce(t)?te.COMPLETE:te.PENDING}(E,C),k=function(e,t,n){var a=ye(oe,!r);return r?Object.assign({},a,e,t,n):a}(P,E,C),_=ve(k),A=function(e){return I=e},S=function(e){return k=e};b.deny=n(!1),b.approve=n(!0),b.denyAll=b.deny.bind(b,oe),b.approveAll=b.approve.bind(b,oe),b.isApproved=function(t){return e(t,b.permissions)},b.isPreApproved=function(t){return e(t,P)},b.fetchPermissions=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?b.on(te.COMPLETE,e):ke;return!r||r&&b.isComplete||o?e(b.permissions):t||v.add(Te,(function(){return e(b.permissions)})),n},b.complete=function(){b.status===te.CHANGED&&t()},b.registerPlugin=function(e){if(!e||!e.name||"function"!=typeof e.onRegister)throw new Error(we);D[e.name]||(D[e.name]=e,e.onRegister.call(e,b))},b.execute=Re(D),b.memoizeContent=function(e){Ie(e)&&h.set(e,{optInCookieDomain:c,optInStorageExpiry:l,secure:p,sameSite:f})},b.getMemoizedContent=function(e){var t=h.get();if(t)return t[e]},Object.defineProperties(b,{permissions:{get:function(){return k}},status:{get:function(){return I}},Categories:{get:function(){return ne}},doesOptInApply:{get:function(){return!!r}},isPending:{get:function(){return b.status===te.PENDING}},isComplete:{get:function(){return b.status===te.COMPLETE}},__plugins:{get:function(){return Object.keys(D)}},isIabContext:{get:function(){return u}}})}function m(e,t){function n(){r=null,e.call(e,new p("The call took longer than you wanted!"))}function a(){r&&(clearTimeout(r),e.apply(e,arguments))}if(void 0===t)return e;var r=setTimeout(n,t);return a}function g(){if(window.__tcfapi)return window.__tcfapi;var e=window;if(e!==window.top){for(var t;!t;){e=e.parent;try{e.frames.__tcfapiLocator&&(t=e)}catch(e){}if(e===window.top)break}if(t){var n={};return window.__tcfapi=function(e,a,r,i){var o=Math.random()+"",s={__tcfapiCall:{command:e,parameter:i,version:a,callId:o}};n[o]=r,t.postMessage(s,"*")},window.addEventListener("message",(function(e){var t=e.data;if("string"==typeof t)try{t=JSON.parse(e.data)}catch(e){}if(t.__tcfapiReturn){var a=t.__tcfapiReturn;"function"==typeof n[a.callId]&&(n[a.callId](a.returnValue,a.success),delete n[a.callId])}}),!1),window.__tcfapi}fe.error("__tcfapi not found")}else fe.error("__tcfapi not found")}function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=!0===e.vendor.consents[t],r=n.every((function(t){return!0===e.purpose.consents[t]}));return a&&r}function b(){var e=this;e.name="iabPlugin",e.version="0.0.2";var t,n=se(),a={transparencyAndConsentData:null},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a[e]=t};e.fetchConsentData=function(e){var t=m(e.callback,e.timeout);i({callback:t})},e.isApproved=function(e){var t=e.callback,n=e.category,r=e.timeout;if(a.transparencyAndConsentData)return t(null,h(a.transparencyAndConsentData,ae[n],re[n]));var o=m((function(e,a){t(e,h(a,ae[n],re[n]))}),r);i({category:n,callback:o})},e.onRegister=function(n){t=n;var a=Object.keys(ae),r=function(e,t){!e&&t&&(a.forEach((function(e){var a=h(t,ae[e],re[e]);n[a?"approve":"deny"](e,!0)})),n.complete())};e.fetchConsentData({callback:r})};var i=function(e){var i=e.callback;if(a.transparencyAndConsentData)return i(null,a.transparencyAndConsentData);n.add("FETCH_CONSENT_DATA",i),o((function(e,i){if(i){var o=ve(e),s=t.getMemoizedContent("iabConsentHash"),c=pe(o.tcString).toString(32);o.consentString=e.tcString,o.hasConsentChangedSinceLastCmpPull=s!==c,r("transparencyAndConsentData",o),t.memoizeContent({iabConsentHash:c})}n.execute("FETCH_CONSENT_DATA",[null,a.transparencyAndConsentData])}))},o=function(e){var t=Me(ae),n=g();"function"==typeof n&&n("getTCData",2,e,t)}}var y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};Object.assign=Object.assign||function(e){for(var t,n,a=1;a<arguments.length;++a)for(t in n=arguments[a])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e};var v,E,P={MESSAGES:{HANDSHAKE:"HANDSHAKE",GETSTATE:"GETSTATE",PARENTSTATE:"PARENTSTATE"},STATE_KEYS_MAP:{MCMID:"MCMID",MCAID:"MCAID",MCAAMB:"MCAAMB",MCAAMLH:"MCAAMLH",MCOPTOUT:"MCOPTOUT",CUSTOMERIDS:"CUSTOMERIDS"},ASYNC_API_MAP:{MCMID:"getMarketingCloudVisitorID",MCAID:"getAnalyticsVisitorID",MCAAMB:"getAudienceManagerBlob",MCAAMLH:"getAudienceManagerLocationHint",MCOPTOUT:"isOptedOut",ALLFIELDS:"getVisitorValues"},SYNC_API_MAP:{CUSTOMERIDS:"getCustomerIDs"},ALL_APIS:{MCMID:"getMarketingCloudVisitorID",MCAAMB:"getAudienceManagerBlob",MCAAMLH:"getAudienceManagerLocationHint",MCOPTOUT:"isOptedOut",MCAID:"getAnalyticsVisitorID",CUSTOMERIDS:"getCustomerIDs",ALLFIELDS:"getVisitorValues"},FIELDGROUP_TO_FIELD:{MC:"MCMID",A:"MCAID",AAM:"MCAAMB"},FIELDS:{MCMID:"MCMID",MCOPTOUT:"MCOPTOUT",MCAID:"MCAID",MCAAMLH:"MCAAMLH",MCAAMB:"MCAAMB"},AUTH_STATE:{UNKNOWN:0,AUTHENTICATED:1,LOGGED_OUT:2},OPT_OUT:{GLOBAL:"global"},SAME_SITE_VALUES:{LAX:"Lax",STRICT:"Strict",NONE:"None"}},C=P.STATE_KEYS_MAP,D=function(e){function t(){}function n(t,n){var a=this;return function(){var r=e(0,t),i={};return i[t]=r,a.setStateAndPublish(i),n(r),r}}this.getMarketingCloudVisitorID=function(e){e=e||t;var a=this.findField(C.MCMID,e),r=n.call(this,C.MCMID,e);return void 0!==a?a:r()},this.getVisitorValues=function(e){this.getMarketingCloudVisitorID((function(t){e({MCMID:t})}))}},I=P.MESSAGES,k=P.ASYNC_API_MAP,_=P.SYNC_API_MAP,A=function(){function e(){}function t(e,t){var n=this;return function(){return n.callbackRegistry.add(e,t),n.messageParent(I.GETSTATE),""}}function n(n){this[k[n]]=function(a){a=a||e;var r=this.findField(n,a),i=t.call(this,n,a);return void 0!==r?r:i()}}function a(t){this[_[t]]=function(){return this.findField(t,e)||{}}}Object.keys(k).forEach(n,this),Object.keys(_).forEach(a,this)},S=P.ASYNC_API_MAP,M=function(){Object.keys(S).forEach((function(e){this[S[e]]=function(t){this.callbackRegistry.add(e,t)}}),this)},R=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(t,n){n.isObjectEmpty=function(e){return e===Object(e)&&0===Object.keys(e).length},n.isValueEmpty=function(e){return""===e||n.isObjectEmpty(e)};var a=function(){var e=navigator.appName,t=navigator.userAgent;return"Microsoft Internet Explorer"===e||t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0&&t.indexOf("Windows NT 6")>=0};n.getIeVersion=function(){return document.documentMode?document.documentMode:a()?7:null},n.isFirefox=function(e){return!!/Firefox\/([0-9\.]+)(?:\s|$)/.test(e||window.navigator.userAgent)},n.encodeAndBuildRequest=function(e,t){return e.map(encodeURIComponent).join(t)},n.isObject=function(t){return null!==t&&"object"===e(t)&&!1===Array.isArray(t)},n.defineGlobalNamespace=function(){return window.adobe=n.isObject(window.adobe)?window.adobe:{},window.adobe},n.pluck=function(e,t){return t.reduce((function(t,n){return e[n]&&(t[n]=e[n]),t}),Object.create(null))},n.parseOptOut=function(e,t,n){t||(t=n,e.d_optout&&e.d_optout instanceof Array&&(t=e.d_optout.join(",")));var a=parseInt(e.d_ottl,10);return isNaN(a)&&(a=7200),{optOut:t,d_ottl:a}},n.normalizeBoolean=function(e){var t=e;return"true"===e?t=!0:"false"===e&&(t=!1),t}})),T=(R.isObjectEmpty,R.isValueEmpty,R.getIeVersion,R.isFirefox,R.encodeAndBuildRequest,R.isObject,R.defineGlobalNamespace,R.pluck,R.parseOptOut,R.normalizeBoolean,n),w=P.MESSAGES,O={0:"prefix",1:"orgID",2:"state"},N=function(e,t){this.parse=function(e){try{var t={};return e.data.split("|").forEach((function(e,n){void 0!==e&&(t[O[n]]=2!==n?e:JSON.parse(e))})),t}catch(e){}},this.isInvalid=function(n){var a=this.parse(n);if(!a||Object.keys(a).length<2)return!0;var r=e!==a.orgID,i=!t||n.origin!==t,o=-1===Object.keys(w).indexOf(a.prefix);return r||i||o},this.send=function(n,a,r){var i=a+"|"+e;r&&r===Object(r)&&(i+="|"+JSON.stringify(r));try{n.postMessage(i,t)}catch(e){}}},x=P.MESSAGES,j=function(e,t,n,a){function r(e){Object.assign(f,e)}function i(e){Object.assign(f.state,e),Object.assign(f.state.ALLFIELDS,e),f.callbackRegistry.executeAll(f.state)}function o(e){if(!h.isInvalid(e)){g=!1;var t=h.parse(e);f.setStateAndPublish(t.state)}}function s(e){!g&&m&&(g=!0,h.send(a,e))}function c(){r(new D(n._generateID)),f.getMarketingCloudVisitorID(),f.callbackRegistry.executeAll(f.state,!0),y.removeEventListener("message",l)}function l(e){if(!h.isInvalid(e)){var t=h.parse(e);g=!1,y.clearTimeout(f._handshakeTimeout),y.removeEventListener("message",l),r(new A(f)),y.addEventListener("message",o),f.setStateAndPublish(t.state),f.callbackRegistry.hasCallbacks()&&s(x.GETSTATE)}}function u(){m&&postMessage?(y.addEventListener("message",l),s(x.HANDSHAKE),f._handshakeTimeout=setTimeout(c,250)):c()}function d(){y.s_c_in||(y.s_c_il=[],y.s_c_in=0),f._c="Visitor",f._il=y.s_c_il,f._in=y.s_c_in,f._il[f._in]=f,y.s_c_in++}function p(){function e(e){0!==e.indexOf("_")&&"function"==typeof n[e]&&(f[e]=function(){})}Object.keys(n).forEach(e),f.getSupplementalDataID=n.getSupplementalDataID,f.isAllowed=function(){return!0}}var f=this,m=t.whitelistParentDomain;f.state={ALLFIELDS:{}},f.version=n.version,f.marketingCloudOrgID=e,f.cookieDomain=n.cookieDomain||"",f._instanceType="child";var g=!1,h=new N(e,m);f.callbackRegistry=T(),f.init=function(){d(),p(),r(new M(f)),u()},f.findField=function(e,t){if(void 0!==f.state[e])return t(f.state[e]),f.state[e]},f.messageParent=s,f.setStateAndPublish=i},L=P.MESSAGES,V=P.ALL_APIS,F=P.ASYNC_API_MAP,U=P.FIELDGROUP_TO_FIELD,H=function(e,t){function n(){var t={};return Object.keys(V).forEach((function(n){var a=V[n],r=e[a]();R.isValueEmpty(r)||(t[n]=r)})),t}function a(){var t=[];return e._loading&&Object.keys(e._loading).forEach((function(n){if(e._loading[n]){var a=U[n];t.push(a)}})),t.length?t:null}function r(t){return function n(){var r=a();if(r){var i=F[r[0]];e[i](n,!0)}else t()}}function i(e,a){var r=n();t.send(e,a,r)}function o(e){c(e),i(e,L.HANDSHAKE)}function s(e){r((function(){i(e,L.PARENTSTATE)}))()}function c(n){function a(a){r.call(e,a),t.send(n,L.PARENTSTATE,{CUSTOMERIDS:e.getCustomerIDs()})}var r=e.setCustomerIDs;e.setCustomerIDs=a}return function(e){t.isInvalid(e)||(t.parse(e).prefix===L.HANDSHAKE?o:s)(e.source)}},B=function(e,t){function n(e){return function(n){a[e]=n,++r===i&&t(a)}}var a={},r=0,i=Object.keys(e).length;Object.keys(e).forEach((function(t){var a=e[t];if(a.fn){var r=a.args||[];r.unshift(n(t)),a.fn.apply(a.context||null,r)}}))},G={get:function(e){e=encodeURIComponent(e);var t=(";"+document.cookie).split(" ").join(";"),n=t.indexOf(";"+e+"="),a=n<0?n:t.indexOf(";",n+1);return n<0?"":decodeURIComponent(t.substring(n+2+e.length,a<0?t.length:a))},set:function(e,t,n){var r=a(n,"cookieLifetime"),i=a(n,"expires"),o=a(n,"domain"),s=a(n,"secure"),c=a(n,"sameSite"),l=s?"Secure":"",u=c?"SameSite="+c+";":"";if(i&&"SESSION"!==r&&"NONE"!==r){var d=""!==t?parseInt(r||0,10):-60;if(d)(i=new Date).setTime(i.getTime()+1e3*d);else if(1===i){var p=(i=new Date).getYear();i.setYear(p+2+(p<1900?1900:0))}}else i=0;return e&&"NONE"!==r?(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+"; path=/;"+(i?" expires="+i.toGMTString()+";":"")+(o?" domain="+o+";":"")+u+l,this.get(e)===t):0},remove:function(e,t){var n=a(t,"domain");n=n?" domain="+n+";":"";var r=a(t,"secure"),i=a(t,"sameSite"),o=r?"Secure":"",s=i?"SameSite="+i+";":"";document.cookie=encodeURIComponent(e)+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"+n+s+o}},q=function(e,t){!e&&y.location&&(e=y.location.hostname);var n,a=e.split("."),r=t||{};for(n=a.length-2;n>=0;n--)if(r.domain=a.slice(n).join("."),G.set("TEST_AMCV_COOKIE_WRITE","cookie",r))return G.remove("TEST_AMCV_COOKIE_WRITE",r),r.domain;return""},W={compare:s,isLessThan:function(e,t){return s(e,t)<0},areVersionsDifferent:function(e,t){return 0!==s(e,t)},isGreaterThan:function(e,t){return s(e,t)>0},isEqual:function(e,t){return 0===s(e,t)}},Y=!!y.postMessage,$={postMessage:function(e,t,n){var a=1;t&&(Y?n.postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):t&&(n.location=t.replace(/#.*$/,"")+"#"+ +new Date+a+++"&"+e))},receiveMessage:function(e,t){var n;try{Y&&(e&&(n=function(n){if("string"==typeof t&&n.origin!==t||"[object Function]"===Object.prototype.toString.call(t)&&!1===t(n.origin))return!1;e(n)}),y.addEventListener?y[e?"addEventListener":"removeEventListener"]("message",n):y[e?"attachEvent":"detachEvent"]("onmessage",n))}catch(e){}}},J=function(e){var t,n,a="0123456789",r="",i="",o=8,s=10,c=10,l=(""+Date.now()).substr(-6).split("").reverse("").join("");if(1==e){for(a+="ABCDEF",t=0;16>t;t++)n=Math.floor(Math.random()*o),4>t&&l[t]<o&&(n=+l[t]),r+=a.substring(n,n+1),n=Math.floor(Math.random()*o),i+=a.substring(n,n+1),o=16;return r+"-"+i}for(t=0;19>t;t++)n=Math.floor(Math.random()*s),6>t&&l[t]<s?(r+=l[t],n=l[t]):r+=a.substring(n,n+1),0===t&&9==n?s=3:((1==t||2==t)&&10!=s&&2>n||2<t)&&(s=10),n=Math.floor(Math.random()*c),i+=a.substring(n,n+1),0===t&&9==n?c=3:((1==t||2==t)&&10!=c&&2>n||2<t)&&(c=10);return r+i},K=function(e){return{corsMetadata:function(){var e="none",t=!0;return"undefined"!=typeof XMLHttpRequest&&XMLHttpRequest===Object(XMLHttpRequest)&&("withCredentials"in new XMLHttpRequest?e="XMLHttpRequest":"undefined"!=typeof XDomainRequest&&XDomainRequest===Object(XDomainRequest)&&(t=!1),Object.prototype.toString.call(y.HTMLElement).indexOf("Constructor")>0&&(t=!1)),{corsType:e,corsCookiesEnabled:t}}(),getCORSInstance:function(){return"none"===this.corsMetadata.corsType?null:new y[this.corsMetadata.corsType]},fireCORS:function(t,n){function a(e){var n;try{if((n=JSON.parse(e))!==Object(n))return void r.handleCORSError(t,null,"Response is not JSON")}catch(e){return void r.handleCORSError(t,e,"Error parsing response as JSON")}try{for(var a=t.callback,i=y,o=0;o<a.length;o++)i=i[a[o]];i(n)}catch(e){r.handleCORSError(t,e,"Error forming callback function")}}var r=this;n&&(t.loadErrorHandler=n);try{var i=this.getCORSInstance();i.open("get",t.corsUrl+"&ts="+(new Date).getTime(),!0),"XMLHttpRequest"===this.corsMetadata.corsType&&(i.withCredentials=!0,i.timeout=e.loadTimeout,i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){4===this.readyState&&200===this.status&&a(this.responseText)}),i.onerror=function(e){r.handleCORSError(t,e,"onerror")},i.ontimeout=function(e){r.handleCORSError(t,e,"ontimeout")},i.send(),e._log.requests.push(t.corsUrl)}catch(e){this.handleCORSError(t,e,"try-catch")}},handleCORSError:function(t,n,a){e.CORSErrors.push({corsData:t,error:n,description:a}),t.loadErrorHandler&&("ontimeout"===a?t.loadErrorHandler(!0):t.loadErrorHandler(!1))}}},z={POST_MESSAGE_ENABLED:!!y.postMessage,DAYS_BETWEEN_SYNC_ID_CALLS:1,MILLIS_PER_DAY:864e5,ADOBE_MC:"adobe_mc",ADOBE_MC_SDID:"adobe_mc_sdid",VALID_VISITOR_ID_REGEX:/^[0-9a-fA-F\-]+$/,ADOBE_MC_TTL_IN_MIN:5,VERSION_REGEX:/vVersion\|((\d+\.)?(\d+\.)?(\*|\d+))(?=$|\|)/,FIRST_PARTY_SERVER_COOKIE:"s_ecid"},X=function(e,t){var n=y.document;return{THROTTLE_START:3e4,MAX_SYNCS_LENGTH:649,throttleTimerSet:!1,id:null,onPagePixels:[],iframeHost:null,getIframeHost:function(e){if("string"==typeof e){var t=e.split("/");return t[0]+"//"+t[2]}},subdomain:null,url:null,getUrl:function(){var t,a="http://fast.",r="?d_nsid="+e.idSyncContainerID+"#"+encodeURIComponent(n.location.origin);return this.subdomain||(this.subdomain="nosubdomainreturned"),e.loadSSL&&(a=e.idSyncSSLUseAkamai?"https://fast.":"https://"),t=a+this.subdomain+".demdex.net/dest5.html"+r,this.iframeHost=this.getIframeHost(t),this.id="destination_publishing_iframe_"+this.subdomain+"_"+e.idSyncContainerID,t},checkDPIframeSrc:function(){var t="?d_nsid="+e.idSyncContainerID+"#"+encodeURIComponent(n.location.href);"string"==typeof e.dpIframeSrc&&e.dpIframeSrc.length&&(this.id="destination_publishing_iframe_"+(e._subdomain||this.subdomain||(new Date).getTime())+"_"+e.idSyncContainerID,this.iframeHost=this.getIframeHost(e.dpIframeSrc),this.url=e.dpIframeSrc+t)},idCallNotProcesssed:null,doAttachIframe:!1,startedAttachingIframe:!1,iframeHasLoaded:null,iframeIdChanged:null,newIframeCreated:null,originalIframeHasLoadedAlready:null,iframeLoadedCallbacks:[],regionChanged:!1,timesRegionChanged:0,sendingMessages:!1,messages:[],messagesPosted:[],messagesReceived:[],messageSendingInterval:z.POST_MESSAGE_ENABLED?null:100,onPageDestinationsFired:[],jsonForComparison:[],jsonDuplicates:[],jsonWaiting:[],jsonProcessed:[],canSetThirdPartyCookies:!0,receivedThirdPartyCookiesNotification:!1,readyToAttachIframePreliminary:function(){return!(e.idSyncDisableSyncs||e.disableIdSyncs||e.idSyncDisable3rdPartySyncing||e.disableThirdPartyCookies||e.disableThirdPartyCalls)},readyToAttachIframe:function(){return this.readyToAttachIframePreliminary()&&(this.doAttachIframe||e._doAttachIframe)&&(this.subdomain&&"nosubdomainreturned"!==this.subdomain||e._subdomain)&&this.url&&!this.startedAttachingIframe},attachIframe:function(){function e(){(r=n.createElement("iframe")).sandbox="allow-scripts allow-same-origin",r.title="Adobe ID Syncing iFrame",r.id=a.id,r.name=a.id+"_name",r.style.cssText="display: none; width: 0; height: 0;",r.src=a.url,a.newIframeCreated=!0,t(),n.body.appendChild(r)}function t(e){r.addEventListener("load",(function(){r.className="aamIframeLoaded",a.iframeHasLoaded=!0,a.fireIframeLoadedCallbacks(e),a.requestToProcess()}))}this.startedAttachingIframe=!0;var a=this,r=n.getElementById(this.id);r?"IFRAME"!==r.nodeName?(this.id+="_2",this.iframeIdChanged=!0,e()):(this.newIframeCreated=!1,"aamIframeLoaded"!==r.className?(this.originalIframeHasLoadedAlready=!1,t("The destination publishing iframe already exists from a different library, but hadn't loaded yet.")):(this.originalIframeHasLoadedAlready=!0,this.iframeHasLoaded=!0,this.iframe=r,this.fireIframeLoadedCallbacks("The destination publishing iframe already exists from a different library, and had loaded alresady."),this.requestToProcess())):e(),this.iframe=r},fireIframeLoadedCallbacks:function(e){this.iframeLoadedCallbacks.forEach((function(t){"function"==typeof t&&t({message:e||"The destination publishing iframe was attached and loaded successfully."})})),this.iframeLoadedCallbacks=[]},requestToProcess:function(t){function n(){r.jsonForComparison.push(t),r.jsonWaiting.push(t),r.processSyncOnPage(t)}var a,r=this;if(t===Object(t)&&t.ibs)if(a=JSON.stringify(t.ibs||[]),this.jsonForComparison.length){var i,o,s,c=!1;for(i=0,o=this.jsonForComparison.length;i<o;i++)if(s=this.jsonForComparison[i],a===JSON.stringify(s.ibs||[])){c=!0;break}c?this.jsonDuplicates.push(t):n()}else n();if((this.receivedThirdPartyCookiesNotification||!z.POST_MESSAGE_ENABLED||this.iframeHasLoaded)&&this.jsonWaiting.length){var l=this.jsonWaiting.shift();this.process(l),this.requestToProcess()}e.idSyncDisableSyncs||e.disableIdSyncs||!this.iframeHasLoaded||!this.messages.length||this.sendingMessages||(this.throttleTimerSet||(this.throttleTimerSet=!0,setTimeout((function(){r.messageSendingInterval=z.POST_MESSAGE_ENABLED?null:150}),this.THROTTLE_START)),this.sendingMessages=!0,this.sendMessages())},getRegionAndCheckIfChanged:function(t,n){var a=e._getField("MCAAMLH"),r=t.d_region||t.dcs_region;return a?r&&(e._setFieldExpire("MCAAMLH",n),e._setField("MCAAMLH",r),parseInt(a,10)!==r&&(this.regionChanged=!0,this.timesRegionChanged++,e._setField("MCSYNCSOP",""),e._setField("MCSYNCS",""),a=r)):(a=r)&&(e._setFieldExpire("MCAAMLH",n),e._setField("MCAAMLH",a)),a||(a=""),a},processSyncOnPage:function(e){var t,n,a,r;if((t=e.ibs)&&t instanceof Array&&(n=t.length))for(a=0;a<n;a++)(r=t[a]).syncOnPage&&this.checkFirstPartyCookie(r,"","syncOnPage")},process:function(e){var t,n,a,r,i,o=encodeURIComponent,s=!1;if((t=e.ibs)&&t instanceof Array&&(n=t.length))for(s=!0,a=0;a<n;a++)r=t[a],i=[o("ibs"),o(r.id||""),o(r.tag||""),R.encodeAndBuildRequest(r.url||[],","),o(r.ttl||""),"","",r.fireURLSync?"true":"false"],r.syncOnPage||(this.canSetThirdPartyCookies?this.addMessage(i.join("|")):r.fireURLSync&&this.checkFirstPartyCookie(r,i.join("|")));s&&this.jsonProcessed.push(e)},checkFirstPartyCookie:function(t,n,a){var r="syncOnPage"===a,i=r?"MCSYNCSOP":"MCSYNCS";e._readVisitor();var o,s,c=e._getField(i),l=!1,u=!1,d=Math.ceil((new Date).getTime()/z.MILLIS_PER_DAY);c?(o=c.split("*"),l=(s=this.pruneSyncData(o,t.id,d)).dataPresent,u=s.dataValid,l&&u||this.fireSync(r,t,n,o,i,d)):(o=[],this.fireSync(r,t,n,o,i,d))},pruneSyncData:function(e,t,n){var a,r,i,o=!1,s=!1;for(r=0;r<e.length;r++)a=e[r],i=parseInt(a.split("-")[1],10),a.match("^"+t+"-")?(o=!0,n<i?s=!0:(e.splice(r,1),r--)):n>=i&&(e.splice(r,1),r--);return{dataPresent:o,dataValid:s}},manageSyncsSize:function(e){if(e.join("*").length>this.MAX_SYNCS_LENGTH)for(e.sort((function(e,t){return parseInt(e.split("-")[1],10)-parseInt(t.split("-")[1],10)}));e.join("*").length>this.MAX_SYNCS_LENGTH;)e.shift()},fireSync:function(t,n,a,r,i,o){var s=this;if(t){if("img"===n.tag){var c,l,u,d,p=n.url,f=e.loadSSL?"https:":"http:";for(c=0,l=p.length;c<l;c++){u=p[c],d=/^\/\//.test(u);var m=new Image;m.addEventListener("load",function(t,n,a,r){return function(){s.onPagePixels[t]=null,e._readVisitor();var o,c,l,u,d=e._getField(i),p=[];if(d)for(c=0,l=(o=d.split("*")).length;c<l;c++)(u=o[c]).match("^"+n.id+"-")||p.push(u);s.setSyncTrackingData(p,n,a,r)}}(this.onPagePixels.length,n,i,o)),m.src=(d?f:"")+u,this.onPagePixels.push(m)}}}else this.addMessage(a),this.setSyncTrackingData(r,n,i,o)},addMessage:function(t){var n=encodeURIComponent(e._enableErrorReporting?"---destpub-debug---":"---destpub---");this.messages.push((z.POST_MESSAGE_ENABLED?"":n)+t)},setSyncTrackingData:function(t,n,a,r){t.push(n.id+"-"+(r+Math.ceil(n.ttl/60/24))),this.manageSyncsSize(t),e._setField(a,t.join("*"))},sendMessages:function(){var e,t=this,n="",a=encodeURIComponent;this.regionChanged&&(n=a("---destpub-clear-dextp---"),this.regionChanged=!1),this.messages.length?z.POST_MESSAGE_ENABLED?(e=n+a("---destpub-combined---")+this.messages.join("%01"),this.postMessage(e),this.messages=[],this.sendingMessages=!1):(e=this.messages.shift(),this.postMessage(n+e),setTimeout((function(){t.sendMessages()}),this.messageSendingInterval)):this.sendingMessages=!1},postMessage:function(e){$.postMessage(e,this.url,this.iframe.contentWindow),this.messagesPosted.push(e)},receiveMessage:function(e){var t,n=/^---destpub-to-parent---/;"string"==typeof e&&n.test(e)&&("canSetThirdPartyCookies"===(t=e.replace(n,"").split("|"))[0]&&(this.canSetThirdPartyCookies="true"===t[1],this.receivedThirdPartyCookiesNotification=!0,this.requestToProcess()),this.messagesReceived.push(e))},processIDCallData:function(a){(null==this.url||a.subdomain&&"nosubdomainreturned"===this.subdomain)&&("string"==typeof e._subdomain&&e._subdomain.length?this.subdomain=e._subdomain:this.subdomain=a.subdomain||"",this.url=this.getUrl()),a.ibs instanceof Array&&a.ibs.length&&(this.doAttachIframe=!0),this.readyToAttachIframe()&&(e.idSyncAttachIframeOnWindowLoad?(t.windowLoaded||"complete"===n.readyState||"loaded"===n.readyState)&&this.attachIframe():this.attachIframeASAP()),"function"==typeof e.idSyncIDCallResult?e.idSyncIDCallResult(a):this.requestToProcess(a),"function"==typeof e.idSyncAfterIDCallResult&&e.idSyncAfterIDCallResult(a)},canMakeSyncIDCall:function(t,n){return e._forceSyncIDCall||!t||n-t>z.DAYS_BETWEEN_SYNC_ID_CALLS},attachIframeASAP:function(){function e(){t.startedAttachingIframe||(n.body?t.attachIframe():setTimeout(e,30))}var t=this;e()}}},Q={audienceManagerServer:{},audienceManagerServerSecure:{},cookieDomain:{},cookieLifetime:{},cookieName:{},doesOptInApply:{type:"boolean"},disableThirdPartyCalls:{type:"boolean"},discardTrackingServerECID:{type:"boolean"},idSyncAfterIDCallResult:{},idSyncAttachIframeOnWindowLoad:{type:"boolean"},
idSyncContainerID:{},idSyncDisable3rdPartySyncing:{type:"boolean"},disableThirdPartyCookies:{type:"boolean"},idSyncDisableSyncs:{type:"boolean"},disableIdSyncs:{type:"boolean"},idSyncIDCallResult:{},idSyncSSLUseAkamai:{type:"boolean"},isCoopSafe:{type:"boolean"},isIabContext:{type:"boolean"},isOptInStorageEnabled:{type:"boolean"},loadSSL:{type:"boolean"},loadTimeout:{},marketingCloudServer:{},marketingCloudServerSecure:{},optInCookieDomain:{},optInStorageExpiry:{},overwriteCrossDomainMCIDAndAID:{type:"boolean"},preOptInApprovals:{},previousPermissions:{},resetBeforeVersion:{},sdidParamExpiry:{},serverState:{},sessionCookieName:{},secureCookie:{type:"boolean"},sameSiteCookie:{},takeTimeoutMetrics:{},trackingServer:{},trackingServerSecure:{},useLocalStorage:{type:"boolean"},whitelistIframeDomains:{},whitelistParentDomain:{}},Z={getConfigNames:function(){return Object.keys(Q)},getConfigs:function(){return Q},normalizeConfig:function(e,t){return Q[e]&&"boolean"===Q[e].type?"function"!=typeof t?t:t():t}},ee=function(e){var t={};return e.on=function(e,n,a){if(!n||"function"!=typeof n)throw new Error("[ON] Callback should be a function.");t.hasOwnProperty(e)||(t[e]=[]);var r=t[e].push({callback:n,context:a})-1;return function(){t[e].splice(r,1),t[e].length||delete t[e]}},e.off=function(e,n){t.hasOwnProperty(e)&&(t[e]=t[e].filter((function(e){if(e.callback!==n)return e})))},e.publish=function(e){if(t.hasOwnProperty(e)){var n=[].slice.call(arguments,1);t[e].slice(0).forEach((function(e){e.callback.apply(e.context,n)}))}},e.publish},te={PENDING:"pending",CHANGED:"changed",COMPLETE:"complete"},ne={AAM:"aam",ADCLOUD:"adcloud",ANALYTICS:"aa",CAMPAIGN:"campaign",ECID:"ecid",LIVEFYRE:"livefyre",TARGET:"target",MEDIA_ANALYTICS:"mediaaa"},ae=(t(v={},ne.AAM,565),t(v,ne.ECID,565),v),re=(t(E={},ne.AAM,[1,10]),t(E,ne.ECID,[1,10]),E),ie=["videoaa","iabConsentHash"],oe=function(e){return Object.keys(e).map((function(t){return e[t]}))}(ne),se=function(){var e={};return e.callbacks=Object.create(null),e.add=function(t,n){if(!l(n))throw new Error("[callbackRegistryFactory] Make sure callback is a function or an array of functions.");e.callbacks[t]=e.callbacks[t]||[];var a=e.callbacks[t].push(n)-1;return function(){e.callbacks[t].splice(a,1)}},e.execute=function(t,n){if(e.callbacks[t]){n=(n=void 0===n?[]:n)instanceof Array?n:[n];try{for(;e.callbacks[t].length;){var a=e.callbacks[t].shift();"function"==typeof a?a.apply(null,n):a instanceof Array&&a[1].apply(a[0],n)}delete e.callbacks[t]}catch(e){}}},e.executeAll=function(t,n){(n||t&&!c(t))&&Object.keys(e.callbacks).forEach((function(n){var a=void 0!==t[n]?t[n]:"";e.execute(n,a)}),e)},e.hasCallbacks=function(){return Boolean(Object.keys(e.callbacks).length)},e},ce=function(){},le=function(e){var t=window.console;return!!t&&"function"==typeof t[e]},ue=function(e,t,n){return n()?function(){if(le(e)){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];console[e].apply(console,[t].concat(a))}}:ce},de=u,pe=function(){for(var e=[],t=0;t<256;t++){for(var n=t,a=0;a<8;a++)n=1&n?3988292384^n>>>1:n>>>1;e.push(n)}return function(t,n){t=unescape(encodeURIComponent(t)),n||(n=0),n^=-1;for(var a=0;a<t.length;a++){var r=255&(n^t.charCodeAt(a));n=n>>>8^e[r]}return(n^=-1)>>>0}}(),fe=new de("[ADOBE OPT-IN]"),me=function(t,n){return e(t)===n},ge=function(e,t){return e instanceof Array?e:me(e,"string")?[e]:t||[]},he=function(e){var t=Object.keys(e);return!!t.length&&t.every((function(t){return!0===e[t]}))},be=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(!e||Ee(e))&&ge(e).every((function(e){return oe.indexOf(e)>-1||t&&ie.indexOf(e)>-1}))},ye=function(e,t){return e.reduce((function(e,n){return e[n]=t,e}),{})},ve=function(e){return JSON.parse(JSON.stringify(e))},Ee=function(e){return"[object Array]"===Object.prototype.toString.call(e)&&!e.length},Pe=function(e){if(Ie(e))return e;try{return JSON.parse(e)}catch(e){return{}}},Ce=function(e){return void 0===e||(Ie(e)?be(Object.keys(e),!0):De(e))},De=function(e){try{var t=JSON.parse(e);return!!e&&me(e,"string")&&be(Object.keys(t),!0)}catch(e){return!1}},Ie=function(e){return null!==e&&me(e,"object")&&!1===Array.isArray(e)},ke=function(){},_e=function(e){return me(e,"function")?e():e},Ae=function(e,t){Ce(e)||fe.error("".concat(t))},Se=function(e){return Object.keys(e).map((function(t){return e[t]}))},Me=function(e){return Se(e).filter((function(e,t,n){return n.indexOf(e)===t}))},Re=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.command,a=t.params,r=void 0===a?{}:a,i=t.callback,o=void 0===i?ke:i;if(!n||-1===n.indexOf("."))throw new Error("[OptIn.execute] Please provide a valid command.");try{var s=n.split("."),c=e[s[0]],l=s[1];if(!c||"function"!=typeof c[l])throw new Error("Make sure the plugin and API name exist.");var u=Object.assign(r,{callback:o});c[l].call(c,u)}catch(e){fe.error("[execute] Something went wrong: "+e.message)}}};p.prototype=Object.create(Error.prototype),p.prototype.constructor=p;var Te="fetchPermissions",we="[OptIn#registerPlugin] Plugin is invalid.";f.Categories=ne,f.TimeoutError=p;var Oe=Object.freeze({OptIn:f,IabPlugin:b}),Ne=function(e,t){e.publishDestinations=function(n){var a=arguments[1],r=arguments[2];try{r="function"==typeof r?r:n.callback}catch(e){r=function(){}}var i=t;if(i.readyToAttachIframePreliminary()){if("string"==typeof n){if(!n.length)return void r({error:"subdomain is not a populated string."});if(!(a instanceof Array&&a.length))return void r({error:"messages is not a populated array."});var o=!1;if(a.forEach((function(e){"string"==typeof e&&e.length&&(i.addMessage(e),o=!0)})),!o)return void r({error:"None of the messages are populated strings."})}else{if(!R.isObject(n))return void r({error:"Invalid parameters passed."});var s=n;if("string"!=typeof(n=s.subdomain)||!n.length)return void r({error:"config.subdomain is not a populated string."});var c=s.urlDestinations;if(!(c instanceof Array&&c.length))return void r({error:"config.urlDestinations is not a populated array."});var l=[];c.forEach((function(e){R.isObject(e)&&(e.hideReferrer?e.message&&i.addMessage(e.message):l.push(e))})),function e(){l.length&&setTimeout((function(){var t=new Image,n=l.shift();t.src=n.url,i.onPageDestinationsFired.push(n),e()}),100)}()}i.iframe?(r({message:"The destination publishing iframe is already attached and loaded."}),i.requestToProcess()):!e.subdomain&&e._getField("MCMID")?(i.subdomain=n,i.doAttachIframe=!0,i.url=i.getUrl(),i.readyToAttachIframe()?(i.iframeLoadedCallbacks.push((function(e){r({message:"Attempted to attach and load the destination publishing iframe through this API call. Result: "+(e.message||"no result")})})),i.attachIframe()):r({error:"Encountered a problem in attempting to attach and load the destination publishing iframe through this API call."})):i.iframeLoadedCallbacks.push((function(e){r({message:"Attempted to attach and load the destination publishing iframe through normal Visitor API processing. Result: "+(e.message||"no result")})}))}else r({error:"The destination publishing iframe is disabled in the Visitor library."})}},xe=function e(t){function n(e,t){return e>>>t|e<<32-t}for(var a,r,i=Math.pow,o=i(2,32),s="",c=[],l=8*t.length,u=e.h=e.h||[],d=e.k=e.k||[],p=d.length,f={},m=2;p<64;m++)if(!f[m]){for(a=0;a<313;a+=m)f[a]=m;u[p]=i(m,.5)*o|0,d[p++]=i(m,1/3)*o|0}for(t+="\x80";t.length%64-56;)t+="\0";for(a=0;a<t.length;a++){if((r=t.charCodeAt(a))>>8)return;c[a>>2]|=r<<(3-a)%4*8}for(c[c.length]=l/o|0,c[c.length]=l,r=0;r<c.length;){var g=c.slice(r,r+=16),h=u;for(u=u.slice(0,8),a=0;a<64;a++){var b=g[a-15],y=g[a-2],v=u[0],E=u[4],P=u[7]+(n(E,6)^n(E,11)^n(E,25))+(E&u[5]^~E&u[6])+d[a]+(g[a]=a<16?g[a]:g[a-16]+(n(b,7)^n(b,18)^b>>>3)+g[a-7]+(n(y,17)^n(y,19)^y>>>10)|0);(u=[P+((n(v,2)^n(v,13)^n(v,22))+(v&u[1]^v&u[2]^u[1]&u[2]))|0].concat(u))[4]=u[4]+P|0}for(a=0;a<8;a++)u[a]=u[a]+h[a]|0}for(a=0;a<8;a++)for(r=3;r+1;r--){var C=u[a]>>8*r&255;s+=(C<16?0:"")+C.toString(16)}return s},je=function(e,t){return"SHA-256"!==t&&"SHA256"!==t&&"sha256"!==t&&"sha-256"!==t||(e=xe(e)),e},Le=function(e){return String(e).trim().toLowerCase()},Ve=Oe.OptIn;R.defineGlobalNamespace(),window.adobe.OptInCategories=Ve.Categories;var Fe=function(t,n,a){function r(){v._customerIDsHashChanged=!1}function i(e){var t=e;return function(e){var n=e||_.location.href;try{var a=v._extractParamFromUri(n,t);if(a)return te.parsePipeDelimetedKeyValues(a)}catch(e){}}}function o(e){function t(e,t,n){e&&e.match(z.VALID_VISITOR_ID_REGEX)&&(n===w&&(k=!0),t(e))}t(e[w],v.setMarketingCloudVisitorID,w),v._setFieldExpire(V,-1),t(e[j],v.setAnalyticsVisitorID)}function s(e){e=e||{},v._supplementalDataIDCurrent=e.supplementalDataIDCurrent||"",v._supplementalDataIDCurrentConsumed=e.supplementalDataIDCurrentConsumed||{},v._supplementalDataIDLast=e.supplementalDataIDLast||"",v._supplementalDataIDLastConsumed=e.supplementalDataIDLastConsumed||{}}function c(e){function t(e,t,n){return(n=n?n+="|":n)+(e+"=")+encodeURIComponent(t)}function n(e,n){var a=n[0],r=n[1];return null!=r&&r!==F&&(e=t(a,r,e)),e}return function(e){return(e=e?e+="|":e)+"TS="+te.getTimestampInSeconds()}(e.reduce(n,""))}function l(e){var t=e.minutesToLive,n="";return(v.idSyncDisableSyncs||v.disableIdSyncs)&&(n=n||"Error: id syncs have been disabled"),"string"==typeof e.dpid&&e.dpid.length||(n=n||"Error: config.dpid is empty"),"string"==typeof e.url&&e.url.length||(n=n||"Error: config.url is empty"),void 0===t?t=20160:(t=parseInt(t,10),(isNaN(t)||t<=0)&&(n=n||"Error: config.minutesToLive needs to be a positive number")),{error:n,ttl:t}}function u(){return!(!v.configs.doesOptInApply||E.optIn.isComplete&&d())}function d(){return v.configs.doesOptInApply&&v.configs.isIabContext?E.optIn.isApproved(E.optIn.Categories.ECID)&&I:E.optIn.isApproved(E.optIn.Categories.ECID)}function p(){[["getMarketingCloudVisitorID"],["setCustomerIDs",void 0],["syncIdentity",void 0],["getAnalyticsVisitorID"],["getAudienceManagerLocationHint"],["getLocationHint"],["getAudienceManagerBlob"]].forEach((function(e){var t=e[0],n=2===e.length?e[1]:"",a=v[t];v[t]=function(e){return d()&&v.isAllowed()?a.apply(v,arguments):("function"==typeof e&&v._callCallback(e,[n]),n)}}))}function f(){var e=v._getAudienceManagerURLData(),t=e.url;return v._loadData(T,t,null,e)}function m(e,t){if(I=!0,e)throw new Error("[IAB plugin] : "+e);t&&t.gdprApplies&&(C=t.consentString,D=t.hasConsentChangedSinceLastCmpPull?1:0),f(),b()}function g(e,t){if(I=!0,e)throw new Error("[IAB plugin] : "+e);t.gdprApplies&&(C=t.consentString,D=t.hasConsentChangedSinceLastCmpPull?1:0),v.init(),b()}function h(){E.optIn.isComplete&&(E.optIn.isApproved(E.optIn.Categories.ECID)?v.configs.isIabContext?E.optIn.execute({command:"iabPlugin.fetchConsentData",callback:g}):(v.init(),b()):v.configs.isIabContext?E.optIn.execute({command:"iabPlugin.fetchConsentData",callback:m}):(p(),b()))}function b(){E.optIn.off("complete",h)}if(!a||a.split("").reverse().join("")!==t)throw new Error("Please use `Visitor.getInstance` to instantiate Visitor.");var v=this,E=window.adobe,C="",D=0,I=!1,k=!1;v.version="5.5.0";var _=y,A=_.Visitor;A.version=v.version,A.AuthState=P.AUTH_STATE,A.OptOut=P.OPT_OUT,_.s_c_in||(_.s_c_il=[],_.s_c_in=0),v._c="Visitor",v._il=_.s_c_il,v._in=_.s_c_in,v._il[v._in]=v,_.s_c_in++,v._instanceType="regular",v._log={requests:[]},v.marketingCloudOrgID=t,v.cookieName="AMCV_"+t,v.sessionCookieName="AMCVS_"+t;var S={};n&&n.secureCookie&&n.sameSiteCookie&&(S={sameSite:n.sameSiteCookie,secure:n.secureCookie}),v.cookieDomain=v.useLocalStorage?"":q(null,S),v.loadSSL=!0,v.loadTimeout=3e4,v.CORSErrors=[],v.marketingCloudServer=v.audienceManagerServer="dpm.demdex.net",v.sdidParamExpiry=30;var M=null,T="MC",w="MCMID",O="MCIDTS",x="A",j="MCAID",L="AAM",V="MCAAMB",F="NONE",U=function(e){return!Object.prototype[e]},Y=K(v);v.FIELDS=P.FIELDS,v.cookieRead=function(e){return v.useLocalStorage?e===v.sessionCookieName?sessionStorage.getItem(e):localStorage.getItem(e):G.get(e)},v.cookieWrite=function(e,t,n){var a=""+t;if(v.useLocalStorage)return e===v.sessionCookieName?sessionStorage.setItem(e,a):localStorage.setItem(e,a);var r=v.cookieLifetime?(""+v.cookieLifetime).toUpperCase():"",i={expires:n,domain:v.cookieDomain,cookieLifetime:r};return v.configs&&v.configs.secureCookie&&"https:"===location.protocol&&(i.secure=!0),v.configs&&v.configs.sameSiteCookie&&"https:"===location.protocol&&(i.sameSite=P.SAME_SITE_VALUES[v.configs.sameSiteCookie.toUpperCase()]||"Lax"),G.set(e,a,i)},v.removeCookie=function(e){if(v.useLocalStorage)return e===v.sessionCookieName?sessionStorage.removeItem(e):localStorage.removeItem(e);var t={domain:v.cookieDomain};return v.configs&&v.configs.secureCookie&&"https:"===location.protocol&&(t.secure=!0),v.configs&&v.configs.sameSiteCookie&&"https:"===location.protocol&&(t.sameSite=P.SAME_SITE_VALUES[v.configs.sameSiteCookie.toUpperCase()]||"Lax"),G.remove(e,t)},v.resetState=function(e){e?v._mergeServerState(e):s()},v._isAllowedDone=!1,v._isAllowedFlag=!1,v.isAllowed=function(){return v._isAllowedDone||(v._isAllowedDone=!0,(v.cookieRead(v.cookieName)||v.cookieWrite(v.cookieName,"T",1))&&(v._isAllowedFlag=!0)),"T"===v.cookieRead(v.cookieName)&&v.removeCookie(v.cookieName),v._isAllowedFlag},v.setMarketingCloudVisitorID=function(e){v._setMarketingCloudFields(e)},v._use1stPartyMarketingCloudServer=!1,v.getMarketingCloudVisitorID=function(e,t){v.marketingCloudServer&&v.marketingCloudServer.indexOf(".demdex.net")<0&&(v._use1stPartyMarketingCloudServer=!0);var n=v._getAudienceManagerURLData("_setMarketingCloudFields"),a=n.url;return v._getRemoteField(w,a,e,t,n)};var Q=function(e,t){var n={};v.getMarketingCloudVisitorID((function(){t.forEach((function(e){n[e]=v._getField(e,!0)})),-1!==t.indexOf("MCOPTOUT")?v.isOptedOut((function(t){n.MCOPTOUT=t,e(n)}),null,!0):e(n)}),!0)};v.getVisitorValues=function(e,t){var n={MCMID:{fn:v.getMarketingCloudVisitorID,args:[!0],context:v},MCOPTOUT:{fn:v.isOptedOut,args:[void 0,!0],context:v},MCAID:{fn:v.getAnalyticsVisitorID,args:[!0],context:v},MCAAMLH:{fn:v.getAudienceManagerLocationHint,args:[!0],context:v},MCAAMB:{fn:v.getAudienceManagerBlob,args:[!0],context:v}},a=t&&t.length?R.pluck(n,t):n;t&&-1===t.indexOf("MCAID")?Q(e,t):B(a,e)},v._currentCustomerIDs={},v._customerIDsHashChanged=!1,v._newCustomerIDsHash="",v.setCustomerIDs=function(t,n){if(!v.isOptedOut()&&t){if(!R.isObject(t)||R.isObjectEmpty(t))return!1;var a,i,o,s;for(a in v._readVisitor(),t)if(U(a)&&(v._currentCustomerIDs.dataSources=v._currentCustomerIDs.dataSources||{},n=(i=t[a]).hasOwnProperty("hashType")?i.hashType:n,i))if("object"===e(i)){var c={};if(i.id){if(n){if(!(s=je(Le(i.id),n)))return;i.id=s,c.hashType=n}c.id=i.id}null!=i.authState&&(c.authState=i.authState),v._currentCustomerIDs.dataSources[a]=c}else if(n){if(!(s=je(Le(i),n)))return;v._currentCustomerIDs.dataSources[a]={id:s,hashType:n}}else v._currentCustomerIDs.dataSources[a]={id:i};var l=v.getCustomerIDs(!0),u=v._getField("MCCIDH"),d="";for(o in u||(u=0),l){var p=l[o];if(!R.isObjectEmpty(p))for(a in p)U(a)&&(d+=(d?"|":"")+a+"|"+((i=p[a]).id?i.id:"")+(i.authState?i.authState:""))}v._newCustomerIDsHash=String(v._hash(d)),v._newCustomerIDsHash!==u&&(v._customerIDsHashChanged=!0,v._mapCustomerIDs(r))}},v.syncIdentity=function(t,n){if(!v.isOptedOut()&&t){if(!R.isObject(t)||R.isObjectEmpty(t))return!1;var a,i,o,s,c;for(a in v._readVisitor(),t)if(U(a)&&(v._currentCustomerIDs.nameSpaces=v._currentCustomerIDs.nameSpaces||{},n=(i=t[a]).hasOwnProperty("hashType")?i.hashType:n,i&&"object"===e(i))){var l={};if(i.id){if(n){if(!(o=je(Le(i.id),n)))return;i.id=o,l.hashType=n}l.id=i.id}null!=i.authState&&(l.authState=i.authState),i.dataSource&&(v._currentCustomerIDs.dataSources=v._currentCustomerIDs.dataSources||{},s=i.dataSource,v._currentCustomerIDs.dataSources[s]=l),v._currentCustomerIDs.nameSpaces[a]=l}var u=v.getCustomerIDs(!0),d=v._getField("MCCIDH"),p="";for(c in d||(d="0"),u){var f=u[c];if(!R.isObjectEmpty(f))for(a in f)U(a)&&(p+=(p?"|":"")+a+"|"+((i=f[a]).id?i.id:"")+(i.authState?i.authState:""))}v._newCustomerIDsHash=String(v._hash(p)),v._newCustomerIDsHash!==d&&(v._customerIDsHashChanged=!0,v._mapCustomerIDs(r))}},v.getCustomerIDs=function(e){v._readVisitor();var t,n,a={dataSources:{},nameSpaces:{}},r=v._currentCustomerIDs.dataSources;for(t in r)U(t)&&(n=r[t]).id&&(a.dataSources[t]||(a.dataSources[t]={}),a.dataSources[t].id=n.id,null!=n.authState?a.dataSources[t].authState=n.authState:a.dataSources[t].authState=A.AuthState.UNKNOWN,n.hashType&&(a.dataSources[t].hashType=n.hashType));var i=v._currentCustomerIDs.nameSpaces;for(t in i)U(t)&&(n=i[t]).id&&(a.nameSpaces[t]||(a.nameSpaces[t]={}),a.nameSpaces[t].id=n.id,null!=n.authState?a.nameSpaces[t].authState=n.authState:a.nameSpaces[t].authState=A.AuthState.UNKNOWN,n.hashType&&(a.nameSpaces[t].hashType=n.hashType));return e?a:a.dataSources},v.setAnalyticsVisitorID=function(e){v._setAnalyticsFields(e)},v.getAnalyticsVisitorID=function(e,t,n){if(!te.isTrackingServerPopulated()&&!n)return v._callCallback(e,[""]),"";var a="";if(n||(a=v.getMarketingCloudVisitorID((function(){v.getAnalyticsVisitorID(e,!0)}))),a||n){var r=n?v.marketingCloudServer:v.trackingServer,i="";v.loadSSL&&(n?v.marketingCloudServerSecure&&(r=v.marketingCloudServerSecure):v.trackingServerSecure&&(r=v.trackingServerSecure));var o={};if(r){var s="http"+(v.loadSSL?"s":"")+"://"+r+"/id",c=v.configs.cookieLifetime,l="d_visid_ver="+v.version+"&mcorgid="+encodeURIComponent(v.marketingCloudOrgID)+(a?"&mid="+encodeURIComponent(a):"")+(c?"&cl="+encodeURIComponent(c):"")+(v.idSyncDisable3rdPartySyncing||v.disableThirdPartyCookies?"&d_coppa=true":""),u=["s_c_il",v._in,"_set"+(n?"MarketingCloud":"Analytics")+"Fields"];i=s+"?"+l+"&callback=s_c_il%5B"+v._in+"%5D._set"+(n?"MarketingCloud":"Analytics")+"Fields",o.corsUrl=s+"?"+l,o.callback=u}return o.url=i,v._getRemoteField(n?w:j,i,e,t,o)}return""},v.getAudienceManagerLocationHint=function(e,t){if(v.getMarketingCloudVisitorID((function(){v.getAudienceManagerLocationHint(e,!0)}))){var n=v._getField(j);if(!n&&te.isTrackingServerPopulated()&&(n=v.getAnalyticsVisitorID((function(){v.getAudienceManagerLocationHint(e,!0)}))),n||!te.isTrackingServerPopulated()){var a=v._getAudienceManagerURLData(),r=a.url;return v._getRemoteField("MCAAMLH",r,e,t,a)}}return""},v.getLocationHint=v.getAudienceManagerLocationHint,v.getAudienceManagerBlob=function(e,t){if(v.getMarketingCloudVisitorID((function(){v.getAudienceManagerBlob(e,!0)}))){var n=v._getField(j);if(!n&&te.isTrackingServerPopulated()&&(n=v.getAnalyticsVisitorID((function(){v.getAudienceManagerBlob(e,!0)}))),n||!te.isTrackingServerPopulated()){var a=v._getAudienceManagerURLData(),r=a.url;return v._customerIDsHashChanged&&v._setFieldExpire(V,-1),v._getRemoteField(V,r,e,t,a)}}return""},v._supplementalDataIDCurrent="",v._supplementalDataIDCurrentConsumed={},v._supplementalDataIDLast="",v._supplementalDataIDLastConsumed={},v.getSupplementalDataID=function(e,t){v._supplementalDataIDCurrent||t||(v._supplementalDataIDCurrent=v._generateID(1));var n=v._supplementalDataIDCurrent;return v._supplementalDataIDLast&&!v._supplementalDataIDLastConsumed[e]?(n=v._supplementalDataIDLast,v._supplementalDataIDLastConsumed[e]=!0):n&&(v._supplementalDataIDCurrentConsumed[e]&&(v._supplementalDataIDLast=v._supplementalDataIDCurrent,v._supplementalDataIDLastConsumed=v._supplementalDataIDCurrentConsumed,v._supplementalDataIDCurrent=n=t?"":v._generateID(1),v._supplementalDataIDCurrentConsumed={}),n&&(v._supplementalDataIDCurrentConsumed[e]=!0)),n};var Z=!1;v._liberatedOptOut=null,v.getOptOut=function(e,t){var n=v._getAudienceManagerURLData("_setMarketingCloudFields"),a=n.url;if(d())return v._getRemoteField("MCOPTOUT",a,e,t,n);if(v._registerCallback("liberatedOptOut",e),null!==v._liberatedOptOut)return v._callAllCallbacks("liberatedOptOut",[v._liberatedOptOut]),Z=!1,v._liberatedOptOut;if(Z)return null;Z=!0;var r="liberatedGetOptOut";return n.corsUrl=n.corsUrl.replace(/\.demdex\.net\/id\?/,".demdex.net/optOutStatus?"),n.callback=[r],y[r]=function(e){if(e===Object(e)){var t,n,a=R.parseOptOut(e,t,F);t=a.optOut,n=1e3*a.d_ottl,v._liberatedOptOut=t,setTimeout((function(){v._liberatedOptOut=null}),n)}v._callAllCallbacks("liberatedOptOut",[t]),Z=!1},Y.fireCORS(n),null},v.isOptedOut=function(e,t,n){t||(t=A.OptOut.GLOBAL);var a=v.getOptOut((function(n){var a=n===A.OptOut.GLOBAL||n.indexOf(t)>=0;v._callCallback(e,[a])}),n);return a?a===A.OptOut.GLOBAL||a.indexOf(t)>=0:null};var ee={subscribed:!1,callbacks:[]};v.onReceiveEcid=function(e){if(d())return v.getMarketingCloudVisitorID(e,!0);ee.subscribed=!0,e&&"function"==typeof e&&ee.callbacks.push(e)},v._fields=null,v._fieldsExpired=null,v._hash=function(e){var t,n=0;if(e)for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n&=n;return n},v._generateID=J,v._generateLocalMID=function(){var e=v._generateID(0);return re.isClientSideMarketingCloudVisitorID=!0,e},v._callbackList=null,v._callCallback=function(e,t){try{"function"==typeof e?e.apply(_,t):e[1].apply(e[0],t)}catch(e){}},v._registerCallback=function(e,t){t&&(null==v._callbackList&&(v._callbackList={}),null==v._callbackList[e]&&(v._callbackList[e]=[]),v._callbackList[e].push(t))},v._callAllCallbacks=function(e,t){if(null!=v._callbackList){var n=v._callbackList[e];if(n)for(;n.length>0;)v._callCallback(n.shift(),t)}},v._addQuerystringParam=function(e,t,n,a){var r=encodeURIComponent(t)+"="+encodeURIComponent(n),i=te.parseHash(e),o=te.hashlessUrl(e);if(-1===o.indexOf("?"))return o+"?"+r+i;var s=o.split("?"),c=s[0]+"?",l=s[1];return c+te.addQueryParamAtLocation(l,r,a)+i},v._extractParamFromUri=function(e,t){var n=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e);if(n&&n.length)return decodeURIComponent(n[1])},v._parseAdobeMcFromUrl=i(z.ADOBE_MC),v._parseAdobeMcSdidFromUrl=i(z.ADOBE_MC_SDID),v._attemptToPopulateSdidFromUrl=function(e){var n=v._parseAdobeMcSdidFromUrl(e),a=1e9;n&&n.TS&&(a=te.getTimestampInSeconds()-n.TS),n&&n.SDID&&n.MCORGID===t&&a<v.sdidParamExpiry&&(v._supplementalDataIDCurrent=n.SDID,v._supplementalDataIDCurrentConsumed.SDID_URL_PARAM=!0)},v._attemptToPopulateIdsFromUrl=function(){var e=v._parseAdobeMcFromUrl();if(e&&e.TS){var n=te.getTimestampInSeconds()-e.TS;if(Math.floor(n/60)>z.ADOBE_MC_TTL_IN_MIN||e.MCORGID!==t)return;o(e)}},v._mergeServerState=function(e){if(e)try{if((e=function(e){return te.isObject(e)?e:JSON.parse(e)}(e))[v.marketingCloudOrgID]){var t=e[v.marketingCloudOrgID];!function(e){te.isObject(e)&&v.setCustomerIDs(e)}(t.customerIDs),s(t.sdid)}}catch(e){throw new Error("`serverState` has an invalid format.")}},v._timeout=null,v._loadData=function(e,t,n,a){t=v._addQuerystringParam(t,"d_fieldgroup",e,1),a.url=v._addQuerystringParam(a.url,"d_fieldgroup",e,1),a.corsUrl=v._addQuerystringParam(a.corsUrl,"d_fieldgroup",e,1),re.fieldGroupObj[e]=!0,a===Object(a)&&a.corsUrl&&"XMLHttpRequest"===Y.corsMetadata.corsType&&Y.fireCORS(a,n,e)},v._clearTimeout=function(e){null!=v._timeout&&v._timeout[e]&&(clearTimeout(v._timeout[e]),v._timeout[e]=0)},v._settingsDigest=0,v._getSettingsDigest=function(){if(!v._settingsDigest){var e=v.version;v.audienceManagerServer&&(e+="|"+v.audienceManagerServer),v.audienceManagerServerSecure&&(e+="|"+v.audienceManagerServerSecure),v._settingsDigest=v._hash(e)}return v._settingsDigest},v._readVisitorDone=!1,v._readVisitor=function(){if(!v._readVisitorDone){v._readVisitorDone=!0;var e,t,n,a,r,i,o=v._getSettingsDigest(),s=!1,c=v.cookieRead(v.cookieName),l=new Date;if(c||k||v.discardTrackingServerECID||(c=v.cookieRead(z.FIRST_PARTY_SERVER_COOKIE)),null==v._fields&&(v._fields={}),c&&"T"!==c)for((c=c.split("|"))[0].match(/^[\-0-9]+$/)&&(parseInt(c[0],10)!==o&&(s=!0),c.shift()),c.length%2==1&&c.pop(),e=0;e<c.length;e+=2)n=(t=c[e].split("-"))[0],a=c[e+1],t.length>1?(r=parseInt(t[1],10),i=t[1].indexOf("s")>0):(r=0,i=!1),s&&("MCCIDH"===n&&(a=""),r>0&&(r=l.getTime()/1e3-60)),n&&a&&(v._setField(n,a,1),r>0&&(v._fields["expire"+n]=r+(i?"s":""),(l.getTime()>=1e3*r||i&&!v.cookieRead(v.sessionCookieName))&&(v._fieldsExpired||(v._fieldsExpired={}),v._fieldsExpired[n]=!0)));!v._getField(j)&&te.isTrackingServerPopulated()&&(c=v.cookieRead("s_vi"))&&(c=c.split("|")).length>1&&c[0].indexOf("v1")>=0&&((e=(a=c[1]).indexOf("["))>=0&&(a=a.substring(0,e)),a&&a.match(z.VALID_VISITOR_ID_REGEX)&&v._setField(j,a))}},v._appendVersionTo=function(e){var t="vVersion|"+v.version,n=e?v._getCookieVersion(e):null;return n?W.areVersionsDifferent(n,v.version)&&(e=e.replace(z.VERSION_REGEX,t)):e+=(e?"|":"")+t,e},v._writeVisitor=function(){var e,t,n=v._getSettingsDigest();for(e in v._fields)U(e)&&v._fields[e]&&"expire"!==e.substring(0,6)&&(t=v._fields[e],n+=(n?"|":"")+e+(v._fields["expire"+e]?"-"+v._fields["expire"+e]:"")+"|"+t);n=v._appendVersionTo(n),v.cookieWrite(v.cookieName,n,1)},v._getField=function(e,t){return null==v._fields||!t&&v._fieldsExpired&&v._fieldsExpired[e]?null:v._fields[e]},v._setField=function(e,t,n){null==v._fields&&(v._fields={}),v._fields[e]=t,n||v._writeVisitor()},v._getFieldList=function(e,t){var n=v._getField(e,t);return n?n.split("*"):null},v._setFieldList=function(e,t,n){v._setField(e,t?t.join("*"):"",n)},v._getFieldMap=function(e,t){var n=v._getFieldList(e,t);if(n){var a,r={};for(a=0;a<n.length;a+=2)r[n[a]]=n[a+1];return r}return null},v._setFieldMap=function(e,t,n){var a,r=null;if(t)for(a in r=[],t)U(a)&&(r.push(a),r.push(t[a]));v._setFieldList(e,r,n)},v._setFieldExpire=function(e,t,n){var a=new Date;a.setTime(a.getTime()+1e3*t),null==v._fields&&(v._fields={}),v._fields["expire"+e]=Math.floor(a.getTime()/1e3)+(n?"s":""),t<0?(v._fieldsExpired||(v._fieldsExpired={}),v._fieldsExpired[e]=!0):v._fieldsExpired&&(v._fieldsExpired[e]=!1),n&&(v.cookieRead(v.sessionCookieName)||v.cookieWrite(v.sessionCookieName,"1"))},v._findVisitorID=function(t){return t&&("object"===e(t)&&(t=t.d_mid?t.d_mid:t.visitorID?t.visitorID:t.id?t.id:t.uuid?t.uuid:""+t),t&&"NOTARGET"===(t=t.toUpperCase())&&(t=F),t&&(t===F||t.match(z.VALID_VISITOR_ID_REGEX))||(t="")),t},v._setFields=function(t,n){if(v._clearTimeout(t),null!=v._loading&&(v._loading[t]=!1),re.fieldGroupObj[t]&&re.setState(t,!1),t===T){!0!==re.isClientSideMarketingCloudVisitorID&&(re.isClientSideMarketingCloudVisitorID=!1);var a=v._getField(w);if(!a||v.overwriteCrossDomainMCIDAndAID){if(!(a="object"===e(n)&&n.mid?n.mid:v._findVisitorID(n))){if(v._use1stPartyMarketingCloudServer&&!v.tried1stPartyMarketingCloudServer)return v.tried1stPartyMarketingCloudServer=!0,void v.getAnalyticsVisitorID(null,!1,!0);a=v._generateLocalMID()}v._setField(w,a)}a&&a!==F||(a=""),"object"===e(n)&&((n.d_region||n.dcs_region||n.d_blob||n.blob)&&v._setFields(L,n),v._use1stPartyMarketingCloudServer&&n.mid&&v._setFields(x,{id:n.id})),v._callAllCallbacks(w,[a])}if(t===L&&"object"===e(n)){var r=604800;null!=n.id_sync_ttl&&n.id_sync_ttl&&(r=parseInt(n.id_sync_ttl,10));var i=ne.getRegionAndCheckIfChanged(n,r);v._callAllCallbacks("MCAAMLH",[i]);var o=v._getField(V);(n.d_blob||n.blob)&&((o=n.d_blob)||(o=n.blob),v._setFieldExpire(V,r),v._setField(V,o)),o||(o=""),v._callAllCallbacks(V,[o]),!n.error_msg&&v._newCustomerIDsHash&&v._setField("MCCIDH",v._newCustomerIDsHash)}if(t===x){var s=v._getField(j);s&&!v.overwriteCrossDomainMCIDAndAID||((s=v._findVisitorID(n))?s!==F&&v._setFieldExpire(V,-1):s=F,v._setField(j,s)),s&&s!==F||(s=""),v._callAllCallbacks(j,[s])}if(v.idSyncDisableSyncs||v.disableIdSyncs)ne.idCallNotProcesssed=!0;else{ne.idCallNotProcesssed=!1;var c={};c.ibs=n.ibs,c.subdomain=n.subdomain,ne.processIDCallData(c)}if(n===Object(n)){var l,u;d()&&v.isAllowed()&&(l=v._getField("MCOPTOUT"));var p=R.parseOptOut(n,l,F);l=p.optOut,u=p.d_ottl,v._setFieldExpire("MCOPTOUT",u,!0),v._setField("MCOPTOUT",l),v._callAllCallbacks("MCOPTOUT",[l])}},v._loading=null,v._getRemoteField=function(e,t,n,a,r){var i,o="",s=te.isFirstPartyAnalyticsVisitorIDCall(e),c={MCAAMLH:!0,MCAAMB:!0};if(d()&&v.isAllowed())if(v._readVisitor(),!(!(o=v._getField(e,!0===c[e]))||v._fieldsExpired&&v._fieldsExpired[e])||v.disableThirdPartyCalls&&!s)o||(e===w?(v._registerCallback(e,n),o=v._generateLocalMID(),v.setMarketingCloudVisitorID(o)):e===j?(v._registerCallback(e,n),o="",v.setAnalyticsVisitorID(o)):(o="",a=!0));else if(e===w||"MCOPTOUT"===e?i=T:"MCAAMLH"===e||e===V?i=L:e===j&&(i=x),i)return!t||null!=v._loading&&v._loading[i]||(null==v._loading&&(v._loading={}),v._loading[i]=!0,i===L&&(D=0),v._loadData(i,t,(function(t){if(!v._getField(e)){t&&re.setState(i,!0);var n="";e===w?n=v._generateLocalMID():i===L&&(n={error_msg:"timeout"}),v._setFields(i,n)}}),r)),v._registerCallback(e,n),o||(t||v._setFields(i,{id:F}),"");return e!==w&&e!==j||o!==F||(o="",a=!0),n&&a&&v._callCallback(n,[o]),e===w&&ee.subscribed&&(ee.callbacks&&ee.callbacks.length&&ee.callbacks.forEach((function(e){v._callCallback(e,[o])})),ee.subscribed=!1,ee.callbacks.length=0),o},v._setMarketingCloudFields=function(e){v._readVisitor(),v._setFields(T,e)},v._mapCustomerIDs=function(e){v.getAudienceManagerBlob(e,!0)},v._setAnalyticsFields=function(e){v._readVisitor(),v._setFields(x,e)},v._setAudienceManagerFields=function(e){v._readVisitor(),v._setFields(L,e)},v._getAudienceManagerURLData=function(e){var t=v.audienceManagerServer,n="",a=v._getField(w),r=v._getField(V,!0),i=v._getField(j),o=i&&i!==F?"&d_cid_ic=AVID%01"+encodeURIComponent(i):"";if(v.loadSSL&&v.audienceManagerServerSecure&&(t=v.audienceManagerServerSecure),t){var s,c,l,u=v.getCustomerIDs(!0);if(u)for(c in u){var d=u[c];if(!R.isObjectEmpty(d)){var p="nameSpaces"===c?"&d_cid_ns=":"&d_cid_ic=";for(s in d)U(s)&&(l=d[s],o+=p+encodeURIComponent(s)+"%01"+encodeURIComponent(l.id?l.id:"")+(l.authState?"%01"+l.authState:""))}}e||(e="_setAudienceManagerFields");var f="http"+(v.loadSSL?"s":"")+"://"+t+"/id",m="d_visid_ver="+v.version+(C&&-1!==f.indexOf("demdex.net")?"&gdpr=1&gdpr_consent="+C:"")+(D&&-1!==f.indexOf("demdex.net")?"&d_cf="+D:"")+"&d_rtbd=json&d_ver=2"+(!a&&v._use1stPartyMarketingCloudServer?"&d_verify=1":"")+"&d_orgid="+encodeURIComponent(v.marketingCloudOrgID)+"&d_nsid="+(v.idSyncContainerID||0)+(a?"&d_mid="+encodeURIComponent(a):"")+(v.idSyncDisable3rdPartySyncing||v.disableThirdPartyCookies?"&d_coppa=true":"")+(!0===M?"&d_coop_safe=1":!1===M?"&d_coop_unsafe=1":"")+(r?"&d_blob="+encodeURIComponent(r):"")+o,g=["s_c_il",v._in,e];return{url:n=f+"?"+m+"&d_cb=s_c_il%5B"+v._in+"%5D."+e,corsUrl:f+"?"+m,callback:g}}return{url:n}},v.appendVisitorIDsTo=function(e){try{var t=[[w,v._getField(w)],[j,v._getField(j)],["MCORGID",v.marketingCloudOrgID]];return v._addQuerystringParam(e,z.ADOBE_MC,c(t))}catch(t){return e}},v.appendSupplementalDataIDTo=function(e,t){if(!(t=t||v.getSupplementalDataID(te.generateRandomString(),!0)))return e;try{var n=c([["SDID",t],["MCORGID",v.marketingCloudOrgID]]);return v._addQuerystringParam(e,z.ADOBE_MC_SDID,n)}catch(t){return e}};var te={parseHash:function(e){var t=e.indexOf("#");return t>0?e.substr(t):""},hashlessUrl:function(e){var t=e.indexOf("#");return t>0?e.substr(0,t):e},addQueryParamAtLocation:function(e,t,n){var a=e.split("&");return n=null!=n?n:a.length,a.splice(n,0,t),a.join("&")},isFirstPartyAnalyticsVisitorIDCall:function(e,t,n){return e===j&&(t||(t=v.trackingServer),n||(n=v.trackingServerSecure),!("string"!=typeof(a=v.loadSSL?n:t)||!a.length)&&a.indexOf("2o7.net")<0&&a.indexOf("omtrdc.net")<0);var a},isObject:function(e){return Boolean(e&&e===Object(e))},removeCookie:function(e){G.remove(e,{domain:v.cookieDomain})},isTrackingServerPopulated:function(){return!!v.trackingServer||!!v.trackingServerSecure},getTimestampInSeconds:function(){return Math.round((new Date).getTime()/1e3)},parsePipeDelimetedKeyValues:function(e){return e.split("|").reduce((function(e,t){var n=t.split("=");return e[n[0]]=decodeURIComponent(n[1]),e}),{})},generateRandomString:function(e){e=e||5;for(var t="",n="abcdefghijklmnopqrstuvwxyz0123456789";e--;)t+=n[Math.floor(Math.random()*n.length)];return t},normalizeBoolean:function(e){return"true"===e||"false"!==e&&e},parseBoolean:function(e){return"true"===e||"false"!==e&&null},replaceMethodsWithFunction:function(e,t){for(var n in e)e.hasOwnProperty(n)&&"function"==typeof e[n]&&(e[n]=t);return e}};v._helpers=te;var ne=X(v,A);v._destinationPublishing=ne,v.timeoutMetricsLog=[];var ae,re={isClientSideMarketingCloudVisitorID:null,MCIDCallTimedOut:null,AnalyticsIDCallTimedOut:null,AAMIDCallTimedOut:null,fieldGroupObj:{},setState:function(e,t){switch(e){case T:!1===t?!0!==this.MCIDCallTimedOut&&(this.MCIDCallTimedOut=!1):this.MCIDCallTimedOut=t;break;case x:!1===t?!0!==this.AnalyticsIDCallTimedOut&&(this.AnalyticsIDCallTimedOut=!1):this.AnalyticsIDCallTimedOut=t;break;case L:!1===t?!0!==this.AAMIDCallTimedOut&&(this.AAMIDCallTimedOut=!1):this.AAMIDCallTimedOut=t}}};v.isClientSideMarketingCloudVisitorID=function(){return re.isClientSideMarketingCloudVisitorID},v.MCIDCallTimedOut=function(){
return re.MCIDCallTimedOut},v.AnalyticsIDCallTimedOut=function(){return re.AnalyticsIDCallTimedOut},v.AAMIDCallTimedOut=function(){return re.AAMIDCallTimedOut},v.idSyncGetOnPageSyncInfo=function(){return v._readVisitor(),v._getField("MCSYNCSOP")},v.idSyncByURL=function(e){if(!v.isOptedOut()){var t=l(e||{});if(t.error)return t.error;var n,a,r=e.url,i=encodeURIComponent,o=ne;return r=r.replace(/^https:/,"").replace(/^http:/,""),n=R.encodeAndBuildRequest(["",e.dpid,e.dpuuid||""],","),a=["ibs",i(e.dpid),"img",i(r),t.ttl,"",n],o.addMessage(a.join("|")),o.requestToProcess(),"Successfully queued"}},v.idSyncByDataSource=function(e){if(!v.isOptedOut())return e===Object(e)&&"string"==typeof e.dpuuid&&e.dpuuid.length?(e.url="//dpm.demdex.net/ibs:dpid="+e.dpid+"&dpuuid="+e.dpuuid,v.idSyncByURL(e)):"Error: config or config.dpuuid is empty"},Ne(v,ne),v._getCookieVersion=function(e){e=e||v.cookieRead(v.cookieName);var t=z.VERSION_REGEX.exec(e);return t&&t.length>1?t[1]:null},v._resetAmcvCookie=function(e){var t=v._getCookieVersion();t&&!W.isLessThan(t,e)||v.removeCookie(v.cookieName)},v.setAsCoopSafe=function(){M=!0},v.setAsCoopUnsafe=function(){M=!1},function(){if(v.configs=Object.create(null),te.isObject(n))for(var e in n)U(e)&&(v[e]=n[e],v.configs[e]=n[e])}(),p(),v.init=function(){u()&&(E.optIn.fetchPermissions(h,!0),!E.optIn.isApproved(E.optIn.Categories.ECID))||ae||(ae=!0,function(){if(te.isObject(n)){v.idSyncContainerID=v.idSyncContainerID||0,M="boolean"==typeof v.isCoopSafe?v.isCoopSafe:te.parseBoolean(v.isCoopSafe),v.resetBeforeVersion&&v._resetAmcvCookie(v.resetBeforeVersion),v._attemptToPopulateIdsFromUrl(),v._attemptToPopulateSdidFromUrl(),v._readVisitor();var e=v._getField(O),t=Math.ceil((new Date).getTime()/z.MILLIS_PER_DAY);v.idSyncDisableSyncs||v.disableIdSyncs||!ne.canMakeSyncIDCall(e,t)||(v._setFieldExpire(V,-1),v._setField(O,t)),v.getMarketingCloudVisitorID(),v.getAudienceManagerLocationHint(),v.getAudienceManagerBlob(),v._mergeServerState(v.serverState)}else v._attemptToPopulateIdsFromUrl(),v._attemptToPopulateSdidFromUrl()}(),function(){if(!v.idSyncDisableSyncs&&!v.disableIdSyncs){ne.checkDPIframeSrc();var e=function(){var e=ne;e.readyToAttachIframe()&&e.attachIframe()};_.addEventListener("load",(function(){A.windowLoaded=!0,e()}));try{$.receiveMessage((function(e){ne.receiveMessage(e.data)}),ne.iframeHost)}catch(e){}}}(),v.whitelistIframeDomains&&z.POST_MESSAGE_ENABLED&&(v.whitelistIframeDomains=v.whitelistIframeDomains instanceof Array?v.whitelistIframeDomains:[v.whitelistIframeDomains],v.whitelistIframeDomains.forEach((function(e){var n=new N(t,e),a=H(v,n);$.receiveMessage(a,e)}))))}};Fe.config=Z,y.Visitor=Fe;var Ue=Fe,He=function(e){if(R.isObject(e))return Object.keys(e).filter((function(t){return""!==e[t]&&Z.getConfigs()[t]})).reduce((function(t,n){var a=Z.normalizeConfig(n,e[n]),r=R.normalizeBoolean(a);return t[n]=r,t}),Object.create(null))},Be=Oe.OptIn,Ge=Oe.IabPlugin;Ue.getInstance=function(e,t){if(!e)throw new Error("Visitor requires Adobe Marketing Cloud Org ID.");e.indexOf("@")<0&&(e+="@AdobeOrg");var n=function(){var t=y.s_c_il;if(t)for(var n=0;n<t.length;n++){var a=t[n];if(a&&"Visitor"===a._c&&a.marketingCloudOrgID===e)return a}}();if(n)return n;var a=He(t)||{};!function(e){y.adobe.optIn=y.adobe.optIn||function(){var t=R.pluck(e,["doesOptInApply","previousPermissions","preOptInApprovals","isOptInStorageEnabled","optInStorageExpiry","isIabContext","sameSiteCookie","secureCookie"]),n=e.optInCookieDomain||e.cookieDomain;n=(n=n||q())===window.location.hostname?"":n,t.optInCookieDomain=n;var a=new Be(t,{cookies:G});if(t.isIabContext&&t.doesOptInApply){var r=new Ge;a.registerPlugin(r)}return a}()}(a||{});var r=e.split("").reverse().join(""),i=new Ue(e,null,r);a.cookieDomain&&(i.cookieDomain=a.cookieDomain),a.sameSiteCookie&&a.secureCookie&&(i.configs={sameSiteCookie:a.sameSiteCookie,secureCookie:a.secureCookie}),y.s_c_il.splice(--y.s_c_in,1);var o=R.getIeVersion();if("number"==typeof o&&o<10)return i._helpers.replaceMethodsWithFunction(i,(function(){}));var s=function(){try{return y.self!==y.parent}catch(e){return!0}}()&&(!function(e){return e.cookieWrite("TEST_AMCV_COOKIE","T",1),"T"===e.cookieRead("TEST_AMCV_COOKIE")&&(e.removeCookie("TEST_AMCV_COOKIE"),!0)}(i)||R.isFirefox()&&!function(t){var n="AMCV_"+e;return!!t.cookieRead(n)}(i)&&a.whitelistParentDomain)&&y.parent?new j(e,a,i,y.parent):new Ue(e,a,r);return i=null,s.init(),s},function(){function e(){Ue.windowLoaded=!0}y.addEventListener?y.addEventListener("load",e):y.attachEvent&&y.attachEvent("onload",e),Ue.codeLoadEnd=(new Date).getTime()}()}(),Visitor)}},"adobe-mcid/src/view/utils/timeUnits.js":{script:function(e){var t={Hours:3600,Days:86400,Weeks:604800,Months:2592e3,Years:31536e3};e.exports=t}}}},"adobe-analytics":{displayName:"Adobe Analytics",hostedLibFilesBaseUrl:"//ep00.epimg.net/js/gdt/0681c221600c/a81a11db86dc/63f8f5c6c881/hostedLibFiles/EPbf7b42aa08bc4f10879b1484195e80d1/",settings:{orgId:"2387401053DB208C0A490D4C@AdobeOrg",customSetup:{source:function(e){return e.articleDays=function(e){if(void 0===e||null==/^\d{4}\/(0?[1-9]|1[012])\/(0?[1-9]|[12][0-9]|3[01])$/gi.exec(e))return"";var t=e.split("/"),n=new Date(t[0],t[1]-1,t[2]),a=new Date,r=parseInt((a-n)/864e5);return r<0?"error":r.toString()},e.getValOnce=function(e,t,n,a){var r=e,i=t,o=n,s=a;if(arguments&&"-v"===arguments[0])return{plugin:"getValOnce",version:"3.0"};var c=function(){if(void 0!==window.s_c_il)for(var e,t=0;t<window.s_c_il.length;t++)if((e=window.s_c_il[t])._c&&"s_c"===e._c)return e}();return void 0!==c&&(c.contextData.getValOnce="3.0"),window.cookieWrite=window.cookieWrite||function(e,t,n){if("string"==typeof e){var a=window.location.hostname,r=window.location.hostname.split(".").length-1;if(a&&!/^[0-9.]+$/.test(a)){r=2<r?r:2;var i=a.lastIndexOf(".");if(0<=i){for(;0<=i&&1<r;)i=a.lastIndexOf(".",i-1),r--;i=0<i?a.substring(i):a}}if(g=i,t=void 0!==t?""+t:"",n||""===t)if(""===t&&(n=-60),"number"==typeof n){var o=new Date;o.setTime(o.getTime()+6e4*n)}else o=n;return!(!e||(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+"; path=/;"+(n?" expires="+o.toUTCString()+";":"")+(g?" domain="+g+";":""),"undefined"==typeof cookieRead))&&cookieRead(e)===t}},window.cookieRead=window.cookieRead||function(e){if("string"!=typeof e)return"";e=encodeURIComponent(e);var t=" "+document.cookie,n=t.indexOf(" "+e+"="),a=0>n?n:t.indexOf(";",n);return(e=0>n?"":decodeURIComponent(t.substring(n+2+e.length,0>a?t.length:a)))?e:""},r&&(i=i||"s_gvo",o=o||0,s="m"===s?6e4:864e5,r!==this.c_r(i))?((c=new Date).setTime(c.getTime()+o*s),cookieWrite(i,r,0===o?0:s),r):""},e.getTimeParting=function(e){var t=e;if("-v"===e)return{plugin:"getTimeParting",version:"6.3"};e:{if(void 0!==window.s_c_il)for(var n,a=0;a<window.s_c_il.length;a++)if((n=window.s_c_il[a])._c&&"s_c"===n._c){a=n;break e}a=void 0}return void 0!==a&&(a.contextData.getTimeParting="6.3"),t=document.documentMode?void 0:t||"Etc/GMT",a=(new Date).toLocaleDateString("en-US",{timeZone:t,minute:"numeric",hour:"numeric",weekday:"long",day:"numeric",year:"numeric",month:"long"}),"year="+(a=/([a-zA-Z]+).*?([a-zA-Z]+).*?([0-9]+).*?([0-9]+)(.*?)([0-9])(.*)/.exec(a))[4]+" | month="+a[2]+" | date="+a[3]+" | day="+a[1]+" | time="+(a[6]+a[7])},e.getVisitNum=function(e,t){function n(e){return!isNaN(e)&&(0|parseFloat(e))===parseFloat(e)}function a(e){var t=new Date,n=isNaN(e)?0:Math.floor(e);if(t.setHours(23),t.setMinutes(59),t.setSeconds(59),"w"===e&&(n=6-t.getDay()),"m"===e){n=t.getMonth()+1;var a=t.getFullYear();n=new Date(a||1970,n||1,0).getDate()-t.getDate()}return t.setDate(t.getDate()+n),"y"===e&&(t.setMonth(11),t.setDate(31)),t}var r=e,i=t;if("-v"===r)return{plugin:"getVisitNum",version:"4.2"};var o=function(){if(void 0!==window.s_c_il)for(var e,t=0;t<window.s_c_il.length;t++)if((e=window.s_c_il[t])._c&&"s_c"===e._c)return e}();void 0!==o&&(o.contextData.getVisitNum="4.2"),window.cookieWrite=window.cookieWrite||function(e,t,n){if("string"==typeof e){var a=window.location.hostname,r=window.location.hostname.split(".").length-1;if(a&&!/^[0-9.]+$/.test(a)){r=2<r?r:2;var i=a.lastIndexOf(".");if(0<=i){for(;0<=i&&1<r;)i=a.lastIndexOf(".",i-1),r--;i=0<i?a.substring(i):a}}if(g=i,t=void 0!==t?""+t:"",n||""===t)if(""===t&&(n=-60),"number"==typeof n){var o=new Date;o.setTime(o.getTime()+6e4*n)}else o=n;return!(!e||(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+"; path=/;"+(n?" expires="+o.toUTCString()+";":"")+(g?" domain="+g+";":""),void 0===window.cookieRead))&&window.cookieRead(e)===t}},window.cookieRead=window.cookieRead||function(e){if("string"!=typeof e)return"";e=encodeURIComponent(e);var t=" "+document.cookie,n=t.indexOf(" "+e+"="),a=0>n?n:t.indexOf(";",n);return(e=0>n?"":decodeURIComponent(t.substring(n+2+e.length,0>a?t.length:a)))?e:""},r=r||365,i=void 0!==i?!!i:!!n(r);var s=(new Date).getTime();if(o=a(r),window.cookieRead("s_vnc"+r))var c=window.cookieRead("s_vnc"+r).split("&vn="),l=c[1];return window.cookieRead("s_ivc")?l?(window.cookieWrite("s_ivc",!0,30),l):"unknown visit number":void 0!==l?(l++,c=i&&n(r)?s+864e5*r:c[0],o.setTime(c),window.cookieWrite("s_vnc"+r,c+"&vn="+l,o),window.cookieWrite("s_ivc",!0,30),l):(c=n(r)?s+864e5*r:a(r).getTime(),window.cookieWrite("s_vnc"+r,c+"&vn=1",o),window.cookieWrite("s_ivc",!0,30),"1")},e.getNewRepeat=function(e){var t=e;if("-v"===t)return{plugin:"getNewRepeat",version:"3.0"};void 0!==(e=function(){if(void 0!==window.s_c_il)for(var e,t=0;t<window.s_c_il.length;t++)if((e=window.s_c_il[t])._c&&"s_c"===e._c)return e}())&&(e.contextData.getNewRepeat="3.0"),window.cookieWrite=window.cookieWrite||function(e,t,n){if("string"==typeof e){var a=window.location.hostname,r=window.location.hostname.split(".").length-1;if(a&&!/^[0-9.]+$/.test(a)){r=2<r?r:2;var i=a.lastIndexOf(".");if(0<=i){for(;0<=i&&1<r;)i=a.lastIndexOf(".",i-1),r--;i=0<i?a.substring(i):a}}if(g=i,t=void 0!==t?""+t:"",n||""===t)if(""===t&&(n=-60),"number"==typeof n){var o=new Date;o.setTime(o.getTime()+6e4*n)}else o=n;return!(!e||(document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+"; path=/;"+(n?" expires="+o.toUTCString()+";":"")+(g?" domain="+g+";":""),"undefined"==typeof cookieRead))&&cookieRead(e)===t}},window.cookieRead=window.cookieRead||function(e){if("string"!=typeof e)return"";e=encodeURIComponent(e);var t=" "+document.cookie,n=t.indexOf(" "+e+"="),a=0>n?n:t.indexOf(";",n);return(e=0>n?"":decodeURIComponent(t.substring(n+2+e.length,0>a?t.length:a)))?e:""},e="s_nr"+(t=t||30);var n=new Date,a=cookieRead(e),r=a.split("-"),i=n.getTime();return n.setTime(i+864e5*t),""===a||18e5>i-r[0]&&"New"===r[1]?(cookieWrite(e,i+"-New",n),"New"):(cookieWrite(e,i+"-Repeat",n),"Repeat")},e.ActivityMap.regionIDAttribute="data-dtm-region",e.usePlugins=!0,e.doPlugins=function(e){void 0!==e.linkType&&("e"==e.linkType?DTM.trackEvent(DTM.events.EXITLINK,{externalLink:e.linkURL}):"d"==e.linkType&&DTM.trackEvent(DTM.events.DOWNLOADLINK,{downloadLink:e.linkURL}))},window.DTM.tools.omniture.loaded=!0,window.setTimeout((function(){void 0!==DTM.tools.omniture.consentsID&&void 0!==window.gdprAppliesGlobally?DTM.trackGDPRPV("omniture","lib + consents"):!1!==DTM.tools.omniture.trackPV()&&window.DTM.notify("PV tracked in tool <omniture> (lib)")}),700),!1}},libraryCode:{type:"managed",accounts:{staging:["prisacomprensapreprod"],production:["prisacomglobal"],development:["prisacomprensapreprod"]},useActivityMap:!0,scopeTrackerGlobally:!0},trackerProperties:{charSet:"UTF-8",currencyCode:"EUR",trackingServer:"metrics.elpais.com",trackInlineStats:!1,visitorNamespace:"prisacom",trackDownloadLinks:!0,trackExternalLinks:!0,writeSecureCookies:!0,linkExternalFilters:[],linkInternalFilters:["elpais.com","javascript:"],linkLeaveQueryString:!0,trackingServerSecure:"smetrics.elpais.com",linkDownloadFileTypes:["avi","css","csv","doc","docx","eps","exe","jpg","js","m4v","mov","mp3","pdf","png","ppt","pptx","rar","svg","tab","txt","vsd","vxd","wav","wma","wmv","xls","xlsx","xml","zip"]}},modules:{"adobe-analytics/src/lib/sharedModules/getTracker.js":{script:function(e,t,n,a){"use strict";var r,i=n("@adobe/reactor-cookie"),o=n("@adobe/reactor-promise"),s=n("@adobe/reactor-window"),c=n("../helpers/settingsHelper"),l=n("../helpers/augmenters"),u=n("../helpers/applyTrackerVariables"),d=n("../helpers/loadLibrary"),p=n("../helpers/generateVersion")(a.buildInfo.turbineBuildDate),f="beforeSettings",m=a.getSharedModule("adobe-mcid","mcid-instance"),g=function(e){return!e||"true"===i.get(e)},h=function(e){return o.all(l.map((function(t){var n;try{n=t(e)}catch(e){setTimeout((function(){throw e}))}return o.resolve(n)}))).then((function(){return e}))},b=function(e){return m&&(a.logger.info("Setting MCID instance on the tracker."),e.visitor=m),e},y=function(e){return a.logger.info('Setting version on tracker: "'+p+'".'),void 0!==e.tagContainerMarker?e.tagContainerMarker=p:"string"==typeof e.version&&e.version.substring(e.version.length-5)!=="-"+p&&(e.version+="-"+p),e},v=function(e,t,n){return t.loadPhase===f&&t.source&&(a.logger.info("Calling custom script before settings."),t.source.call(s,n)),u(n,e||{}),t.loadPhase!==f&&t.source&&(a.logger.info("Calling custom script after settings."),t.source.call(s,n)),n},E=function(e,t){return c.isAudienceManagementEnabled(e)&&(t.loadModule("AudienceManagement"),a.logger.info("Initializing AudienceManagement module"),t.AudienceManagement.setup(e.moduleProperties.audienceManager.config)),t},P=(r=a.getExtensionSettings(),g(r.trackingCookieName)?d(r).then(h).then(b).then(y).then(v.bind(null,r.trackerProperties,r.customSetup||{})).then(E.bind(null,r)):o.reject("EU compliance was not acknowledged by the user."));e.exports=function(){return P}},name:"get-tracker",shared:!0},"adobe-analytics/src/lib/sharedModules/augmentTracker.js":{name:"augment-tracker",shared:!0,script:function(e,t,n){"use strict";var a=n("../helpers/augmenters");e.exports=function(e){a.push(e)}}},"adobe-analytics/src/lib/helpers/settingsHelper.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-window"),i={LIB_TYPES:{MANAGED:"managed",PREINSTALLED:"preinstalled",REMOTE:"remote",CUSTOM:"custom"},MANAGED_LIB_PATHS:{APP_MEASUREMENT:"AppMeasurement.js",ACTIVITY_MAP:"AppMeasurement_Module_ActivityMap.js",AUDIENCE_MANAGEMENT:"AppMeasurement_Module_AudienceManagement.js"},getReportSuites:function(e){var t=e.production;return e[a.environment.stage]&&(t=e[a.environment.stage]),t.join(",")},isActivityMapEnabled:function(e){return!(e.libraryCode&&!e.libraryCode.useActivityMap&&!1===e.libraryCode.useActivityMap)},isAudienceManagementEnabled:function(e){var t=!1;return e&&e.moduleProperties&&e.moduleProperties.audienceManager&&e.moduleProperties.audienceManager.config&&r&&r._satellite&&r._satellite.company&&r._satellite.company.orgId&&(t=!0),t}};e.exports=i}},"adobe-analytics/src/lib/helpers/augmenters.js":{script:function(e){"use strict";e.exports=[]}},"adobe-analytics/src/lib/helpers/applyTrackerVariables.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-query-string"),i=n("@adobe/reactor-window"),o=/eVar([0-9]+)/,s=/prop([0-9]+)/,c=new RegExp("^(eVar[0-9]+)|(prop[0-9]+)|(hier[0-9]+)|campaign|purchaseID|channel|server|state|zip|pageType$"),l=function(e,t,n){return n.indexOf(e)===t},u=function(e,t,n){var a=Object.keys(t).filter(c.test.bind(c));return n&&a.push("events"),(a=a.concat((e.linkTrackVars||"").split(","))).filter((function(e,t){return"None"!==e&&e&&l(e,t,a)})).join(",")},d=function(e,t){var n=t.map((function(e){return e.name}));return(n=n.concat((e.linkTrackEvents||"").split(","))).filter((function(e,t){return"None"!==e&&l(e,t,n)})).join(",")},p=function(e,t,n){e[t]=n[t].join(",")},f=function(e,t,n){var a=n.dynamicVariablePrefix||"D=";n[t].forEach((function(t){var n;if("value"===t.type)n=t.value;else{var r=o.exec(t.value);if(r)n=a+"v"+r[1];else{var i=s.exec(t.value);i&&(n=a+"c"+i[1])}}e[t.name]=n}))},m={linkDownloadFileTypes:p,linkExternalFilters:p,linkInternalFilters:p,hierarchies:function(e,t,n){n[t].forEach((function(t){e[t.name]=t.sections.join(t.delimiter)}))},props:f,eVars:f,campaign:function(e,t,n){if("queryParam"===n[t].type){var a=r.parse(i.location.search);e[t]=a[n[t].value]}else e[t]=n[t].value},events:function(e,t,n){var a=n[t].map((function(e){var t=e.name;return e.id&&(t=[t,e.id].join(":")),e.value&&(t=[t,e.value].join("=")),t}));e[t]=a.join(",")}};e.exports=function(e,t){var n={};t=t||{},Object.keys(t).forEach((function(e){var a=m[e],r=t[e];a?a(n,e,t):n[e]=r})),n.events&&e.events&&e.events.length>0&&(n.events=e.events+","+n.events);var r=t&&t.events&&t.events.length>0,i=u(e,n,r);i&&(n.linkTrackVars=i);var o=d(e,t.events||[]);o&&(n.linkTrackEvents=o),a.logger.info('Applying the following properties on tracker: "'+JSON.stringify(n)+'".'),Object.keys(n).forEach((function(t){e[t]=n[t]}))}}},"adobe-analytics/src/lib/helpers/loadLibrary.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-load-script"),i=n("@adobe/reactor-window"),o=n("@adobe/reactor-promise"),s=n("./settingsHelper"),c=n("./pollHelper"),l=function(e,t){if(!i.s_gi)throw new Error("Unable to create AppMeasurement tracker, `s_gi` function not found."+i.AppMeasurement);a.logger.info('Creating AppMeasurement tracker with these report suites: "'+t+'"');var n=i.s_gi(t);return e.libraryCode.scopeTrackerGlobally&&(a.logger.info("Setting the tracker as window.s"),i.s=n),n},u=function(e){var t=[];switch(e.libraryCode.type){case s.LIB_TYPES.MANAGED:t.push(a.getHostedLibFileUrl(s.MANAGED_LIB_PATHS.APP_MEASUREMENT)),s.isActivityMapEnabled(e)&&t.push(a.getHostedLibFileUrl(s.MANAGED_LIB_PATHS.ACTIVITY_MAP));break;case s.LIB_TYPES.CUSTOM:t.push(e.libraryCode.source);break;case s.LIB_TYPES.REMOTE:t.push("https:"===i.location.protocol?e.libraryCode.httpsUrl:e.libraryCode.httpUrl)}if(s.isAudienceManagementEnabled(e)){var n={namespace:i._satellite.company.orgId};e.moduleProperties.audienceManager.config.visitorService=n,t.push(a.getHostedLibFileUrl(s.MANAGED_LIB_PATHS.AUDIENCE_MANAGEMENT))}return t},d=function(e){return o.all(u(e).map((function(e){return a.logger.info("Loading script: "+e),r(e)})))},p=function(e,t){if(e.libraryCode.accounts)if(t.sa){var n=s.getReportSuites(e.libraryCode.accounts);a.logger.info('Setting the following report suites on the tracker: "'+n+'"'),t.sa(n)}else a.logger.warn("Cannot set report suites on tracker. `sa` method not available.");return t},f=function(e){if(i[e])return a.logger.info('Found tracker located at: "'+e+'".'),i[e];throw new Error('Cannot find the global variable name: "'+e+'".')};e.exports=function(e){var t=d(e);switch(e.libraryCode.type){case s.LIB_TYPES.MANAGED:var n=s.getReportSuites(e.libraryCode.accounts);return t.then(l.bind(null,e,n));case s.LIB_TYPES.PREINSTALLED:return t.then(c.poll.bind(null,i,e.libraryCode.trackerVariableName)).then(p.bind(null,e));case s.LIB_TYPES.CUSTOM:case s.LIB_TYPES.REMOTE:return t.then(f.bind(null,e.libraryCode.trackerVariableName)).then(p.bind(null,e));default:throw new Error("Cannot load library. Type not supported.")}}}},"adobe-analytics/src/lib/helpers/generateVersion.js":{script:function(e){"use strict";var t=8,n=function(e){return e.getUTCDate().toString(36)},a=function(e){return e.substr(e.length-1)},r=function(e){return Math.floor(e.getUTCHours()/t)},i=function(e){var t=(e.getUTCMonth()+1+12*r(e)).toString(36);return a(t)},o=function(e){return(e.getUTCFullYear()-2010).toString(36)};e.exports=function(e){var t=new Date(e);if(isNaN(t))throw new Error("Invalid date provided");return("L"+o(t)+i(t)+n(t)).toUpperCase()}}},"adobe-analytics/src/lib/helpers/pollHelper.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-promise"),i=40,o=250,s=function(e,t,n){a.logger.info('Found property located at: "'+t+'"].'),e(n)},c=function(e,t){return new r((function(n,a){if(e[t])return s(n,t,e[t]);var r=1,c=setInterval((function(){e[t]&&(s(n,t,e[t]),clearInterval(c)),r>=i&&(clearInterval(c),a(new Error('Bailing out. Cannot find the variable name: "'+t+'"].'))),r++}),o)}))};e.exports={poll:function(e,t){return a.logger.info('Waiting for the property to become accessible at: "'+t+'"].'),c(e,t)}}}}}},core:{displayName:"Core",hostedLibFilesBaseUrl:"//ep00.epimg.net/js/gdt/0681c221600c/a81a11db86dc/63f8f5c6c881/hostedLibFiles/EPd22815afd48447aa955be6a3a012e3b5/",modules:{"core/src/lib/dataElements/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e){"use strict";e.exports=function(e,t){return e.source(t)}}},"core/src/lib/dataElements/javascriptVariable.js":{name:"javascript-variable",displayName:"JavaScript Variable",script:function(e,t,n){"use strict";var a=n("../helpers/getObjectProperty.js");e.exports=function(e){return a(window,e.path)}}},"core/src/lib/dataElements/queryStringParameter.js":{name:"query-string-parameter",displayName:"Query String Parameter",script:function(e,t,n){"use strict";var a=n("@adobe/reactor-window"),r=n("@adobe/reactor-query-string");e.exports=function(e){var t=r.parse(a.location.search);if(!e.caseInsensitive)return t[e.name];for(var n=e.name.toLowerCase(),i=Object.keys(t),o=0;o<i.length;o++){var s=i[o];if(s.toLowerCase()===n)return t[s]}}}},"core/src/lib/dataElements/cookie.js":{name:"cookie",displayName:"Cookie",script:function(e,t,n){"use strict";var a=n("@adobe/reactor-cookie");e.exports=function(e){return a.get(e.name)}}},"core/src/lib/events/libraryLoaded.js":{name:"library-loaded",displayName:"Library Loaded (Page Top)",script:function(e,t,n){"use strict";var a=n("./helpers/pageLifecycleEvents");e.exports=function(e,t){a.registerLibraryLoadedTrigger(t)}}},"core/src/lib/conditions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e){"use strict";e.exports=function(e,t){return e.source.call(t.element,t,t.target)}}},"core/src/lib/actions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e,t,n,a){"use strict";var r,i,o,s,c=n("@adobe/reactor-document"),l=n("@adobe/reactor-promise"),u=n("./helpers/decorateCode"),d=n("./helpers/loadCodeSequentially"),p=n("../../../node_modules/postscribe/dist/postscribe"),f=n("./helpers/unescapeHtmlCode"),m=n("../helpers/findPageScript").getTurbine,g=(i=function(e){p(c.body,e,{beforeWriteToken:function(e){var t=e.tagName&&e.tagName.toLowerCase();return r&&"script"===t&&(e.attrs.nonce=r),"script"!==t&&"style"!==t||(Object.keys(e.attrs||{}).forEach((function(t){e.attrs[t]=f(e.attrs[t])})),e.src&&(e.src=f(e.src))),e},error:function(e){a.logger.error(e.msg)}})},o=[],s=function(){if(c.body)for(;o.length;)i(o.shift());else setTimeout(s,20)},function(e){o.push(e),s()}),h=function(){if(c.currentScript)return c.currentScript.async;var e=m();return!e||e.async}();e.exports=function(e,t){var n;r=a.getExtensionSettings().cspNonce;var i={settings:e,event:t},o=i.settings.source;if(o)return i.settings.isExternal?d(o).then((function(e){return e?(n=u(i,e),g(n.code),n.promise):l.resolve()})):(n=u(i,o),h||"loading"!==c.readyState?g(n.code):c.write&&!1===a.propertySettings.ruleComponentSequencingEnabled?c.write(n.code):g(n.code),n.promise)}}},"core/src/lib/helpers/getObjectProperty.js":{script:function(e){"use strict";e.exports=function(e,t){for(var n=t.split("."),a=e,r=0,i=n.length;r<i;r++){if(null==a)return;a=a[n[r]]}return a}}},"core/src/lib/events/helpers/pageLifecycleEvents.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-window"),r=n("@adobe/reactor-document"),i=-1!==a.navigator.appVersion.indexOf("MSIE 10"),o="WINDOW_LOADED",s="DOM_READY",c="PAGE_BOTTOM",l=[c,s,o],u=function(e,t){return{element:e,target:e,nativeEvent:t}},d={};l.forEach((function(e){d[e]=[]}));var p=function(e,t){l.slice(0,m(e)+1).forEach((function(e){g(t,e)}))},f=function(){return"complete"===r.readyState?o:"interactive"===r.readyState?i?null:s:void 0},m=function(e){return l.indexOf(e)},g=function(e,t){d[t].forEach((function(t){h(e,t)})),d[t]=[]},h=function(e,t){var n=t.trigger,a=t.syntheticEventFn;n(a?a(e):null)};a._satellite=a._satellite||{},a._satellite.pageBottom=p.bind(null,c),r.addEventListener("DOMContentLoaded",p.bind(null,s),!0),a.addEventListener("load",p.bind(null,o),!0),a.setTimeout((function(){var e=f();e&&p(e)}),0),e.exports={registerLibraryLoadedTrigger:function(e){e()},registerPageBottomTrigger:function(e){d[c].push({trigger:e})},registerDomReadyTrigger:function(e){d[s].push({trigger:e,syntheticEventFn:u.bind(null,r)})},registerWindowLoadedTrigger:function(e){d[o].push({trigger:e,syntheticEventFn:u.bind(null,a)})}}}},"core/src/lib/actions/helpers/decorateCode.js":{script:function(e,t,n){"use strict";var a=n("./decorators/decorateGlobalJavaScriptCode"),r=n("./decorators/decorateNonGlobalJavaScriptCode"),i={javascript:function(e,t){return e.settings.global?a(e,t):r(e,t)},html:n("./decorators/decorateHtmlCode")};e.exports=function(e,t){return i[e.settings.language](e,t)}}},"core/src/lib/actions/helpers/loadCodeSequentially.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-promise"),r=n("./getSourceByUrl"),i=a.resolve();e.exports=function(e){var t=new a((function(t){var n=r(e);a.all([n,i]).then((function(e){var n=e[0];t(n)}))}));return i=t,t}}},"core/node_modules/postscribe/dist/postscribe.js":{script:function(e,t){var n,a;n=this,a=function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=a(n(1));e.exports=r.default},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function i(){}function o(){var e=m.shift();if(e){var t=d.last(e);t.afterDequeue(),e.stream=s.apply(void 0,e),t.afterStreamStart()}}function s(e,t,n){function a(e){e=n.beforeWrite(e),g.write(e),n.afterWrite(e)}(g=new u.default(e,n)).id=f++,g.name=n.name||g.id,c.streams[g.name]=g;var r=e.ownerDocument,s={close:r.close,open:r.open,write:r.write,writeln:r.writeln};l(r,{close:i,open:i,write:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return a(t.join(""))},writeln:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return a(t.join("")+"\n")}});var d=g.win.onerror||i;return g.win.onerror=function(e,t,a){n.error({msg:e+" - "+t+": "+a}),d.apply(g.win,[e,t,a])},g.write(t,(function(){l(r,s),g.win.onerror=d,n.done(),g=null,o()})),g}function c(e,t,n){if(d.isFunction(n))n={done:n};else if("clear"===n)return m=[],g=null,void(f=0);n=d.defaults(n,p);var a=[e=/^#/.test(e)?window.document.getElementById(e.substr(1)):e.jquery?e[0]:e,t,n];return e.postscribe={cancel:function(){a.stream?a.stream.abort():a[1]=i}},n.beforeEnqueue(a),m.push(a),g||o(),e.postscribe}t.__esModule=!0;var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=c;var u=r(n(2)),d=a(n(4)),p={afterAsync:i,afterDequeue:i,afterStreamStart:i,afterWrite:i,autoFix:!0,beforeEnqueue:i,beforeWriteToken:function(e){return e},beforeWrite:function(e){return e},done:i,error:function(e){throw new Error(e.msg)},releaseAsync:!1},f=0,m=[],g=null;l(c,{streams:{},queue:m,WriteStream:u.default})},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=p+t,a=e.getAttribute(n);return u.existy(a)?String(a):a}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=p+t;u.existy(n)&&""!==n?e.setAttribute(a,n):e.removeAttribute(a)}t.__esModule=!0;var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l=r(n(3)),u=a(n(4)),d=!1,p="data-ps-",f="ps-style",m="ps-script",g=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.root=t,this.options=n,this.doc=t.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new l.default("",{autoFix:n.autoFix}),this.actuals=[t],this.proxyHistory="",this.proxyRoot=this.doc.createElement(t.nodeName),this.scriptStack=[],this.writeQueue=[],s(this.proxyRoot,"proxyof",0)}return e.prototype.write=function(){var e;for((e=this.writeQueue).push.apply(e,arguments);!this.deferredRemote&&this.writeQueue.length;){var t=this.writeQueue.shift();u.isFunction(t)?this._callFunction(t):this._writeImpl(t)}},e.prototype._callFunction=function(e){var t={type:"function",value:e.name||e.toString()};this._onScriptStart(t),e.call(this.win,this.doc),this._onScriptDone(t)},e.prototype._writeImpl=function(e){this.parser.append(e);for(var t=void 0,n=void 0,a=void 0,r=[];(t=this.parser.readToken())&&!(n=u.isScript(t))&&!(a=u.isStyle(t));)(t=this.options.beforeWriteToken(t))&&r.push(t);r.length>0&&this._writeStaticTokens(r),n&&this._handleScriptToken(t),a&&this._handleStyleToken(t)},e.prototype._writeStaticTokens=function(e){var t=this._buildChunk(e);return t.actual?(t.html=this.proxyHistory+t.actual,this.proxyHistory+=t.proxy,this.proxyRoot.innerHTML=t.html,d&&(t.proxyInnerHTML=this.proxyRoot.innerHTML),this._walkChunk(),d&&(t.actualInnerHTML=this.root.innerHTML),t):null},e.prototype._buildChunk=function(e){for(var t=this.actuals.length,n=[],a=[],r=[],i=e.length,o=0;o<i;o++){var s=e[o],c=s.toString();if(n.push(c),s.attrs){if(!/^noscript$/i.test(s.tagName)){var l=t++;a.push(c.replace(/(\/?>)/," "+p+"id="+l+" $1")),s.attrs.id!==m&&s.attrs.id!==f&&r.push("atomicTag"===s.type?"":"<"+s.tagName+" "+p+"proxyof="+l+(s.unary?" />":">"))}}else a.push(c),r.push("endTag"===s.type?c:"")}return{tokens:e,raw:n.join(""),actual:a.join(""),proxy:r.join("")}},e.prototype._walkChunk=function(){for(var e=void 0,t=[this.proxyRoot];u.existy(e=t.shift());){var n=1===e.nodeType;if(!n||!o(e,"proxyof")){n&&(this.actuals[o(e,"id")]=e,s(e,"id"));var a=e.parentNode&&o(e.parentNode,"proxyof");a&&this.actuals[a].appendChild(e)}t.unshift.apply(t,u.toArray(e.childNodes))}},e.prototype._handleScriptToken=function(e){var t=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),e.src=e.attrs.src||e.attrs.SRC,(e=this.options.beforeWriteToken(e))&&(e.src&&this.scriptStack.length?this.deferredRemote=e:this._onScriptStart(e),this._writeScriptToken(e,(function(){t._onScriptDone(e)})))},e.prototype._handleStyleToken=function(e){var t=this.parser.clear();t&&this.writeQueue.unshift(t),e.type=e.attrs.type||e.attrs.TYPE||"text/css",(e=this.options.beforeWriteToken(e))&&this._writeStyleToken(e),t&&this.write()},e.prototype._writeStyleToken=function(e){var t=this._buildStyle(e);this._insertCursor(t,f),e.content&&(t.styleSheet&&!t.sheet?t.styleSheet.cssText=e.content:t.appendChild(this.doc.createTextNode(e.content)))},e.prototype._buildStyle=function(e){var t=this.doc.createElement(e.tagName);return t.setAttribute("type",e.type),u.eachKey(e.attrs,(function(e,n){t.setAttribute(e,n)})),t},e.prototype._insertCursor=function(e,t){this._writeImpl('<span id="'+t+'"/>');var n=this.doc.getElementById(t);n&&n.parentNode.replaceChild(e,n)},e.prototype._onScriptStart=function(e){e.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(e)},e.prototype._onScriptDone=function(e){e===this.scriptStack[0]?(this.scriptStack.shift(),this.write.apply(this,e.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)):this.options.error({msg:"Bad script nesting or script finished twice"})},e.prototype._writeScriptToken=function(e,t){var n=this._buildScript(e),a=this._shouldRelease(n),r=this.options.afterAsync;e.src&&(n.src=e.src,this._scriptLoadHandler(n,a?r:function(){t(),r()}));try{this._insertCursor(n,m),n.src&&!a||t()}catch(e){this.options.error(e),t()}},e.prototype._buildScript=function(e){var t=this.doc.createElement(e.tagName);return u.eachKey(e.attrs,(function(e,n){t.setAttribute(e,n)})),e.content&&(t.text=e.content),t},e.prototype._scriptLoadHandler=function(e,t){function n(){e=e.onload=e.onreadystatechange=e.onerror=null}function a(){n(),null!=t&&t(),t=null}function r(e){n(),o(e),null!=t&&t(),t=null}function i(e,t){var n=e["on"+t];null!=n&&(e["_on"+t]=n)}var o=this.options.error;i(e,"load"),i(e,"error"),c(e,{onload:function(){if(e._onload)try{e._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(t){r({msg:"onload handler failed "+t+" @ "+e.src})}a()},
onerror:function(){if(e._onerror)try{e._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(t){return void r({msg:"onerror handler failed "+t+" @ "+e.src})}r({msg:"remote script failed "+e.src})},onreadystatechange:function(){/^(loaded|complete)$/.test(e.readyState)&&a()}})},e.prototype._shouldRelease=function(e){return!/^script$/i.test(e.nodeName)||!!(this.options.releaseAsync&&e.src&&e.hasAttribute("async"))},e}();t.default=g},function(e){var t;t=function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=a(n(1));e.exports=r.default},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=r(n(2)),s=r(n(3)),c=a(n(6)),l=n(5),u={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},d=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.stream=n;var r=!1,s={};for(var l in o)o.hasOwnProperty(l)&&(a.autoFix&&(s[l+"Fix"]=!0),r=r||s[l+"Fix"]);r?(this._readToken=(0,c.default)(this,s,(function(){return t._readTokenImpl()})),this._peekToken=(0,c.default)(this,s,(function(){return t._peekTokenImpl()}))):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return e.prototype.append=function(e){this.stream+=e},e.prototype.prepend=function(e){this.stream=e+this.stream},e.prototype._readTokenImpl=function(){var e=this._peekTokenImpl();if(e)return this.stream=this.stream.slice(e.length),e},e.prototype._peekTokenImpl=function(){for(var e in u)if(u.hasOwnProperty(e)&&u[e].test(this.stream)){var t=s[e](this.stream);if(t)return"startTag"===t.type&&/script|style/i.test(t.tagName)?null:(t.text=this.stream.substr(0,t.length),t)}},e.prototype.peekToken=function(){return this._peekToken()},e.prototype.readToken=function(){return this._readToken()},e.prototype.readTokens=function(e){for(var t=void 0;t=this.readToken();)if(e[t.type]&&!1===e[t.type](t))return},e.prototype.clear=function(){var e=this.stream;return this.stream="",e},e.prototype.rest=function(){return this.stream},e}();for(var p in t.default=d,d.tokenToString=function(e){return e.toString()},d.escapeAttributes=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=(0,l.escapeQuotes)(e[n],null));return t},d.supports=o,o)o.hasOwnProperty(p)&&(d.browserHasFlaw=d.browserHasFlaw||!o[p]&&p)},function(e,t){"use strict";t.__esModule=!0;var n=!1,a=!1,r=window.document.createElement("div");try{var i="<P><I></P></I>";r.innerHTML=i,t.tagSoup=n=r.innerHTML!==i}catch(e){t.tagSoup=n=!1}try{r.innerHTML="<P><i><P></P></i></P>",t.selfClose=a=2===r.childNodes.length}catch(e){t.selfClose=a=!1}r=null,t.tagSoup=n,t.selfClose=a},function(e,t,n){"use strict";function a(e){var t=e.indexOf("-->");if(t>=0)return new l.CommentToken(e.substr(4,t-1),t+3)}function r(e){var t=e.indexOf("<");return new l.CharsToken(t>=0?t:e.length)}function i(e){var t,n,a;if(-1!==e.indexOf(">")){var r=e.match(u.startTag);if(r){var i=(t={},n={},a=r[2],r[2].replace(u.attr,(function(e,r){arguments[2]||arguments[3]||arguments[4]||arguments[5]?arguments[5]?(t[arguments[5]]="",n[arguments[5]]=!0):t[r]=arguments[2]||arguments[3]||arguments[4]||u.fillAttr.test(r)&&r||"":t[r]="",a=a.replace(e,"")})),{v:new l.StartTagToken(r[1],r[0].length,t,n,!!r[3],a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))});if("object"===(void 0===i?"undefined":c(i)))return i.v}}}function o(e){var t=i(e);if(t){var n=e.slice(t.length);if(n.match(new RegExp("</\\s*"+t.tagName+"\\s*>","i"))){var a=n.match(new RegExp("([\\s\\S]*?)</\\s*"+t.tagName+"\\s*>","i"));if(a)return new l.AtomicTagToken(t.tagName,a[0].length+t.length,t.attrs,t.booleanAttrs,a[1])}}}function s(e){var t=e.match(u.endTag);if(t)return new l.EndTagToken(t[1],t[0].length)}t.__esModule=!0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.comment=a,t.chars=r,t.startTag=i,t.atomicTag=o,t.endTag=s;var l=n(4),u={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0,t.EndTagToken=t.AtomicTagToken=t.StartTagToken=t.TagToken=t.CharsToken=t.CommentToken=t.Token=void 0;var r=n(5),i=(t.Token=function e(t,n){a(this,e),this.type=t,this.length=n,this.text=""},t.CommentToken=function(){function e(t,n){a(this,e),this.type="comment",this.length=n||(t?t.length:0),this.text="",this.content=t}return e.prototype.toString=function(){return"<!--"+this.content},e}(),t.CharsToken=function(){function e(t){a(this,e),this.type="chars",this.length=t,this.text=""}return e.prototype.toString=function(){return this.text},e}(),t.TagToken=function(){function e(t,n,r,i,o){a(this,e),this.type=t,this.length=r,this.text="",this.tagName=n,this.attrs=i,this.booleanAttrs=o,this.unary=!1,this.html5Unary=!1}return e.formatTag=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="<"+e.tagName;for(var a in e.attrs)if(e.attrs.hasOwnProperty(a)){n+=" "+a;var i=e.attrs[a];void 0!==e.booleanAttrs&&void 0!==e.booleanAttrs[a]||(n+='="'+(0,r.escapeQuotes)(i)+'"')}return e.rest&&(n+=" "+e.rest),e.unary&&!e.html5Unary?n+="/>":n+=">",null!=t&&(n+=t+"</"+e.tagName+">"),n},e}());t.StartTagToken=function(){function e(t,n,r,i,o,s){a(this,e),this.type="startTag",this.length=n,this.text="",this.tagName=t,this.attrs=r,this.booleanAttrs=i,this.html5Unary=!1,this.unary=o,this.rest=s}return e.prototype.toString=function(){return i.formatTag(this)},e}(),t.AtomicTagToken=function(){function e(t,n,r,i,o){a(this,e),this.type="atomicTag",this.length=n,this.text="",this.tagName=t,this.attrs=r,this.booleanAttrs=i,this.unary=!1,this.html5Unary=!1,this.content=o}return e.prototype.toString=function(){return i.formatTag(this,this.content)},e}(),t.EndTagToken=function(){function e(t,n){a(this,e),this.type="endTag",this.length=n,this.text="",this.tagName=t}return e.prototype.toString=function(){return"</"+this.tagName+">"},e}()},function(e,t){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e?e.replace(/([^"]*)"/g,(function(e,t){return/\\/.test(t)?t+'"':t+'\\"'})):t}t.__esModule=!0,t.escapeQuotes=n},function(e,t){"use strict";function n(e){return e&&"startTag"===e.type&&(e.unary=s.test(e.tagName)||e.unary,e.html5Unary=!/\/>$/.test(e.text)),e}function a(e,t){var a=e.stream,r=n(t());return e.stream=a,r}function r(e,t){var n=t.pop();e.prepend("</"+n.tagName+">")}function i(){var e=[];return e.last=function(){return this[this.length-1]},e.lastTagNameEq=function(e){var t=this.last();return t&&t.tagName&&t.tagName.toUpperCase()===e.toUpperCase()},e.containsTagName=function(e){for(var t,n=0;t=this[n];n++)if(t.tagName===e)return!0;return!1},e}function o(e,t,o){function s(){var t=a(e,o);t&&u[t.type]&&u[t.type](t)}var l=i(),u={startTag:function(n){var a=n.tagName;"TR"===a.toUpperCase()&&l.lastTagNameEq("TABLE")?(e.prepend("<TBODY>"),s()):t.selfCloseFix&&c.test(a)&&l.containsTagName(a)?l.lastTagNameEq(a)?r(e,l):(e.prepend("</"+n.tagName+">"),s()):n.unary||l.push(n)},endTag:function(n){l.last()?t.tagSoupFix&&!l.lastTagNameEq(n.tagName)?r(e,l):l.pop():t.tagSoupFix&&(o(),s())}};return function(){return s(),n(o())}}t.__esModule=!0,t.default=o;var s=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,c=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])},e.exports=t()},function(e,t){"use strict";function n(e){return null!=e}function a(e){return"function"==typeof e}function r(e,t,n){var a=void 0,r=e&&e.length||0;for(a=0;a<r;a++)t.call(n,e[a],a)}function i(e,t,n){for(var a in e)e.hasOwnProperty(a)&&t.call(n,a,e[a])}function o(e,t){return e=e||{},i(t,(function(t,a){n(e[t])||(e[t]=a)})),e}function s(e){try{return Array.prototype.slice.call(e)}catch(a){var t=(n=[],r(e,(function(e){n.push(e)})),{v:n});if("object"===(void 0===t?"undefined":p(t)))return t.v}var n}function c(e){return e[e.length-1]}function l(e,t){return!(!e||"startTag"!==e.type&&"atomicTag"!==e.type||!("tagName"in e)||!~e.tagName.toLowerCase().indexOf(t))}function u(e){return l(e,"script")}function d(e){return l(e,"style")}t.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.existy=n,t.isFunction=a,t.each=r,t.eachKey=i,t.defaults=o,t.toArray=s,t.last=c,t.isTag=l,t.isScript=u,t.isStyle=d}])},"object"==typeof t&&"object"==typeof e?e.exports=a():"function"==typeof define&&define.amd?define([],a):"object"==typeof t?t.postscribe=a():n.postscribe=a()}},"core/src/lib/actions/helpers/unescapeHtmlCode.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document").createElement("div");e.exports=function(e){return a.innerHTML=e,a.textContent||a.innerText||e}}},"core/src/lib/helpers/findPageScript.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document"),r=function(e){for(var t=a.querySelectorAll("script"),n=0;n<t.length;n++){var r=t[n];if(e.test(r.src))return r}},i=function(){return r(new RegExp(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/))};e.exports={getTurbine:i,byRegexPattern:r}}},"core/src/lib/actions/helpers/decorators/decorateGlobalJavaScriptCode.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-promise");e.exports=function(e,t){return{code:"<script>\n"+t+"\n</script>",promise:a.resolve()}}}},"core/src/lib/actions/helpers/decorators/decorateNonGlobalJavaScriptCode.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-promise"),r=0;e.exports=function(e,t){var n="_runScript"+ ++r,i=new a((function(t,r){_satellite[n]=function(i){delete _satellite[n],new a((function(t){t(i.call(e.event.element,e.event,e.event.target,a))})).then(t,r)}}));return{code:'<script>_satellite["'+n+'"](function(event, target, Promise) {\n'+t+"\n});</script>",promise:i}}}},"core/src/lib/actions/helpers/decorators/decorateHtmlCode.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-promise"),i=0,o={};window._satellite=window._satellite||{},window._satellite._onCustomCodeSuccess=function(e){var t=o[e];t&&(delete o[e],t.resolve())},window._satellite._onCustomCodeFailure=function(e){var t=o[e];t&&(delete o[e],t.reject())};var s=function(e){return-1!==e.indexOf("${reactorCallbackId}")},c=function(e,t){return e.replace(/\${reactorCallbackId}/g,t)},l=function(e){return e.settings.isExternal};e.exports=function(e,t){var n;return l(e)&&(t=a.replaceTokens(t,e.event)),s(t)?(n=new r((function(e,t){o[String(i)]={resolve:e,reject:t}})),t=c(t,i),i+=1):n=r.resolve(),{code:t,promise:n}}}},"core/src/lib/actions/helpers/getSourceByUrl.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-load-script"),r=n("@adobe/reactor-promise"),i=n("../../helpers/findPageScript").byRegexPattern,o={},s={},c=function(e){return s[e]||(s[e]=a(e)),s[e]};_satellite.__registerScript=function(e,t){var n;if(document.currentScript)n=document.currentScript.getAttribute("src");else{var a=new RegExp(".*"+e+".*");n=i(a).getAttribute("src")}o[n]=t},e.exports=function(e){return o[e]?r.resolve(o[e]):new r((function(t){c(e).then((function(){t(o[e])}),(function(){t()}))}))}}}}},"adobe-contexthub":{displayName:"Adobe ContextHub",hostedLibFilesBaseUrl:"//ep00.epimg.net/js/gdt/0681c221600c/a81a11db86dc/63f8f5c6c881/hostedLibFiles/EP76cc9a1cb360441db5c7bfb163c22e2b/",settings:{root:"digitalData",dataSchema:{type:"object",$schema:"http://json-schema.org/draft-04/schema#",properties:{page:{type:"object",properties:{category:{type:"object",properties:{pageType:{type:"string"},subCategory1:{type:"string"},subCategory2:{type:"string"},primaryCategory:{type:"string"},secondaryCategories:{type:"string"}}},pageInfo:{type:"object",properties:{cms:{type:"string"},org:{type:"string"},ssl:{type:"string"},date:{type:"object",properties:{day:{type:"string"},gmt:{type:"string"},year:{type:"string"},hours:{type:"string"},month:{type:"string"},dstEnd:{type:"string"},minutes:{type:"string"},seconds:{type:"string"},dstStart:{type:"string"},fullYear:{type:"string"}}},tags:{type:"string"},test:{type:"string"},author:{type:"object"},domain:{type:"string"},pageID:{type:"string"},server:{type:"string"},siteID:{type:"string"},sysEnv:{type:"string"},urlAMP:{type:"string"},edition:{type:"string"},campaign:{type:"string"},cleanURL:{type:"string"},language:{type:"string"},loadType:{type:"string"},pageName:{type:"string"},platform:{type:"string"},thematic:{type:"string"},adblocker:{type:"string"},articleID:{type:"string"},geoRegion:{type:"string"},pageTitle:{type:"string"},publisher:{type:"string"},serverAMP:{type:"string"},urlParams:{type:"object"},validPage:{type:"boolean"},pageHeight:{type:"string"},updateDate:{type:"string"},clickOrigin:{type:"string"},liveContent:{type:"string"},privateMode:{type:"string"},publishDate:{type:"string"},publisherID:{type:"string"},articleTitle:{type:"string"},audioContent:{type:"string"},businessUnit:{type:"string"},canonicalURL:{type:"string"},creationDate:{type:"string"},onsiteSearch:{type:"string"},pageTypology:{type:"string"},previousPage:{type:"string"},referringURL:{type:"string"},videoContent:{type:"string"},articleLength:{type:"string"},translatePage:{type:"boolean"},brandedContent:{type:"string"},destinationURL:{type:"string"},referringDomain:{type:"string"},onsiteSearchTerm:{type:"string"},editionNavigation:{type:"string"},onsiteSearchResults:{type:"string"}}},pageInstanceID:{type:"string"}}},user:{type:"object",properties:{ID:{type:"string"},name:{type:"string"},type:{type:"string"},country:{type:"string"},profileID:{type:"string"},subscriptions:{type:"string"},registeredUser:{type:"string"},experienceCloudID:{type:"string"},registeredUserAMP:{type:"string"}}},event:{type:"array",items:{category:{type:"object"},eventInfo:{type:"object"},attributes:{type:"object"}}},device:{type:"object",properties:{type:{type:"string"},language:{type:"string"},platform:{type:"string"},userAgent:{type:"string"},cookieEnabled:{type:"boolean"}}},paywall:{type:"object",properties:{type:{type:"string"},access:{type:"string"},active:{type:"boolean"},counter:{type:"integer"},cartProduct:{type:"string"},signwallType:{type:"string"},contentAdType:{type:"string"},transactionID:{type:"string"},contentBlocked:{type:"string"},transactionType:{type:"string"},transactionOrigin:{type:"string"}}},pageInstanceID:{type:"string"}}},dataSchemaType:"custom"},modules:{"adobe-contexthub/src/lib/dataElement/dataElement.js":{name:"contexthub",displayName:"Context Hub",script:function(e,t,n,a){"use strict";function r(e,t){if(null!=t){for(var n=t,a=e.split("."),r=0;r<a.length;++r){if(void 0===n[a[r]])return;n=n[a[r]]}return n}}var i=n("@adobe/reactor-window");e.exports=function(e){var t=a.getExtensionSettings(),n="ContextHub";if("custom"===t.dataSchemaType&&void 0!==t.root&&(n=t.root.replace("window.","")),"ContextHub"===n&&void 0!==i[n]&&"function"==typeof i[n].getAllStores){var o=e.item.replace(/\./g,"/");return i[n].getItem("/store/"+o)}var s=r(n,i);return r(e.item,s)}}}}}},company:{orgId:"2387401053DB208C0A490D4C@AdobeOrg",dynamicCdnEnabled:!1},property:{name:"EL PAIS PEP",settings:{domains:["elpais.com"],undefinedVarsReturnEmpty:!0,ruleComponentSequencingEnabled:!1},id:"PR73bf70394c264af4a0a7870d96713a0d"},rules:[{id:"RLcb403ac05dd444518447b342ae389f85",name:"Youtube en Widgets ESKUP",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"undefined"!=typeof DTM&&void 0!==DTM.config&&void 0!==DTM.config.isWidget?!!DTM.config.isWidget:document.location.href.indexOf("/Comentarios/")>-1||document.location.href.indexOf("/widgets/")>-1||document.location.href.indexOf("/Widgets/")>-1||document.location.href.indexOf("widget.html")>-1}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'//Funciones\n\n/*** Eventos ***/\nwindow._yt_track = function(eventName, player){\n\n    var videoID = player.getVideoData().video_id;\n    var videoTitle = player.getVideoData().title;\n    var playerDuration = parseInt(player.getDuration());\n\n    DTM.trackEvent(eventName, {\n        "playerType": "youtube",\n        "videoName": "directo eskup: " + videoTitle,\n        "videoSource": "directos eskup",\n        "videoRepMode": "organico",\n        "videoRepType": "vod",\n        "mediaFormat": "video",\n        "videoDuration": playerDuration,\n        "videoCreateSection": "directos eskup",\n        "videoIframe": "iframe-eskup"\n    });\n\n }\n\n\n/*** ON PLAYER STATE CHANGE ***/\nwindow.onPlayerStateChange = function(event){\n\n    var videoID = event.target.getVideoData().video_id;\n    var videoTitle = event.target.getVideoData().title;\n    var playerCurrentTime = parseInt(event.target.getCurrentTime());\n\n    if (event.data === YT.PlayerState.PLAYING) {\n\n        //console.log(" [[PLAY]] Nombre de video " + videoTitle + \' Tiempo: \' + dtm_playerList[videoID].player.getCurrentTime());\n\n        /* Evento 50% de Video */\n        if (playerCurrentTime >= dtm_playerList[videoID].player.getDuration() / 2 && !dtm_playerList[videoID].playFlag50 && dtm_playerList[videoID].playFlag == true) {\n            _yt_track("video50", event.target);\n            dtm_playerList[videoID].playFlag50 = true;\n        }\n\n\n        if (!dtm_playerList[videoID].playFlag && playerCurrentTime == 0) {\n            console.log(\'started \');\n            /* Evento Inicio de video */\n            _yt_track("videoPlay", event.target);\n            dtm_playerList[videoID].playFlag = true;\n        }\n\n    } else if (event.data === YT.PlayerState.ENDED) {\n\n        //console.log(" [[FIN]] Nombre de video " + videoTitle + \' Tiempo: \' + dtm_playerList[videoID].player.getCurrentTime());\n\n        /* Evento 50% de video */\n        if (!dtm_playerList[videoID].playFlag50 && dtm_playerList[videoID].playFlag == true) {\n            _yt_track("video50", event.target);\n            dtm_playerList[videoID].playFlag50 = true;\n        }\n\n        /* Evento Fin de video */\n        if (dtm_playerList[videoID].playFlag == true && dtm_playerList[videoID].playFlag50 == true) {\n            _yt_track("videoEnd", event.target);\n            dtm_playerList[videoID].playFlag = false;\n            dtm_playerList[videoID].playFlag50 = false;\n        }\n\n    }\n\n} // fin onPlayerStateChange\n\n/** onYouTubeIframeAPIReady **/\nwindow.player;\nwindow.onYouTubeIframeAPIReady = function(){\n\n    dtm_youtubeGetIframes();  \n\n    dtm_setOnStateChange();\n\n} // fin onYouTubeIframeAPIReady\n\n\n/** getIframes **/\nwindow.dtm_youtubeGetIframes = function(){\n\n    window.dtm_playerList = []; //Lista de objetos con id, elemento iframe, playFlag, playFlag50 y objeto player\n    var elems = document.getElementsByTagName(\'iframe\');\n    if (elems.length != 0) {\n        for (var i = 0; i < elems.length; i++) {\n            var regExp_yt = /https:\\/\\/(www\\.)?youtube\\.com\\/embed\\/+([^\\?]*)(\\?enablejsapi=1)?/;\n            var result = regExp_yt.exec(elems[i].src);\n            if (result) {\n\n                dtm_playerList[result[2]] = {\n                    id: result[2],\n                    iframe: elems[i],\n                    playFlag: false,\n                    playFlag50: false\n                };\n\n                var _src = elems[i].src;\n\n                if(typeof result[1] == "undefined")\n                    _src = elems[i].src.replace(/\\/\\/youtube.com/gi, "//www.youtube.com");\n\n                if (result[3] != "?enablejsapi=1" || typeof result[3] == "undefined") {\n                    _src += "?enablejsapi=1"; // Habilitar la API\n                }\n\n                elems[i].src = _src;\n\n            }\n        }\n    }\n}\n\n//Carga de librer\xeda\nwindow.dtm_loadYoutube = function(){\n\n  //Funci\xf3n interna para cargar scripts externos\n  function loadScript(e,a){var t=document.createElement("script");t.type="text/javascript",t.async=!0;var n=document.getElementsByTagName("head")[0];t.addEventListener?t.addEventListener("load",a,!1):t.onload?t.onload=a:document.all&&(s.onreadystatechange=function(){var e=s.readyState;"loaded"!==e&&"complete"!==e||(a(),s.onreadystatechange=null)}),t.src=e,n.appendChild(t)}\n\n  //Cargamos librer\xeda\n  loadScript("https://www.youtube.com/iframe_api", function(){});\n\n}\n\nwindow.dtm_setOnStateChange = function(){\n\n    for (var val in dtm_playerList) {\n        player = new YT.Player(dtm_playerList[val].iframe, {\n            events: {\n                \'onStateChange\': onPlayerStateChange\n            }\n        });\n\n        dtm_playerList[val].player = player;\n    }\n\n}\n\n//INIT\nif(document.readyState == "complete"){\n  dtm_loadYoutube();\n}else{\n  window.addEventListener("load", function(event) {\n    dtm_loadYoutube();\n  });\n}\n\n//Controlamos tambi\xe9n los cambios de p\xe1gina\nwindow.addEventListener("hashchange", function(){\n    setTimeout(function(){\n        dtm_youtubeGetIframes();\n        dtm_setOnStateChange();\n    }, 1000);\n});',language:"javascript"}}]}]};var _satellite=function(){"use strict";function e(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function t(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}function n(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})})),t}function a(e){var t={exports:{}};return e(t,t.exports),t.exports}function r(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))}function i(e){return Boolean(e&&void 0!==e.length)}function o(){}function s(e,t){return function(){e.apply(t,arguments)}}function c(e){if(!(this instanceof c))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],m(e,this)}function l(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,c._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var a;try{a=n(e._value)}catch(e){return void d(t.promise,e)}u(t.promise,a)}else(1===e._state?u:d)(t.promise,e._value)}))):e._deferreds.push(t)}function u(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof c)return e._state=3,e._value=t,void p(e);if("function"==typeof n)return void m(s(n,t),e)}e._state=1,e._value=t,p(e)}catch(t){d(e,t)}}function d(e,t){e._state=2,e._value=t,p(e)}function p(e){2===e._state&&0===e._deferreds.length&&c._immediateFn((function(){e._handled||c._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)l(e,e._deferreds[t]);e._deferreds=null}function f(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function m(e,t){var n=!1;try{e((function(e){n||(n=!0,u(t,e))}),(function(e){n||(n=!0,d(t,e))}))}catch(e){if(n)return;n=!0,d(t,e)}}function g(e){return!0===Ue(e)&&"[object Object]"===Object.prototype.toString.call(e)}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function b(e){return"string"==typeof e&&-1!==e.indexOf("[")&&-1!==e.indexOf("]")}function y(e){return e.substr(0,e.indexOf("["))}function v(e,t,n){if(e.length&&He(t)){var a=e[0];if(1!==e.length){var r=e.slice(1);if(!b(a))return v(r,t[a],n);var i=t[a=y(a)];Array.isArray(i)&&i.forEach((function(e){return v(r,e,n)}))}else t.hasOwnProperty(a)&&"string"==typeof t[a]&&(t[a]=n(t[a]))}}if(window.atob){var E=document,P=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable,I=t()?Object.assign:function(t){for(var n,a,r=e(t),i=1;i<arguments.length;i++){for(var o in n=Object(arguments[i]))C.call(n,o)&&(r[o]=n[o]);if(P){a=P(n);for(var s=0;s<a.length;s++)D.call(n,a[s])&&(r[a[s]]=n[a[s]])}}return r},k=I,_=window,A=function(e,t,n,a){var r,i=Boolean(t&&Array.isArray(n)),o=Boolean(i&&e),s=document.createElement("a");if(i){var c=function(){var e=new Error("Unable to find the Library Embed Code for Dynamic Host Resolution.");throw e.code="dynamic_host_resolver_constructor_error",e};if(e&&(/^((https?:)?\/\/).+/.test(e)||c(),/^\/\/.+/.test(e)?s.href=_.location.protocol+e:s.href=e),s.hostname||c(),-1===n.indexOf(s.hostname)){var l=new Error("This library is not authorized for this domain. Please contact your CSM for more information.");throw l.code="dynamic_host_not_allowed",l}}var u=function(){if(null!=r)return r;if(o){var e=s.host;/:80$/.test(e)?e=e.replace(":80",""):/:80\/$/.test(e)?e=e.replace(":80/",""):/:443$/.test(e)?e=e.replace(":443",""):/:443\/$/.test(e)&&(e=e.replace(":443/","")),r=s.protocol+"//"+e}else r="";return r},d=function(e){return o&&"string"==typeof e?[u(),"/"===e.charAt(0)?e.slice(1):e].join("/"):e},p={getTurbineHost:u,decorateWithDynamicHost:d,get isDynamicEnforced(){return i}};return _&&a.onDebugChanged((function(e){e?_.dynamicHostResolver=p:delete _.dynamicHostResolver})),p},S=function(e){var t=[];return e.forEach((function(e){e.events&&e.events.forEach((function(n){t.push({rule:e,event:n})}))})),t.sort((function(e,t){return e.event.ruleOrder-t.event.ruleOrder}))},M="debug",R=function(e,t){var n=function(){return"true"===e.getItem(M)},a=function(t){e.setItem(M,t)},r=[],i=function(e){r.push(e)};return t.outputEnabled=n(),{onDebugChanged:i,getDebugEnabled:n,setDebugEnabled:function(e){n()!==e&&(a(e),t.outputEnabled=e,r.forEach((function(t){t(e)})))}}},T="Module did not export a function.",w=function(e,t,n){return function(a,r,i){i=i||[];var o=e.getModuleExports(a.modulePath);if("function"!=typeof o)throw new Error(T);var s=e.getModuleDefinition(a.modulePath),c=a.settings||{};!a.hasTransformedFilePaths&&s.filePaths&&(n(c,s.filePaths,a.modulePath),a.hasTransformedFilePaths=!0);var l=t(c,r);return o.bind(null,l).apply(null,i)}},O=function(e){return"string"==typeof e?e.replace(/\s+/g," ").trim():e},N={LOG:"log",INFO:"info",DEBUG:"debug",WARN:"warn",ERROR:"error"},x="\ud83d\ude80",j=10===parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1])?"[Launch]":x,L=!1,V=function(e){if(L&&window.console){var t=Array.prototype.slice.call(arguments,1);t.unshift(j),e!==N.DEBUG||window.console[e]||(e=N.INFO),window.console[e].apply(window.console,t)}},F=V.bind(null,N.LOG),U=V.bind(null,N.INFO),H=V.bind(null,N.DEBUG),B=V.bind(null,N.WARN),G=V.bind(null,N.ERROR),q=function(){var e=L;L=!0,V.apply(null,Array.prototype.concat(N.WARN,Array.prototype.slice.call(arguments))),e||(L=!1)},W={log:F,info:U,debug:H,warn:B,error:G,deprecation:q,get outputEnabled(){return L},set outputEnabled(e){L=e},createPrefixedLogger:function(e){var t="["+e+"]";return{log:F.bind(null,t),info:U.bind(null,t),debug:H.bind(null,t),warn:B.bind(null,t),error:G.bind(null,t)}}},Y="com.adobe.reactor.",$=function(e,t){var n=Y+(t||"");return{getItem:function(t){try{return _[e].getItem(n+t)}catch(e){return null}},setItem:function(t,a){try{return _[e].setItem(n+t,a),!0}catch(e){return!1}}}},J="dataElements.",K=$("sessionStorage",J),z=$("localStorage",J),X={PAGEVIEW:"pageview",SESSION:"session",VISITOR:"visitor"},Q={},Z=function(e){var t;try{t=JSON.stringify(e)}catch(e){}return t},ee={setValue:function(e,t,n){var a;switch(t){case X.PAGEVIEW:return void(Q[e]=n);case X.SESSION:return void((a=Z(n))&&K.setItem(e,a));case X.VISITOR:return void((a=Z(n))&&z.setItem(e,a))}},getValue:function(e,t){var n;switch(t){case X.PAGEVIEW:return Q.hasOwnProperty(e)?Q[e]:null;case X.SESSION:return null===(n=K.getItem(e))?n:JSON.parse(n);case X.VISITOR:return null===(n=z.getItem(e))?n:JSON.parse(n)}}},te=function(e,t,n,a){return"Failed to execute data element module "+e.modulePath+" for data element "+t+". "+n+(a?"\n"+a:"")},ne=function(e,t,n,a,r){return function(i,o){var s=t(i);if(!s)return a?"":void 0;var c,l,u=s.storageDuration;try{c=e.getModuleExports(s.modulePath),l=e.getModuleDefinition(s.modulePath)}catch(e){return void W.error(te(s,i,e.message,e.stack))}if("function"==typeof c){var d,p=s.settings||{};!s.hasTransformedFilePaths&&l.filePaths&&(r(p,l.filePaths,s.modulePath),s.hasTransformedFilePaths=!0);try{d=c(n(p,o),o)}catch(e){return void W.error(te(s,i,e.message,e.stack))}return u&&(null!=d?ee.setValue(i,u,d):d=ee.getValue(i,u)),null==d&&null!=s.defaultValue&&(d=s.defaultValue),"string"==typeof d&&(s.cleanText&&(d=O(d)),s.forceLowerCase&&(d=d.toLowerCase())),d}W.error(te(s,i,"Module did not export a function."))}},ae={text:function(e){return e.textContent},cleanText:function(e){return O(e.textContent)}},re=function(e,t,n){for(var a,r=e,i=0,o=t.length;i<o;i++){if(null==r)return;var s=t[i];if(n&&"@"===s.charAt(0)){var c=s.slice(1);r=ae[c](r)}else if(r.getAttribute&&(a=s.match(/^getAttribute\((.+)\)$/))){var l=a[1];r=r.getAttribute(l)}else r=r[s]}return r},ie=function(e,t,n){return function(a,r){var i;if(t(a))i=n(a,r);else{var o=a.split("."),s=o.shift();"this"===s?r&&(i=re(r.element,o,!0)):"event"===s?r&&(i=re(r,o)):"target"===s?r&&(i=re(r.target,o)):i=re(e[s],o)}return i}},oe=function(e,t){return function(n){var a=n.split(".")[0];return Boolean(t(n)||"this"===a||"event"===a||"target"===a||e.hasOwnProperty(a))}},se=function(e,t,n){var a={exports:{}};return e.call(a.exports,a,a.exports,t,n),a.exports},ce=function(){var e={},t=function(t){var n=e[t];if(!n)throw new Error("Module "+t+" not found.");return n},n=function(){Object.keys(e).forEach((function(e){try{a(e)}catch(n){var t="Error initializing module "+e+". "+n.message+(n.stack?"\n"+n.stack:"");W.error(t)}}))},a=function(e){var n=t(e);return n.hasOwnProperty("exports")||(n.exports=se(n.definition.script,n.require,n.turbine)),n.exports};return{registerModule:function(t,n,a,r,i){var o={definition:n,extensionName:a,require:r,turbine:i};o.require=r,e[t]=o},hydrateCache:n,getModuleExports:a,getModuleDefinition:function(e){return t(e).definition},getModuleExtensionName:function(e){return t(e).extensionName}}},le=!1,ue=function(e){return function(t,n){var a=e._monitors;a&&(le||(W.warn("The _satellite._monitors API may change at any time and should only be used for debugging."),le=!0),a.forEach((function(e){e[t]&&e[t](n)})))}},de=function(e,t,n){var a,r,i,o,s=[],c=function(a,r,i){if(!e(r))return a;s.push(r);var o=t(r,i);return s.pop(),null==o&&n?"":o};return a=function(e,t){var n=/^%([^%]+)%$/.exec(e);return n?c(e,n[1],t):e.replace(/%(.+?)%/g,(function(e,n){return c(e,n,t)}))},r=function(e,t){for(var n={},a=Object.keys(e),r=0;r<a.length;r++){var i=a[r],s=e[i];n[i]=o(s,t)}return n},i=function(e,t){for(var n=[],a=0,r=e.length;a<r;a++)n.push(o(e[a],t));return n},o=function(e,t){return"string"==typeof e?a(e,t):Array.isArray(e)?i(e,t):"object"==typeof e&&null!==e?r(e,t):e},function(e,t){return s.length>10?(W.error("Data element circular reference detected: "+s.join(" -> ")),e):o(e,t)}},pe=function(e){return function(){if("string"==typeof arguments[0])e[arguments[0]]=arguments[1];else if(arguments[0]){var t=arguments[0];for(var n in t)e[n]=t[n]}}
},fe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},me=setTimeout;c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){var n=new this.constructor(o);return l(this,new f(e,t,n)),n},c.prototype.finally=r,c.all=function(e){return new c((function(t,n){function a(e,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var s=i.then;if("function"==typeof s)return void s.call(i,(function(t){a(e,t)}),n)}r[e]=i,0==--o&&t(r)}catch(e){n(e)}}if(!i(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);for(var o=r.length,s=0;s<r.length;s++)a(s,r[s])}))},c.resolve=function(e){return e&&"object"==typeof e&&e.constructor===c?e:new c((function(t){t(e)}))},c.reject=function(e){return new c((function(t,n){n(e)}))},c.race=function(e){return new c((function(t,n){if(!i(e))return n(new TypeError("Promise.race accepts an array"));for(var a=0,r=e.length;a<r;a++)c.resolve(e[a]).then(t,n)}))},c._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){me(e,0)},c._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var ge=n(Object.freeze({__proto__:null,default:c})),he="undefined"!=typeof window&&window.Promise||void 0!==fe&&fe.Promise||ge.default||ge,be=function(e,t,n){return function(a,r,i,o){return o.then((function(){var o,s=a.delayNext;return new he((function(t,n){var r=e(a,i,[i]);if(!s)return t();var c=a.timeout,l=new he((function(e,t){o=setTimeout((function(){t(new Error("A timeout occurred because the action took longer than "+c/1e3+" seconds to complete. "))}),c)}));he.race([r,l]).then(t,n)})).catch((function(e){return clearTimeout(o),e=t(e),n(a,r,e),he.reject(e)})).then((function(){clearTimeout(o)}))}))}},ye=function(e,t,n,a,r){return function(i,o,s,c){return c.then((function(){var c;return new he((function(t,n){var a=e(i,s,[s]),r=i.timeout,o=new he((function(e,t){c=setTimeout((function(){t(new Error("A timeout occurred because the condition took longer than "+r/1e3+" seconds to complete. "))}),r)}));he.race([a,o]).then(t,n)})).catch((function(e){return clearTimeout(c),e=t(e),a(i,o,e),he.reject(e)})).then((function(e){if(clearTimeout(c),!n(i,e))return r(i,o),he.reject()}))}))}},ve=he.resolve(),Ee=function(e,t,n){return function(a,r){return a.conditions&&a.conditions.forEach((function(t){ve=e(t,a,r,ve)})),a.actions&&a.actions.forEach((function(e){ve=t(e,a,r,ve)})),ve=(ve=ve.then((function(){n(a)}))).catch((function(){}))}},Pe=function(e){return Boolean(e&&"object"==typeof e&&"function"==typeof e.then)},Ce=function(e,t,n,a){return function(r,i){var o;if(r.conditions)for(var s=0;s<r.conditions.length;s++){o=r.conditions[s];try{var c=e(o,i,[i]);if(Pe(c))throw new Error("Rule component sequencing must be enabled on the property for this condition to function properly.");if(!t(o,c))return n(o,r),!1}catch(e){return a(o,r,e),!1}}return!0}},De=function(e,t){return function(n,a){e(n,a)&&t(n,a)}},Ie=function(e){return function(t){var n=e.getModuleDefinition(t.modulePath);return n&&n.displayName||t.modulePath}},ke=function(e){return function(t){var n=t.rule,a=t.event,r=e.getModuleDefinition(a.modulePath).name;return{$type:e.getModuleExtensionName(a.modulePath)+"."+r,$rule:{id:n.id,name:n.name}}}},_e=function(e,t,n,a,r,i){return function(o,s){var c=s.rule,l=s.event;l.settings=l.settings||{};try{var u=r(s);t(l,null,[function(t){var a=n(u,t);o((function(){e(a,c)}))}])}catch(e){i.error(a(l,c,e))}}},Ae=function(e,t,n,a){return function(r,i,o){var s=t(r);n.error(e(s,i.name,o)),a("ruleActionFailed",{rule:i,action:r})}},Se=function(e,t,n,a){return function(r,i,o){var s=t(r);n.error(e(s,i.name,o)),a("ruleConditionFailed",{rule:i,condition:r})}},Me=function(e,t,n){return function(a,r){var i=e(a);t.log('Condition "'+i+'" for rule "'+r.name+'" was not met.'),n("ruleConditionFailed",{rule:r,condition:a})}},Re=function(e,t){return function(n){e.log('Rule "'+n.name+'" fired.'),t("ruleCompleted",{rule:n})}},Te=function(e,t,n){return function(a,r){var i;if(a.actions)for(var o=0;o<a.actions.length;o++){i=a.actions[o];try{e(i,r,[r])}catch(e){return void t(i,a,e)}}n(a)}},we=function(e,t,n,a){return function(r,i){a("ruleTriggered",{rule:i}),e?n(i,r):t(i,r)}},Oe=function(e,t,n){return'Failed to execute "'+e+'" for "'+t+'" rule. '+n.message+(n.stack?"\n"+n.stack:"")},Ne=function(e,t){return t&&!e.negate||!t&&e.negate},xe=[],je=!1,Le=function(e){je?e():xe.push(e)},Ve=function(e,t,n){e(t).forEach((function(e){n(Le,e)})),je=!0,xe.forEach((function(e){e()})),xe=[]},Fe=function(e){if(e||(e=new Error("The extension triggered an error, but no error information was provided.")),!(e instanceof Error)){var t="object"==typeof e?JSON.stringify(e):String(e);e=new Error(t)}return e},Ue=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)},He=function(e){var t,n;return!1!==g(e)&&("function"==typeof(t=e.constructor)&&(!1!==g(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},Be=function(e,t){return He(t=t||{})?t=k({},t,e):k(t,e),t.hasOwnProperty("type")||Object.defineProperty(t,"type",{get:function(){return W.deprecation("Accessing event.type in Adobe Launch has been deprecated and will be removed soon. Please use event.$type instead."),t.$type}}),t},Ge=function(e,t){return function(n,a){var r=e[n];if(r){var i=r.modules;if(i)for(var o=Object.keys(i),s=0;s<o.length;s++){var c=o[s],l=i[c];if(l.shared&&l.name===a)return t.getModuleExports(c)}}}},qe=function(e,t){return function(){return t?e(t):{}}},We=function(e,t,n){return function(a){if(n){var r=a.split(".");r.splice(r.length-1||1,0,"min"),a=r.join(".")}return e(t)+a}},Ye=".js",$e=function(e){return e.substr(0,e.lastIndexOf("/"))},Je=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},Ke=function(e,t){Je(t,Ye)||(t+=Ye);var n=t.split("/"),a=$e(e).split("/");return n.forEach((function(e){e&&"."!==e&&(".."===e?a.length&&a.pop():a.push(e))})),a.join("/")},ze=a((function(e){!function(t){if(e.exports=t(),!!0){var n=window.Cookies,a=window.Cookies=t();a.noConflict=function(){return window.Cookies=n,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(a){function r(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},r.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var o=JSON.stringify(n);/^[\{\[]/.test(o)&&(n=o)}catch(e){}n=a.write?a.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in i)i[c]&&(s+="; "+c,!0!==i[c]&&(s+="="+i[c].split(";")[0]));return document.cookie=t+"="+n+s}}function o(e,n){if("undefined"!=typeof document){for(var r={},i=document.cookie?document.cookie.split("; "):[],o=0;o<i.length;o++){var s=i[o].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(a.read||a)(c,l)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(r[l]=c,e===l)break}catch(e){}}return e?r[e]:r}}return r.set=i,r.get=function(e){return o(e,!1)},r.getJSON=function(e){return o(e,!0)},r.remove=function(t,n){i(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}return n((function(){}))}))})),Xe={get:ze.get,set:ze.set,remove:ze.remove},Qe=function(e,t){return new he((function(n,a){t.onload=function(){n(t)},t.onerror=function(){a(new Error("Failed to load script "+e))}}))},Ze=function(e){var t=document.createElement("script");t.src=e,t.async=!0;var n=Qe(e,t);return document.getElementsByTagName("head")[0].appendChild(t),n},et=function(e,t,n,a){t=t||"&",n=n||"=";var r={};if("string"!=typeof e||0===e.length)return r;var i=/\+/g;e=e.split(t);var o=1e3;a&&"number"==typeof a.maxKeys&&(o=a.maxKeys);var s=e.length;o>0&&s>o&&(s=o);for(var c=0;c<s;++c){var l,u,d,p,f=e[c].replace(i,"%20"),m=f.indexOf(n);m>=0?(l=f.substr(0,m),u=f.substr(m+1)):(l=f,u=""),d=decodeURIComponent(l),p=decodeURIComponent(u),h(r,d)?Array.isArray(r[d])?r[d].push(p):r[d]=[r[d],p]:r[d]=p}return r},tt=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},nt=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(a){var r=encodeURIComponent(tt(a))+n;return Array.isArray(e[a])?e[a].map((function(e){return r+encodeURIComponent(tt(e))})).join(t):r+encodeURIComponent(tt(e[a]))})).join(t):a?encodeURIComponent(tt(a))+n+encodeURIComponent(tt(e)):""},at=a((function(e,t){t.decode=t.parse=et,t.encode=t.stringify=nt})),rt="@adobe/reactor-",it={cookie:Xe,document:E,"load-script":Ze,"object-assign":k,promise:he,"query-string":{parse:function(e){return"string"==typeof e&&(e=e.trim().replace(/^[?#&]/,"")),at.parse(e)},stringify:function(e){return at.stringify(e)}},window:_},ot=function(e){return function(t){if(0===t.indexOf(rt)){var n=t.substr(rt.length),a=it[n];if(a)return a}if(0===t.indexOf("./")||0===t.indexOf("../"))return e(t);throw new Error('Cannot resolve module "'+t+'".')}},st=function(e,t,n,a,r,i,o){var s=e.extensions,c=e.buildInfo,l=e.environment,u=e.property.settings;if(s){var d=Ge(s,t);Object.keys(s).forEach((function(p){var f=s[p],m=f.settings;Array.isArray(f.filePaths)&&(m=i(m,f.filePaths));var g=qe(a,m);if(f.modules){var h=W.createPrefixedLogger(f.displayName),b=We(o,f.hostedLibFilesBaseUrl,c.minified),y={buildInfo:c,environment:l,property:{name:e.property.name,id:e.property.id},getDataElementValue:r,getExtensionSettings:g,getHostedLibFileUrl:b,getSharedModule:d,logger:h,propertySettings:u,replaceTokens:a,onDebugChanged:n.onDebugChanged,get debugEnabled(){return n.getDebugEnabled()}};Object.keys(f.modules).forEach((function(e){var n=f.modules[e],a=ot((function(n){var a=Ke(e,n);return t.getModuleExports(a)}));t.registerModule(e,n,p,a,y)}))}})),t.hydrateCache()}return t},ct=function(e,t,n,a,r){var i=W.createPrefixedLogger("Custom Script");e.track=function(e){W.log('"'+e+'" does not match any direct call identifiers.')},e.getVisitorId=function(){return null},e.property={name:t.property.name,id:t.property.id},e.company=t.company,e.buildInfo=t.buildInfo,e.environment=t.environment,e.logger=i,e.notify=function(e,t){switch(W.deprecation("_satellite.notify is deprecated. Please use the `_satellite.logger` API."),t){case 3:i.info(e);break;case 4:i.warn(e);break;case 5:i.error(e);break;default:i.log(e)}},e.getVar=a,e.setVar=r,e.setCookie=function(e,t,n){var a="",r={};n&&(a=", { expires: "+n+" }",r.expires=n);var i='_satellite.setCookie is deprecated. Please use _satellite.cookie.set("'+e+'", "'+t+'"'+a+").";W.deprecation(i),Xe.set(e,t,r)},e.readCookie=function(e){return W.deprecation('_satellite.readCookie is deprecated. Please use _satellite.cookie.get("'+e+'").'),Xe.get(e)},e.removeCookie=function(e){W.deprecation('_satellite.removeCookie is deprecated. Please use _satellite.cookie.remove("'+e+'").'),Xe.remove(e)},e.cookie=Xe,e.pageBottom=function(){},e.setDebug=n;var o=!1;Object.defineProperty(e,"_container",{get:function(){return o||(W.warn("_satellite._container may change at any time and should only be used for debugging."),o=!0),t}})},lt=function(e){for(var t=E.querySelectorAll("script"),n=0;n<t.length;n++){var a=t[n];if(e.test(a.src))return a}},ut=function(e,t){return function(n,a,r){return e&&He(n)&&Object.keys(n).length&&Array.isArray(a)&&a.length?(a.forEach((function(e){Boolean(null!=r&&/^core\/.*actions.*\/customCode\.js$/.test(r))&&"source"===e&&!n.isExternal||v(e.split("."),n,t)})),n):n}},dt={getTurbine:function(){return lt(new RegExp(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/))},byRegexPattern:lt}.getTurbine,pt=window._satellite;if(pt&&!window.__satelliteLoaded){window.__satelliteLoaded=!0;var ft=pt.container;delete pt.container;var mt=k({},ft.buildInfo);Object.defineProperty(mt,"environment",{get:function(){return W.deprecation("container.buildInfo.environment is deprecated.Please use `container.environment.stage` instead"),ft.environment.stage}}),ft.buildInfo=mt;var gt,ht=R($("localStorage"),W),bt="";E.currentScript&&E.currentScript.getAttribute("src")?bt=E.currentScript.getAttribute("src"):dt()&&(bt=dt().getAttribute("src"));try{gt=A(bt,Boolean(ft.company.dynamicCdnEnabled),ft.company.cdnAllowList,ht)}catch(e){throw W.warn("Please review the following error:"),e}var yt,vt=ut(gt.isDynamicEnforced,gt.decorateWithDynamicHost),Et=ce(),Pt=ft.property.settings.undefinedVarsReturnEmpty,Ct=ft.property.settings.ruleComponentSequencingEnabled,Dt=ft.dataElements||{},It=function(e){return Dt[e]},kt=function(){return yt.apply(null,arguments)},_t=ne(Et,It,kt,Pt,vt),At={},St=pe(At),Mt=oe(At,It),Rt=ie(At,It,_t);yt=de(Mt,Rt,Pt),ct(pt,ft,ht.setDebugEnabled,Rt,St),st(ft,Et,ht,yt,_t,vt,gt.decorateWithDynamicHost);var Tt=ue(pt),wt=w(Et,yt,vt),Ot=Ie(Et),Nt=Me(Ot,W,Tt),xt=Se(Oe,Ot,W,Tt),jt=Ae(Oe,Ot,W,Tt),Lt=Re(W,Tt),Vt=_e(we(Ct,De(Ce(wt,Ne,Nt,xt),Te(wt,jt,Lt)),Ee(ye(wt,Fe,Ne,xt,Nt),be(wt,Fe,jt),Lt),Tt),wt,Be,Oe,ke(Et),W);Ve(S,ft.rules||[],Vt)}return pt}console.warn("Adobe Launch is unsupported in IE 9 and below.")}();

/**
 * Librera para la gestin centralizada de todos los tags de la pgina.
 * Centraliza los puntos de comunicacin con la pgina en: Data Layer (para el paso de informacin), DTM.trackEvent (para el marcado de eventos) y DTM.trackAsyncPV (para el marcado de pginas asncronas)
 * Funcionamiento:
 * 1. Desde DTM.dataLayer, se recoge el Data Layer de pgina y forma el Data Layer principal (digitalData) con todos los datos necesarios para el marcado
 * 2. Una vez inicializado el Data Layer, se hace un dispatch del evento personalizado "DTMDataLayerGenerated", que har que carguen las herramientas mediante reglas (una por herramienta)
 * 3. Cada herramienta, que se gestionar en reglas distintas, dejar toda su lgica en un objeto dentro de DTM.tools. Al cargar se configurarn y marcarn la pgina vista.
 * 4. Se inicializarn los listeners manuales gestionados desde DTM.events
 * Eventos: los eventos se notifican a DTM.trackEvent, pasando el nombre del evento y los parmetros a marcar mediante valores especficos. Desde DTM.trackEvent se ejecutar la funcin trackEvent de cada herramienta.
 * Utils: en el objeto DTM.utils se guardan funciones estndar para el clculo de valores.
 **/
 window.DTM = {
	/** Versin de DTM, siempre con el prefijo launch-eppep. Formato: launch-eppep-[nmero de version].[nmero de subversin].[nmero de versin correctora] */
    version: "launch-eppep-5.0",
    /** Boolean que indica si DTM ha sido inicializado por completo */
    initialized: false,
    dateInit: (new Date()),
	internalTest: "",
	PLATFORM: {
		AMP: "amp",
		AMPPLAYER: "ampPlayer",
		FBIA: "fbia",
		MOBILEWEB: "mobileWeb",
		WEB: "web",
		WIDGET: "widget"
	},
	CONSENTS: {
		ACCEPT: 1,
		REJECT: 0,
		WAITING: 2,
		DEFAULT: -1
	},
	paywallActive: typeof DTM != "undefined" && typeof DTM.paywallActive != "undefined" ? DTM.paywallActive : false,
    config: typeof DTM != "undefined" && typeof DTM.config != "undefined" ? DTM.config : {},
	pageDataLayer: typeof DTM != "undefined" && typeof DTM.pageDataLayer != "undefined" ? DTM.pageDataLayer : false,
	/**
	* Mtodo personalizado para mostrar mensajes por consola, solo funcionar si _satellite.settings.notifications est activado. 
	* Los mensajes siempre comenzarn por "DTM:" e informarn del tiempo transcurrido desde la carga de DTM hasta el momento de la notificacin
	* en digitalData.event
	* @param message string cadena a mostrar por consola
	* @param type string opcional, indica el tipo de mensaje a mostrar por consola, valores: info, warn o error. Por defecto ser info.
	*/
	notify: function(message, type){

		type = (typeof type != "undefined") ? type : "info";

		try{
			var time = ((new Date().getTime()) - DTM.dateInit.getTime());
			time = time / 1000;
			time = time.toFixed(2);

			message = "DTM: " + message + " (" + time + "s)";

			if(type == "warn")
				_satellite.logger.warn(message);
			else if(type == "error")
				_satellite.logger.error(message);
			else
				_satellite.logger.info(message);
			
		}catch(e){
			console.info("Error DTM.notify");
		}
	},
	/**
	* Mtodo de inicializacin de DTM
	* 1. Creacin del objeto digitalData a travs de DTM.pageDataLayer. La creacin es asncrona asi que el resto de puntos se ejecutan tras evento personalizado lanzado al crear digitalData.
	* 2. Inicializacin de las herramientas de analitica: creacin de Data Layer propio y carga de libreras
	* 3. Marcado de pgina vista, se ejecuta la funcin trackPV de cada herramienta
	* 4. Inicializacin de listeners de eventos y marcado de eventos de carga de pgina (tras pgina vista)
	**/
	init: function(){
		this.notify("Version <" + this.version + "> fired " + _satellite.environment.stage, true);
		this.notify("Page <" + window.location.href + ">");
		this.dataLayer.init();
		this.tools.init();
		_satellite.pageBottom();
		this.trackPV();
		this.events.init();
	},
	dataLayer: {
		generated: false,
		timeOutTime: 800,
		timeOutCompleted: false,
		sync: "no-needed",
		userInfoCompleted: false,
		regExp:{
			blogs: /http.?:\/\/([^\/]+)\/([^\/]+)\/(.*)/i,
			diario: /http.?:\/\/([^\/]*)\/diario\/(\d+)\/(\d+)\/(\d+)\/([^\/]*)\/?/i,
			elecciones: /http.?:\/\/([^\/]*)\/elecciones\/(\d{4})\/([^\/]*)\/.*/i,
			eleccionesHome: /http.?:\/\/([^\/]*)\/elecciones\/(.*?).html/i,
			eleccionesPortadas: /http.?:\/\/([^\/]*)\/elecciones\/(\d{4})\//i,
			especiales: /http.?:\/\/[^\/]*\/([^\/]*)\/(\d{4})\/([^\/]*)\//i,
			especialesPortadas: /http.?:\/\/([^\/]*)\/([^\/]*)\/([^\/]*)\//i,
			moviles: /(http.?:\/\/[^\/]*)\/m\/(.*)/i,
			noticia: /http.?:\/\/([^\/]*)\/([^\/]*)\/(\d+)\/(\d+)\/(\d+)\/([^\/]*)\/(.*)\.html/i,
			portada: /http.?:\/\/([^\/]*)\/?(.*)/i,
			portadilla: /http.?:\/\/([^\/]*)\/([^\/]*)\/(.*)/i,
			seccion: /http.?:\/\/([^\.]*)\./i,
			seccionVirtual: /http.?:\/\/([^\/]*).elpais.com\/seccion\/([^\/]*)/i,
			sorteos: /([^\/]*)\/?/,
			tag: /([^\/]+)\/([^\/]+)\/?.*/i,
			tagRamas: /^([^\/]+)\/([^\/]+)\/.*/i,
			result_re: undefined,
			result_re2: undefined,
			result_re3: undefined,
			result_re4: undefined,
			result_re5: undefined,
			result_re6: undefined,
			result_re7: undefined
		},
		vars: {
			articleID: "",
			articleLength: "",
			articleTitle: "",
			audioContent: "not-set",
			author: [],
			businessUnit: "noticias",
			canonicalURL: "",
			cms: "",
			cookiePaywallProduct: false,
			creationDate: "",
			domain: "elpais.com",
			direccion: document.location.href.replace(/[\?#].*?$/g, ""),
			destinationURL: document.location.href,
			edition: "",
			editionNavigation: typeof window.PEPedition != "undefined" ? window.PEPedition.toLowerCase() : "espaa",
			geoRegion: "espaa",
			language: document.documentElement.lang ? document.documentElement.lang : "es",
			liveContent: "not-set",
			org: "prisa",
			pageName: "elpaiscom" + document.location.href.replace(/[\?#].*?$/g, "").replace(/http.?:\/\/[^\/]*/, ""),
			pageTitle: document.title && document.title != "" ? document.title : (document.getElementsByTagName('title')[0] ? document.getElementsByTagName('title')[0].innerHTML : "not-set"),
			pageType: "",
			pageTypology: typeof window.pageTypology != "undefined" ? window.pageTypology : "",
			paywall: {
				access: "not-set",
				active: false,
				contentAdType: "none",
				contentBlocked: "0",
				counter: "not-set",
				signwallType: "free",
				type: "none"
			},
			platform: "web",
			privateMode: "not-set",
			protocol: document.location.protocol == 'https:' ? "1" : "0",
			publisher: "el pais",
			publishDate: "",
			referringURL: document.referrer,
			search: "0",
			search_keyword: "",
			search_results: "",
			seccion: "channel",
			server: window.location.host,
			serverAMP: "",
			siteID: "elpaiscom",
			subdomain: "",
			subseccion: "seccion",
			subsubseccion: "",
			sysEnv: "web",
			test: "",
			thematic: "informacion",
			seccion_omniture: "seccion",
			subseccion_omniture: "subseccion",
			tags: [],
			translatePage: false,
			updateDate: "",
			urlParams: false,
			userSubscriptions: "not-set",
			validPage: true,
			videoContent: "not-set"
		},
		/**
		* Mtodo para la generacin del objeto digitalData (Data Layer principal de DTM) a travs del Data Layer de pgina (DTM.pageDataLayer) y el autocalculo de alguno de los valores. Se ejecuta desde DTM.init.
		* Alguno de los procesos es asncrono, por lo que se utiliza un sistema de flags (setFlag) y eventos personalizados para sincronizar la ejecucin.
		* 1. Se rellenan los parmetros sincronos
		* 2. Se ejecutan las funciones asncronas
		* Cuando finalicen todas las funciones asncronas (controladas por flags) se ejecuta un evento personalizado que devuelve el control a DTM.init. 
		* Si tras 6 segundos las flags no se han seteado se devuelve el control a DTM.init aunque el Data Layer no se haya completado.
		*/
		init: function(){
			this.multidistribution.init();
			
			//Autocalculamos los valores
			this.generateDL();
			
			//Si hay Data Layer en pgina, tiene prioridad, pisa los valores calculados
			if(typeof DTM.pageDataLayer != "undefined")
				this.pageDL();

			//validPage & translatePage
			this.vars.validPage = this.isValidPage();
			this.vars.server.indexOf("translate.goog") != -1;

			//Creacin del dataLayer
			window.digitalData = {
				page: {
					pageInstanceID: (new Date).getTime() + "_" + (Math.floor(1e8 * Math.random())),
					pageInfo: {
						articleID: this.vars.articleID,
						articleLength: this.vars.articleLength,
						articleTitle: this.vars.articleTitle != "" ? this.vars.articleTitle : this.getArticleTitle(),
						audioContent: this.vars.audioContent,
						author: this.vars.author.length != 0 ? this.vars.author : this.arrayAuthors(),
						brandedContent: "0",
						businessUnit: this.vars.businessUnit,
						campaign: "",
						canonicalURL: this.vars.canonicalURL == "" ? this.getCanonical() : this.vars.canonicalURL,
						cleanURL: this.vars.direccion,
						clickOrigin: "",
						cms: this.vars.cms == "" ? this.getCMS(this.vars.server) : this.vars.cms,
						creationDate: this.vars.creationDate,
						date: {
							day: DTM.utils.formatDate(DTM.dateInit.getDate()),
							dstEnd: "12/31/" + DTM.dateInit.getFullYear(),
							dstStart: "1/1/" + DTM.dateInit.getFullYear(),
							fullYear: DTM.dateInit.getFullYear(),
							gmt: (-(DTM.dateInit.getTimezoneOffset() / 60) - 1) >= 0 ? "+" + (-(DTM.dateInit.getTimezoneOffset() / 60) - 1).toString() : (-(DTM.dateInit.getTimezoneOffset() / 60) - 1),
							hours: DTM.utils.formatDate(DTM.dateInit.getHours()),
							minutes: DTM.utils.formatDate(DTM.dateInit.getMinutes()),
							month: DTM.utils.formatDate(DTM.dateInit.getMonth() + 1),
							seconds: DTM.utils.formatDate(DTM.dateInit.getSeconds()),
							year: DTM.dateInit.getFullYear()
						},
						destinationURL: this.vars.destinationURL,
						domain: this.vars.domain,
						edition: this.getEdition(),
						editionNavigation: this.vars.editionNavigation,
						geoRegion: this.vars.geoRegion,
						language: this.vars.language,
						loadType: "secuencial",
						liveContent: this.vars.liveContent,
						onsiteSearch: "",
						onsiteSearchTerm: "",
						onsiteSearchResults: "",
						org: this.vars.org,
						pageHeight: "",
						pageID: document.location.href,
						pageName: this.vars.pageName,
						pageTitle: this.vars.pageTitle,
						pageTypology: this.vars.pageTypology,
						platform: this.vars.platform,
						privateMode: this.vars.privateMode,
						publisher: this.vars.publisher,
						publisherID: this.getPublisherID(),
						publishDate: this.vars.publishDate != "" ? this.vars.publishDate : this.getPublishDate(),
						referringDomain: this.getReferringDomain(this.vars.referringURL),
						referringURL: this.vars.referringURL,
						server: this.vars.server,
						serverAMP: this.vars.serverAMP,
						siteID: this.vars.siteID,
						ssl: this.vars.protocol,
						sysEnv: this.vars.sysEnv,
						tags: this.vars.tags.length != 0 ? this.vars.tags : this.arrayTags(),
						test: this.vars.test,
						thematic: this.vars.thematic,
						translatePage: this.vars.translatePage,
						updateDate: this.vars.updateDate != "" ? this.vars.updateDate : this.getUpdateDate(),
						urlAMP: this.vars.urlAMP,
						urlParams: this.vars.urlParams,
						validPage: this.vars.validPage,
						videoContent: this.vars.videoContent
					},
					category: {
						pageType: this.vars.pageType,
						primaryCategory: this.vars.seccion,
						subCategory1: this.vars.subseccion,
						subCategory2: this.vars.subsubseccion
					}
				},
				user: {
					country: "",
					experienceCloudID: "not-set",
					name: "",
					profileID: "not-set",
					registeredUser: "not-set",
					registeredUserAMP: "",
                    subscriptions: this.vars.userSubscriptions,
                    type: "not-set"
				},
				device: {
					userAgent: navigator.userAgent,
					cookieEnabled: navigator.cookieEnabled,
					language: navigator.language,
					platform: navigator.platform,
					type: this.getDeviceType()
				},
				paywall: {
					access: this.vars.paywall.access,
					active: this.vars.paywall.active,
					contentAdType: this.vars.paywall.contentAdType,
					counter: this.vars.paywall.counter,
					signwallType: this.vars.paywall.signwallType,
					contentBlocked: this.vars.paywall.contentBlocked,
					type: this.vars.paywall.type
				},
				event: []
			};

			this.vars.urlParams = this.getUrlParams();
			this.setParam("page.pageInfo.urlParams", DTM.dataLayer.vars.urlParams);
			this.internalSearch();
			this.getPageHeight();
			this.getUserInfo();
			this.setParam("page.pageInfo.campaign", this.getCampaign());
			this.setParam("page.pageInfo.brandedContent", this.isBrandedContent());
			this.setParam("page.pageInfo.clickOrigin", DTM.utils.getQueryParam("rel"));

			DTM.notify("Data Layer generated");

			DTM.dataLayer.generated = true;
		},
		pageDL: function(){
			if(!DTM.pageDataLayer)
				return;
			//Recogemos el Data Layer desde pgina.
			var pageDataLayer = DTM.pageDataLayer;
			//Recuperamos valores
			this.vars.seccion = this.dataLayerParamExists("primaryCategory") ? pageDataLayer.primaryCategory : this.vars.seccion;
			this.vars.subseccion = this.dataLayerParamExists("subCategory1") ? pageDataLayer.subCategory1 : this.vars.subseccion;
			this.vars.subsubseccion = this.dataLayerParamExists("subCategory2") ? pageDataLayer.subCategory2 : this.vars.subsubseccion;
			this.vars.pageType = this.dataLayerParamExists("pageType") ? pageDataLayer.pageType.trim() : this.vars.pageType;
			this.vars.language = this.dataLayerParamExists("language") ? pageDataLayer.language : this.vars.language;
			this.vars.sysEnv = this.dataLayerParamExists("sysEnv") ? pageDataLayer.sysEnv : this.vars.sysEnv;
			this.vars.thematic = this.dataLayerParamExists("thematic") ? pageDataLayer.thematic : this.vars.thematic;
			this.vars.destinationURL = this.dataLayerParamExists("destinationURL") ? pageDataLayer.destinationURL : this.vars.destinationURL;
			this.vars.editionNavigation = this.dataLayerParamExists("editionNavigation") ? pageDataLayer.editionNavigation : this.vars.editionNavigation;
			this.vars.creationDate = this.dataLayerParamExists("creationDate") ? pageDataLayer.creationDate : this.vars.creationDate;
			this.vars.audioContent = this.dataLayerParamExists("audioContent") ? pageDataLayer.audioContent : this.vars.audioContent;
			this.vars.liveContent = this.dataLayerParamExists("liveContent") && typeof pageDataLayer.liveContent == "boolean" ? (pageDataLayer.liveContent === true ? "1" : "0") : (typeof DTM.config.isLiveContent != "undefined" && DTM.config.isLiveContent ? "1" : this.vars.liveContent);
			this.vars.videoContent = this.dataLayerParamExists("videoContent") ? pageDataLayer.videoContent : this.vars.videoContent;
			this.vars.pageTitle = this.dataLayerParamExists("pageTitle") ? pageDataLayer.pageTitle : this.vars.pageTitle;
			this.vars.referringURL = this.dataLayerParamExists("referringURL") ? pageDataLayer.referringURL : this.vars.referringURL;
			this.vars.siteID = this.dataLayerParamExists("siteID") ? (this.vars.siteID + "/" + pageDataLayer.siteID) : this.vars.siteID;
			this.vars.pageName = this.dataLayerParamExists("pageName") ? pageDataLayer.pageName : (this.dataLayerParamExists("siteID") ? (this.vars.siteID + this.vars.destinationURL.replace(/[\?#].*?$/g, "").replace(/http.?:\/\/[^\/]*/, "")) : this.vars.pageName);
			this.vars.tags = this.dataLayerParamExists("tags") ? pageDataLayer.tags : [];
			this.vars.author = this.dataLayerParamExists("author") ? pageDataLayer.author : [];
			this.vars.pageID = document.location.href;
			this.vars.articleID = this.dataLayerParamExists("articleID") ? pageDataLayer.articleID : (this.vars.articleID != "" ? this.vars.articleID : (this.vars.pageType == "articulo" ? DTM.utils.encoder.encode(this.vars.destinationURL.replace(/[\?#].*?$/g, "")) : ""));
			this.vars.geoRegion = this.dataLayerParamExists("geoaRegion") ? pageDataLayer.geoRegion : this.vars.geoRegion;
			this.vars.org = this.dataLayerParamExists("org") ? pageDataLayer.org : this.vars.org;
			this.vars.publisher = this.dataLayerParamExists("publisher") ? pageDataLayer.publisher : this.vars.publisher;
			this.vars.pageTypology = this.dataLayerParamExists("pageTypology") ? pageDataLayer.pageTypology : this.vars.pageTypology;
			this.vars.privateMode = this.dataLayerParamExists("privateMode") ? pageDataLayer.privateMode : this.vars.privateMode;
			this.vars.protocol = this.dataLayerParamExists("protocol") ? pageDataLayer.protocol : this.vars.protocol;
			this.vars.businessUnit = this.dataLayerParamExists("businessUnit") ? pageDataLayer.businessUnit : this.vars.businessUnit;
			this.vars.test = this.dataLayerParamExists("test") ? pageDataLayer.test : this.vars.test;
			this.vars.userSubscriptions = this.dataLayerParamExists("userSubscriptions") ? pageDataLayer.userSubscriptions : this.vars.userSubscriptions;
			this.vars.paywall = {
				access: this.dataLayerParamExists("paywallAccess") ? pageDataLayer.paywallAccess : this.vars.paywall.access,
				active: this.dataLayerParamExists("paywallActive") ? pageDataLayer.paywallActive : this.vars.paywall.active,
				contentAdType: this.dataLayerParamExists("paywallAd") ? pageDataLayer.paywallAd : this.vars.paywall.contentAdType,
				contentBlocked: this.dataLayerParamExists("paywallStatus") ? pageDataLayer.paywallStatus : this.vars.paywall.contentBlocked,
				counter: this.dataLayerParamExists("paywallCounter") ? pageDataLayer.paywallCounter : this.vars.paywall.counter,
				signwallType: this.dataLayerParamExists("signwall") ? pageDataLayer.signwall : (this.dataLayerParamExists("paywall") ? (pageDataLayer.paywall == "reg" ? "reg" : "free") : this.vars.paywall.signwallType),
				type: this.dataLayerParamExists("paywallType") ? pageDataLayer.paywallType : this.vars.paywall.type
			}
		},
		generateDL: function(){
			//Obtenemos la seccin a la que pertenece la pgina
			this.regExp.result_re4 = this.regExp.seccion.exec(this.vars.direccion);
			//Si es un subdominio, la seccin ser el subdominio
			if(this.regExp.result_re4){
				this.vars.seccion_omniture = this.regExp.result_re4[1];
				this.vars.subdomain = this.regExp.result_re4[1];
			}
			if(this.vars.seccion_omniture == 'brasil')
				this.vars.domain = "brasil.elpais.com";

			//Tratamos por seccion
			switch (this.vars.seccion_omniture) {
				//Secciones especiales
				case "cartelera":
					this.cartelera();
					break;
				case "eskup":
					this.eskup();
					break;
				case "resultados":
					this.resultados();
					break;
				case "programacion-tv":
					this.programaciontv();
					break;
				case "servicios":
					this.servicios();
					break;
				//Resto de secciones
				default:
					this.regExp.result_re = this.regExp.noticia.exec(this.vars.direccion);
					//Es un artculo
					if(this.regExp.result_re){
						this.articulo();
					}else{
						//Secciones virtuales
						this.regExp.result_re5 = this.regExp.seccionVirtual.exec(this.vars.direccion);
						if(this.regExp.result_re5) {
							this.vars.pageType = "portadilla";
							if(this.regExp.result_re5[1] == "brasil") {
								this.vars.seccion = this.regExp.result_re5[2];
								this.vars.subseccion = this.regExp.result_re5[2] + ">home";
							}else{
								this.vars.seccion = this.regExp.result_re5[1];
								this.vars.subseccion = this.regExp.result_re5[1] + ">" + this.regExp.result_re5[2] + ">home";
							}
						}else{
							//Especiales
							if(this.vars.direccion.indexOf("//elpais.com/especiales/") > -1 || this.vars.direccion.indexOf("//elpais.com/promociones/") > -1 || this.vars.direccion.indexOf("elpais.com/publi-especial/") > -1 || this.vars.direccion.indexOf("elpais.com/concursos/") > -1 || this.vars.direccion.indexOf("//www.elpais.com/especial") > -1 || this.vars.direccion.indexOf("//elpais.com/suscripciones/especiales") > -1 || this.vars.direccion.indexOf("//cat.elpais.com/especials/") > -1 || this.vars.direccion.indexOf("//brasil.elpais.com/especiais/") > -1 || this.vars.direccion.indexOf("//verne.elpais.com/especial/") > -1){
								this.regExp.result_re5 = this.regExp.especiales.exec(this.vars.direccion);
								this.especiales();
							//Diario
							}else{
								this.regExp.result_re6 = this.regExp.diario.exec(this.vars.direccion);
								if(this.regExp.result_re6){
									this.diario();
								//Portadillas
								}else{
									this.regExp.result_re2 = this.regExp.portadilla.exec(this.vars.direccion);
									if(this.regExp.result_re2) {
										this.portadillas();
									//Portada
									}else{
										this.regExp.result_re3 = this.regExp.portada.exec(this.vars.direccion);
										if(this.regExp.result_re3)
											this.regExp.result_re3[2] = this.regExp.result_re3[2].replace(/\?.*/, "");
										if(this.regExp.result_re3 && (this.regExp.result_re3[2].indexOf("index.html") == 0 || this.regExp.result_re3[2] == "")) {
											this.portada();
										}else{
											//Portadillas cincodias sin la barra final cincodias.elpais.com/smartlife
											if(this.regExp.result_re3[1] == "cincodias.elpais.com" && this.regExp.result_re3[2] != ""){
												this.vars.pageType = "portadilla";
												this.vars.seccion = "cincodias";
												this.vars.subseccion = "cincodias>" + this.regExp.result_re3[2] + ">home";
											}else{
												this.vars.seccion = "desconocido";
												this.vars.pageType = "";
												this.vars.subseccion = "desconocido" + ">" + "desconocido";
											}
										}
									}
									if (this.vars.seccion == "elpais")
										this.vars.seccion = this.vars.seccion_omniture;
								}
							}
						}
					}
			}

			//PageName en subdominios
			if(this.vars.subdomain != "" && this.vars.pageName.indexOf("elpaiscom/" + this.vars.subdomain) == -1)
				this.vars.pageName = this.vars.pageName.replace("elpaiscom", "elpaiscom/" + this.vars.subdomain);
			/*if(this.vars.direccion.indexOf("//retina.elpais.com") > -1 && this.vars.pageName.indexOf("elpaiscom/retina") == -1)
				this.vars.pageName = this.vars.pageName.replace("elpaiscom", "elpaiscom/retina");
			if(this.vars.direccion.indexOf("//cincodias.elpais.com") > -1 && this.vars.pageName.indexOf("elpaiscom/cincodias") == -1)
				this.vars.pageName = this.vars.pageName.replace("elpaiscom", "elpaiscom/cincodias");*/

			if(this.vars.seccion == "deportes")
				this.vars.thematic = "deportes";
		},
		articulo: function(){
			this.vars.seccion = this.regExp.result_re[2];
			this.vars.seccion_omniture = this.regExp.result_re[2];
			this.vars.subseccion_omniture = this.regExp.result_re[6];
			this.vars.tituloarticulo = true;
			this.vars.creationDate = this.regExp.result_re[3] + "/" + this.regExp.result_re[4] + "/" + this.regExp.result_re[5];

			//Albumes y videos tratamos distinto
			if (this.vars.subseccion_omniture.indexOf("album") > -1 || this.vars.subseccion_omniture == "fotorrelato" || this.vars.subseccion_omniture == "videos" || this.vars.subseccion_omniture == "media") {
				var generica = (this.vars.subseccion_omniture == "videos") ? "videos" : (this.vars.subseccion_omniture == "media" ? "media" : "fotografia");
				this.vars.pageType = (this.vars.subseccion_omniture == "videos" || this.vars.subseccion_omniture == "media") ? "articulo" : "fotogaleria";

				if(typeof(window.subseccion_publi) != "undefined" && window.subseccion_publi != "") {
					if(this.vars.seccion_omniture == "elpais") {
						if(window.subseccion_publi.indexOf("|") == -1) {
							this.vars.seccion = window.subseccion_publi;
							this.vars.subseccion = this.vars.seccion + ">" + generica;
						}else{
							var ps = subseccion_publi.split("|");
							this.vars.seccion = ps[0];
							this.vars.subseccion = ps[0] + ">" + ps[1] + ">" + generica;
						}
					}else{
						this.vars.seccion = this.vars.seccion_omniture;
						if(subseccion_publi == "smartlife" || subseccion_publi == "tpymes"){
							this.vars.subseccion = this.vars.seccion_omniture + ">" + (subseccion_publi == "tpymes" ? "territorio_pyme" : subseccion_publi);
							this.vars.subsubseccion = this.vars.subseccion + ">" + generica;
						}else{
							this.vars.subseccion = this.vars.seccion_omniture + ">" + generica;
						}
					}
				}else{
					this.vars.seccion = (this.vars.seccion_omniture == "elpais") ? generica : this.vars.seccion_omniture;
					this.vars.subseccion = generica;
				}
			//Articulos corrientes
			}else{
				this.vars.pageType = "articulo";
				//blogs
				if(typeof(window.PEPtipologia) != "undefined" && window.PEPtipologia == "blogs") {
					this.vars.seccion = "blogs";
					this.vars.subseccion = "blogs>" + this.vars.subseccion_omniture;
				//resto
				}else{
					if(this.vars.seccion_omniture == "elpais" || this.vars.seccion_omniture == "brasil") {
						this.vars.seccion_omniture = this.vars.subseccion_omniture;
						this.vars.subseccion_omniture = "";
						this.vars.subseccion = this.vars.seccion_omniture;
					}else{
						if(this.vars.direccion.indexOf("cincodias.elpais.com") > -1) {
							switch(this.vars.subseccion_omniture) {
								case "smartphones":
								case "tablets":
								case "smarttv":
								case "gadgets":
								case "pymes":
								case "motor":
								case "lifestyle":
									this.vars.subsubseccion = this.vars.seccion_omniture + ">smartlife>" + this.vars.subseccion_omniture;
									this.vars.subseccion_omniture = "smartlife";
									break;
								case "autonomos":
								case "pyme":
								case "emprendedores":
								case "franquicias":
								case "guias_pymes":
								case "financiacion":
									this.vars.subsubseccion = this.vars.seccion_omniture + ">territorio_pyme>" + this.vars.subseccion_omniture;
									this.vars.subseccion_omniture = "territorio_pyme";
									break;
								default:
							}
						}
						this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
					}
				}

				if(this.vars.seccion == "elpais" || this.vars.seccion == "brasil")
					this.vars.seccion = this.vars.seccion_omniture;
			}

			//Id del articulo
			this.vars.articleID = this.regExp.result_re[7];
			DTM.events.vars.trackLinks = "1";
		},
		cartelera: function(){
			this.vars.pageName = this.vars.pageName.replace("elpaiscom", "elpaiscom/servicios/cartelera")
			this.vars.pageType = "servicios";
			if(this.vars.pageTitle.indexOf("pgina no encontrada") != -1){
				this.vars.seccion = "error-404";
				this.vars.subseccion = "error-404>cartelera";
			}else{
				this.vars.seccion = "servicios";
				this.vars.subseccion = "servicios>cartelera";
			}
		},
		diario: function(){
			this.vars.seccion = "diario";
			this.vars.seccion_omniture = "diario";
			this.vars.pageType = "portadilla";

			if(this.regExp.result_re6[5] == "")
				this.vars.subseccion_omniture = "primera";
			else
				this.vars.subseccion_omniture = this.regExp.result_re6[5];

			this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
		},
		eskup: function(){
			this.vars.seccion = "eskup";
			this.vars.pageName = this.vars.pageName.replace("elpaiscom", "elpaiscom/eskup");

			if(this.vars.pageName.indexOf("404.html") != -1){
				this.vars.pageType = "eskup";
				this.vars.seccion = "error-404";
				this.vars.subseccion = "error-404>eskup";
			}else{
				this.regExp.result_re3 = this.regExp.portada.exec(this.vars.direccion);
				if(this.regExp.result_re3) {
					if(this.regExp.result_re3[2].indexOf("*") == 0) {
						this.vars.pageType = "eskup";
						this.vars.subseccion_omniture = this.regExp.result_re3[2].substr(1);
						this.vars.subseccion = this.vars.seccion_omniture + ">temas";
					}else{
						if(this.regExp.result_re3[2].indexOf("-") > -1) {
							this.vars.pageType = "eskup";
							this.vars.subseccion = this.vars.seccion_omniture + ">enlaces";
						}else{
							if(this.regExp.result_re3[2].indexOf(".html") == -1 && this.regExp.result_re3[2].indexOf(".pl") == -1) {
								this.vars.pageType = "eskup";
								this.vars.subseccion_omniture = this.regExp.result_re3[2].replace(/\/.*/, "");
								this.vars.subseccion = this.vars.seccion_omniture + ">usuarios";
							}else{
								if(this.vars.direccion == "http://eskup.elpais.com/index.html" || this.vars.direccion == "https://eskup.elpais.com/index.html") {
									this.vars.pageType = "eskup";
									this.vars.subseccion = this.vars.seccion_omniture + ">home";
								}else{
									if(this.vars.direccion == "http://eskup.elpais.com/todos.html" || this.vars.direccion == "https://eskup.elpais.com/todos.html") {
										this.vars.pageType = "eskup";
										this.vars.subseccion_omniture = "todos";
										this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
									}else{
										this.vars.pageType = "eskup";
										this.vars.subseccion_omniture = "desconocido";
										this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
									}
								}
							}
						}
					}
				}
			}
		},
		especiales: function(){
			if(this.regExp.result_re5) {
				if(this.vars.direccion.indexOf("//cat.elpais.com/especials/") > -1) {
					this.vars.seccion = "cat";
					this.vars.seccion_omniture = "especiales";
				}else{
					this.vars.seccion = this.regExp.result_re5[1];
					this.vars.seccion_omniture = this.regExp.result_re5[1];
				}
				this.vars.subseccion = this.vars.seccion_omniture + ">" + this.regExp.result_re5[3] + "_" + this.regExp.result_re5[2];
				this.vars.pageType = "especiales";
			}else{
				this.regExp.result_re6 = this.regExp.especialesPortadas.exec(this.vars.direccion);
				if(this.regExp.result_re6) {
					if(this.vars.direccion.indexOf("//cat.elpais.com/especials/") > -1) {
						this.vars.seccion = "cat";
						this.vars.seccion_omniture = "especiales";
					}else{
						this.vars.seccion = this.regExp.result_re6[2];
						this.vars.seccion_omniture = this.regExp.result_re6[2];
					}
					this.vars.subseccion = this.vars.seccion_omniture + ">" + this.regExp.result_re6[3];
					this.vars.pageType = "portadilla";
				}else{
					if (this.vars.direccion == "http://elpais.com/especiales/" || this.vars.direccion == "https://elpais.com/especiales/"){
						this.vars.seccion = "especiales";
						this.vars.seccion_omniture = "especiales";
						this.vars.subseccion = this.vars.seccion_omniture + ">home";
						this.vars.pageType = "portadilla";
					}else{
						if(this.vars.direccion == "http://elpais.com/promociones/" || this.vars.direccion == "https://elpais.com/promociones/"){
							this.vars.seccion = "promociones";
							this.vars.seccion_omniture = "promociones";
							this.vars.subseccion = this.vars.seccion_omniture + ">home";
							this.vars.pageType = "portadilla";
						}else{
							this.vars.seccion = "especiales";
							this.vars.seccion_omniture = "especiales";
							this.vars.subseccion = this.vars.seccion_omniture + ">desconocido";
							this.vars.pageType = "";
						}
					}
				}
			}
			if (this.vars.direccion.indexOf("//verne.elpais.com/especial/") > -1) {
				this.vars.seccion = "verne";
				this.vars.seccion_omniture = "verne";
				this.vars.subseccion = "verne>" + this.vars.subseccion;
			}
		},
		multidistribution:{
			init: function(){
				this.amp();
				this.ia();
				this.mobileWeb();
				this.widget();
			},
			amp: function(){
				if(typeof DTM.config.isAMP != "undefined" && DTM.config.isAMP === true){

					var _queryParams = {
						"pageURL": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("pageURL", location.href)),
						"server": DTM.utils.getQueryParam("server", location.href),
						"ampdocHostname": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("ampdocHostname", location.href)),
						"ampdocUrl": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("ampdocUrl", location.href)),
						"referringURL": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("r", location.href)),
						"pageTitle": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("pageTitle", location.href)),
						"articleTitle": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("articleTitle", location.href)),
						"pageTypology": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("pageTypology", location.href)),
						"tags": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("tags", location.href)),
						"tagsNames": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("tagsNames", location.href)),
						"authors": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("authors", location.href)),
						"authorsNames": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("authorsNames", location.href)),
						"subseccion_publi": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("subseccion_publi", location.href)),
						"tipologia": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("tipologia", location.href)),
						"omniture_info": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("omniture_info", location.href)),
						"pageDataLayer": DTM.utils.decodeURIComponent(DTM.utils.getQueryParam("pageDataLayer", location.href))
					}

					DTM.dataLayer.vars.sysEnv = "amp";
					DTM.dataLayer.vars.platform = DTM.PLATFORM.AMP;
					DTM.dataLayer.vars.canonicalURL = _queryParams.pageURL != "" ? _queryParams.pageURL : document.location.href;
					DTM.dataLayer.vars.destinationURL = _queryParams.pageURL != "" ? _queryParams.pageURL : document.location.href;
					DTM.dataLayer.vars.direccion = _queryParams.pageURL != "" ? _queryParams.pageURL.replace(/[\?#].*?$/g, "") : document.location.href.replace(/[\?#].*?$/g, "");
					DTM.dataLayer.vars.pageName = DTM.dataLayer.vars.siteID + DTM.dataLayer.vars.direccion.replace(/http.?:\/\/[^\/]*/, "");
					DTM.dataLayer.vars.server = _queryParams.server ? _queryParams.server : window.location.host;
					DTM.dataLayer.vars.serverAMP = _queryParams.ampdocHostname != "" ? _queryParams.ampdocHostname : "";
					DTM.dataLayer.vars.urlAMP = _queryParams.ampdocUrl != "" ? _queryParams.ampdocUrl : "";
					DTM.dataLayer.vars.referringURL = _queryParams.referringURL != "" ? _queryParams.referringURL : document.referrer;
					DTM.dataLayer.vars.pageTitle = _queryParams.pageTitle != "" ? _queryParams.pageTitle : "";
					DTM.dataLayer.vars.articleTitle = _queryParams.articleTitle != "" ? _queryParams.articleTitle : DTM.dataLayer.vars.pageTitle;
					DTM.dataLayer.vars.articleLength = _queryParams.articleLength != "" ? _queryParams.articleLength : "not-set";
					DTM.dataLayer.vars.pageTypology = _queryParams.pageTypology != "" ? _queryParams.pageTypology : "";
					DTM.dataLayer.vars.publishDate = _queryParams.publishDate != "" ? _queryParams.publishDate : "not-set";
					DTM.dataLayer.vars.updateDate = _queryParams.updateDate != "" ? _queryParams.updateDate : "not-set";
					window.listado_id_tags = _queryParams.tags != "" ? _queryParams.tags : undefined;
					window.listado_norm_tags = _queryParams.tagsNames != "" ? _queryParams.tagsNames : undefined;
					window.listado_id_autores = _queryParams.authors != "" ? _queryParams.authors : undefined;
					window.listado_norm_autores = _queryParams.authorsNames != "" ? _queryParams.authorsNames : undefined;
					window.subseccion_publi = _queryParams.subseccion_publi != "" ? _queryParams.subseccion_publi : undefined;
					window.PEPtipologia = _queryParams.tipologia != "" ? _queryParams.tipologia : undefined;
					window.omniture_info = _queryParams.omniture_info != "" ? JSON.parse(_queryParams.omniture_info.replace(/\'/g,"\"")) : undefined;
					//Paywall info y userInfo se cargan tras userInfoAMP
					DTM.pageDataLayer = _queryParams.pageDataLayer ? JSON.parse(_queryParams.pageDataLayer.replace(/\'/g,"\"")) : undefined;
				}
			},
			ia: function(){
				if(typeof window.ia_document != "undefined"){
					DTM.dataLayer.vars.referringURL = typeof window.ia_document.referrer != "undefined" ? (window.ia_document.referrer.indexOf("https://") == -1 ? "https://" + window.ia_document.referrer : window.ia_document.referrer) : "https://www.facebook.com/";
					DTM.dataLayer.vars.sysEnv = "fbia";
					DTM.dataLayer.vars.platform = DTM.PLATFORM.FBIA;
					DTM.dataLayer.vars.pageTitle = window.ia_document.title;
					DTM.dataLayer.vars.canonicalURL = DTM.dataLayer.vars.direccion;
					DTM.dataLayer.vars.articleLength = typeof window.articleLength != "undefined" ? window.articleLength : "not-set";
					DTM.dataLayer.vars.articleTitle = typeof window.ptitulo != "undefined" ? window.ptitulo : window.ia_document.title;
					DTM.dataLayer.vars.updateDate = typeof window.updateDate != "undefined" ? window.updateDate : "not-set";
					DTM.dataLayer.vars.publishDate = typeof window.publishDate != "undefined" ? window.publishDate : "not-set";
				}
			},
			mobileWeb: function(){
				DTM.dataLayer.regExp.result_re = DTM.dataLayer.regExp.moviles.exec(DTM.dataLayer.vars.direccion);
				if(DTM.dataLayer.regExp.result_re) {
					DTM.dataLayer.vars.sysEnv = "web_movil";
					DTM.dataLayer.vars.platform = DTM.PLATFORM.MOBILEWEB;
					DTM.dataLayer.vars.direccion = DTM.dataLayer.regExp.result_re[1] + "/" + DTM.dataLayer.regExp.result_re[2];
				}	
			},
			widget: function(){
				if(typeof DTM.config.isWidget != "undefined"){
					 if(DTM.config.isWidget)
						DTM.dataLayer.vars.platform = DTM.PLATFORM.WIDGET;
				}else if(document.location.href.indexOf("/Comentarios/") > -1 || document.location.href.indexOf("/widgets/") > -1 || document.location.href.indexOf("/Widgets/") > -1 || document.location.href.indexOf("widget.html") > -1)
					DTM.dataLayer.vars.platform = DTM.PLATFORM.WIDGET;
			}
		},
		portada: function(){
			this.vars.pageType = "portadilla";
			this.vars.seccion_omniture = this.regExp.result_re3[1].replace(/elpais\.com/, "");
			if(this.vars.seccion_omniture == "" || this.regExp.result_re3[1] == "brasil.elpais.com") {
				this.vars.subseccion = "home";
				this.vars.seccion = "home";
			}else{
				this.vars.seccion = this.vars.seccion_omniture.substring(0, this.vars.seccion_omniture.length - 1);
				this.vars.subseccion = this.vars.seccion + ">home";
				this.vars.pageName = "elpaiscom/" + this.vars.seccion;
				if(this.vars.seccion == "cat")
					this.vars.pageType = "portada";
			}
		},
		portadillas: function(){
			this.vars.seccion = this.regExp.result_re2[2];
			this.vars.seccion_omniture = this.regExp.result_re2[2];

			if(this.regExp.result_re2[3].indexOf("index.html") == 0 || this.regExp.result_re2[3] == ""){
				if(this.vars.direccion.indexOf("//cincodias.elpais.com") > -1){
					this.vars.seccion = "cincodias";
					this.vars.subseccion = "cincodias>" + this.vars.seccion_omniture + ">home";
				}else if(this.vars.server == "verne.elpais.com" && this.vars.seccion == "mx"){
					this.vars.seccion = "verne";
					this.vars.subseccion = "verne>mexico>home";
					this.vars.pageName = this.vars.pageName.replace(/elpaiscom/, "elpaiscom/verne");
				}else
					this.vars.subseccion = this.vars.seccion_omniture + ">home";

				this.vars.pageType = "portadilla";
				if(this.regExp.result_re2[2] == "buscador")
					this.vars.search = "1";
			}else{
				if(this.regExp.result_re2[3].indexOf("/") == -1){
					this.vars.subseccion_omniture = this.regExp.result_re2[3].replace(/\.html.*/, "");
					this.vars.pageType = "portadilla";
					if(this.vars.direccion.indexOf("//cincodias.elpais.com") > -1){
						this.vars.seccion = "cincodias";
						this.vars.subseccion = "cincodias>" + this.regExp.result_re2[2] + ">home";
					}else{
						if(this.vars.seccion_omniture == "elpais"){
							this.vars.seccion_omniture = this.vars.subseccion_omniture;
							this.vars.subseccion_omniture = "";
						}
						this.vars.subseccion = this.vars.subseccion_omniture != "" ? this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture : this.vars.seccion_omniture + ">home";
					}
				}else{
					//Tags
					if(this.regExp.result_re2[2] == "tag" || this.regExp.result_re2[2] == "autor" || this.regExp.result_re2[2] == "agr" || this.regExp.result_re2[2] == "r") {
						if(this.regExp.result_re2[3].indexOf("listado") == 0) {
							this.vars.pageType = "tag";
							this.vars.subseccion = "tag>listado";
						}else{
							//Portadillas de blogs
							if(typeof(window.PEPtipologia) != "undefined" && window.PEPtipologia == "blogs"){
								this.vars.seccion = "blogs";
								this.vars.pageType = "portadilla";
								this.vars.subseccion = "blogs>" + this.regExp.result_re2[3].replace(/\/\w\/?.*?$/, "");
							}else{
								var resto_url = this.regExp.result_re2[3];
								if(this.regExp.result_re2[2] == "r"){
									this.regExp.result_re7 = this.regExp.tagRamas.exec(resto_url);
									if(this.regExp.result_re7) {
										this.vars.seccion = this.regExp.result_re7[1];
										resto_url = resto_url.replace(this.regExp.result_re7[1] + "/" + this.regExp.result_re7[2] + "/", "");
										this.regExp.result_re2[2] = this.regExp.result_re7[2];
										resto_url = resto_url.replace(/\/$/, "");
									}
								}

								this.regExp.result_re6 = this.regExp.tag.exec(resto_url);
								this.vars.subseccion_omniture = (this.regExp.result_re6) ? (this.regExp.result_re6[1] + "_" + this.regExp.result_re6[2]) : resto_url;

								if(this.regExp.result_re2[1] == "elviajero.elpais.com" || this.regExp.result_re2[1] == "elcomidista.elpais.com") {
									this.vars.seccion = this.regExp.result_re2[1].replace(".elpais.com", "");
									this.vars.subseccion = this.vars.seccion + ">" + this.regExp.result_re2[2] + ">" + this.vars.subseccion_omniture;
								}else{
									if(this.regExp.result_re7)
										this.vars.subseccion = this.vars.seccion + ">" + this.regExp.result_re2[2] + ">" + this.vars.subseccion_omniture;
									else
										this.vars.subseccion = this.regExp.result_re2[2] + ">" + this.vars.subseccion_omniture;
								}
								this.vars.pageType = "tag";
							}
						}
					}else{
						if(this.regExp.result_re2[3].indexOf("/") > -1 && (this.vars.direccion.indexOf("//cincodias.elpais.com") > -1)){
							this.vars.seccion = "cincodias";
							this.vars.pageType = "portadilla";
							this.vars.subseccion = this.vars.seccion + ">" + this.regExp.result_re2[2];
							//Calculadoras Cincodias
							if(this.regExp.result_re2[2] == "herramientas" && (typeof this.regExp.result_re2[3] != "undefined") && (this.regExp.result_re2[3] != "") && (this.regExp.result_re2[3] != "/"))
								this.vars.articleID = DTM.utils.encoder.encode(this.vars.direccion);
						}else if(this.regExp.result_re2[2] == "elviajero" && this.regExp.result_re2[3].indexOf("destinos/") > -1){
							this.vars.seccion = "elviajero";
							this.vars.pageType = "portadilla"
							this.vars.subseccion = "elviajero>destinos";
						}else if(this.regExp.result_re2[2] == "hemeroteca"){
							this.vars.seccion = "hemeroteca";
							this.vars.subseccion = "hemeroteca";
							this.vars.pageType = "hemeroteca";
							var result_hemeroteca = /([^\/]*)\/((portadas)(\/))?(\d+)\/(.*)/.exec(this.regExp.result_re2[3]);
							if(result_hemeroteca){
								this.vars.subseccion = "hemeroteca>" + result_hemeroteca[5];
								this.vars.subsubseccion = this.vars.subseccion + ">" + result_hemeroteca[1];
							}
						}else{
							this.vars.pageType = ""
							this.vars.subseccion = this.vars.seccion_omniture + ">" + "desconocido";
						}
					}
				}
			}
		},
		programaciontv: function(){
			this.vars.pageName = this.vars.pageName.replace("elpaiscom", "elpaiscom/servicios/programacion-tv")
			this.vars.seccion = "servicios";
			this.vars.pageType = "servicios";
			this.vars.subseccion = "servicios>programacion-tv";
		},
		resultados: function(){
			this.vars.seccion = "resultados";
			this.vars.pageName = this.vars.pageName.replace("elpaiscom", "elpaiscom/resultados");
			this.vars.pageType = "resultados";
			this.regExp.result_re = this.regExp.elecciones.exec(this.vars.direccion);

			if(this.regExp.result_re) {
				this.vars.seccion_omniture = "elecciones";
				this.vars.subseccion_omniture = this.regExp.result_re[3] + "_" + this.regExp.result_re[2];
				this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
			}else{
				this.regExp.result_re2 = this.regExp.eleccionesPortadas.exec(this.vars.direccion)
				if(this.regExp.result_re2){
					this.vars.seccion_omniture = "elecciones";
					this.vars.subseccion_omniture = this.regExp.result_re2[2];
					this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
				}else{
					this.regExp.result_re3 = this.regExp.eleccionesHome.exec(this.vars.direccion)
					if(this.regExp.result_re3) {
						this.vars.seccion_omniture = "elecciones";
						this.vars.subseccion_omniture = this.regExp.result_re3[2];
						this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
						this.vars.subsubseccion = this.vars.subseccion + ">home";
					}else{
						var dtm_reg_n3 = /^http.?:\/\/[^\/]*\/([^\/]+)\/([^\/]+)\//i;
						this.regExp.result_re4 = dtm_reg_n3.exec(this.vars.direccion);
						if (this.regExp.result_re4) {
							this.vars.seccion_omniture = this.regExp.result_re4[1];
							this.vars.subseccion_omniture = this.regExp.result_re4[2];
							this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
						}else{
							this.vars.subseccion_omniture = "desconocido";
							this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
						}
					}
				}
			}
		},
		servicios: function(){
			this.vars.seccion = "servicios";
			this.vars.pageName = this.vars.pageName.replace("elpaiscom", "elpaiscom/servicios");
			this.regExp.result_re = this.regExp.portadilla.exec(this.vars.direccion);
			this.vars.pageType = "servicios";

			if(this.regExp.result_re) {
				this.vars.subseccion = this.vars.seccion_omniture + ">" + this.regExp.result_re[2];
				if(this.regExp.result_re[2] == "diccionarios" && this.regExp.result_re[3] != "" && this.regExp.result_re[3] != "index.html"){
					this.vars.pageName = "elpaiscom/servicios/diccionarios/buscador";
					this.vars.search = "1";
					this.vars.search_keyword = "diccionario:" + this.regExp.result_re[3].replace(/\//, ">");
				}else{
					if(this.regExp.result_re[2] == "sorteos" && this.regExp.result_re[3] != "" && this.regExp.result_re[3] != "index.html"){
						this.regExp.resultSo = this.regExp.sorteos.exec(this.regExp.result_re[3]);
						if(this.regExp.resultSo)
							this.vars.subseccion += ">" + this.regExp.resultSo[1];
					}
				}
			}else{
				if(this.vars.direccion == "http://servicios.elpais.com/" || this.vars.direccion == "https://servicios.elpais.com/"){
					this.vars.subseccion = this.vars.seccion_omniture + ">" + "home";
				}else{
					this.vars.pageType = "";
					this.vars.subseccion_omniture = "desconocido";
					this.vars.subseccion = this.vars.seccion_omniture + ">" + this.vars.subseccion_omniture;
				}
			}
		},
		arrayTags: function(){
			if (typeof(listado_norm_tags) == "undefined" || typeof(listado_id_tags) == "undefined")
				return [];

			var salida = [];
			var itags = listado_id_tags.split(",");
			var ntags = listado_norm_tags.split(",")
			if (itags.length != ntags.length)
				return [];

			for (var j = 0; j < itags.length; j++)
				salida.push({
					"id": itags[j],
					"name": ntags[j]
				});
			return salida;
		},
		arrayAuthors: function(){
			if(typeof(listado_norm_autores) == "undefined" || typeof(listado_id_autores) == "undefined")
				return [];

			var salida = [];
			var iauthor = listado_id_autores.split(",");
			var nauthor = listado_norm_autores.split(",");

			//Si no se corresponden los IDs y los nombres, retornamos
			if(iauthor.length != nauthor.length)
				return [];

			//Firmas
			var sauthor = typeof listado_nombre_autores != "undefined" && listado_nombre_autores.length > 0 ? listado_nombre_autores.split(",") : [];
			//Si no nos pasan las firmas las intentamos sacar del meta name = author
			if(sauthor.length == 0){
				//Leemos el meta
				var meta_author = DTM.utils.getMetas("name", "author");
				//Si est el meta tiene prioridad
				if(meta_author.length > 0)
					sauthor = meta_author[0].replace(/, /gi, ",").split(",");
			}

			for(var i = 0, j = iauthor.length ; i < j; i++) {
				salida.push({
					"id": iauthor[i],
					"name": nauthor[i],
					"sign": typeof sauthor[i] != "undefined" ? sauthor[i] : ""
				});
			}

			return salida;
		},
		dataLayerParamExists: function(param){
			if(typeof DTM == "undefined" || typeof DTM.pageDataLayer == "undefined")
				return false;
			return (typeof DTM.pageDataLayer[param] != "undefined" || (typeof DTM.pageDataLayer[param] == "string" && DTM.pageDataLayer[param] == ""))
		},
		/**
		* Funcin para el clculo del parmetro campaign del digitalData. Se calcula a travs de parmetros de la URL. Se buscan una serie de parmetros concretos "trackingCodes".
		* Se mantiene soporte para los parmetros antiguos (obsoletos). Los parmetros actuales esperados son: 'sdi', 'sse', 'sma', 'prm', 'sap', 'ssm', 'afl', 'agr', 'int', 'noti', 'idexterno'
		* La comprobacin es secuencial, si existiesen varios de los trackingCodes en la URL ganara el ltimo comprobado
		* Para el parmetro de RRSS "ssm" o "id_externo_rsoc" se hace comprobacin de un segundo parmetro "ads". Si viniesen los dos, su valor se concatena mediante "-" y se devuelve.
		* Para el parmetro de promociones "prm", se hace comprobacin de un segundo parmetro "csl" usado para Crosslinking. Si viniesen los dos, su valor se concatena mediante "_" y se devuelve.
		* El parmetro cid viene codificado en base64, debemos decodificarlo con el encoder antes de devolver el valor.
		* @return string parmetro campaign generado
		*/
		getCampaign: function(){
			var campaign = "";
			var key_tc = "";
			var url = "";
			var trackingCodes = ['id_externo_display', 'id_externo_sem', 'id_externo_nwl', 'id_externo_promo', 'id_externo_rsoc','id_externo_ref', 'id_externo_portada', 'id_externo_noti', 'sdi', 'sse', 'sma', 'prm', 'sap', 'ssm', 'afl', 'agr', 'int', 'noti', 'idexterno', 'cid'];

			//Multidistribution
			if(_satellite.getVar("platform") == DTM.PLATFORM.AMP){
				var _ampDocUrl = DTM.utils.getQueryParam("ampdocUrl", location.href);
				if(_ampDocUrl != "")
					url = _ampDocUrl;
			}else if(_satellite.getVar("platform") == DTM.PLATFORM.FBIA){
				if(typeof ia_document != "undefined" && typeof ia_document.shareURL != "undefined")
					url = ia_document.shareURL;
			}

			for(var i = 0, j = trackingCodes.length; i < j; i++){
				var trackingCode = DTM.utils.getQueryParam(trackingCodes[i], url);
				if(trackingCode != ""){
					campaign = trackingCode;
					key_tc = trackingCodes[i];
				}
			}

			//Si es rsoc buscamos id_externo_ads y lo concatenamos
			if(key_tc == "id_externo_rsoc" || key_tc == "ssm"){
				var tc_ads = DTM.utils.getQueryParam("id_externo_ads");
				tc_ads = tc_ads == "" ? DTM.utils.getQueryParam("ads") : tc_ads;
				campaign = tc_ads != "" ? (campaign + "-" + tc_ads) : campaign;
			//Si es prm buscamos obr para los enlaces de Outbrain
			}else if(key_tc == "prm"){
				var tc_csl = DTM.utils.getQueryParam("csl");
				campaign = tc_csl != "" ? (campaign + "_" + tc_csl) : campaign;
			//Si es el codificado "cid" lo decodificamos	
			}else if(key_tc == "cid"){
				campaign = DTM.utils.encoder.decode(DTM.utils.decodeURIComponent(campaign));
			}

			return campaign;
		},
		/** 
		* Mtodo para el autocalculo del parmetro articleTitle del digitalData
		* Se calcula a travs de meta og:title, si tampoco lo recogemos devolvemos el ttulo completo
		* Solo lo calculamos en artculos (pageType = articulo)
		* @return ttulo de artculo, vaco en caso de no estar en un artculo
		*/ 
		getArticleTitle: function(){

			//Solo lo devolvemos en artculos
			if(this.vars.pageType != "articulo")
				return "";

			//Lo recogemos desde meta og:title
			var metaTitle = DTM.utils.getMetas("property", "og:title");
		    
		    return metaTitle != "" ? metaTitle[0] : this.vars.pageTitle;
		},
		/** 
		* Mtodo para el autocalculo del parmetro updateDate del digitalData
		* Se calcula a travs de meta article:published_time
		* Solo lo calculamos en artculos (pageType = articulo) o galeras (pageType = fotogaleria)
		* @return ttulo de artculo, vaco en caso de no estar en un artculo
		*/ 
		getPublishDate: function(){

			//Solo lo devolvemos en artculos y galeras
			if(this.vars.pageType != "articulo" && this.vars.pageType != "fotogaleria")
				return "";

			//Lo recogemos desde meta og:title
			var publishDate = "not-set";
			var metaPublishDate = DTM.utils.getMetas("property", "article:published_time");

			if(metaPublishDate != ""){
				publishDate = new Date(metaPublishDate[0]);
				publishDate = publishDate.getFullYear() + "/" + DTM.utils.formatDate(publishDate.getMonth() + 1) + "/" + DTM.utils.formatDate(publishDate.getDate());
			}
		    
		    return publishDate;
		},
		/**
	     * Funcin que devuelve el publisherID dependiendo del server o seccin
	     * @return publisherID string con el ID para el server actual
	     **/
		getPublisherID: function(){

			var publisherID = "";

			if(this.vars.platform == DTM.PLATFORM.WEB || this.vars.platform == DTM.PLATFORM.AMP){
				
				publisherID = "Elpais";
				var gfk_platform = this.vars.platform == DTM.PLATFORM.WEB ? "Web" : "Amp";

				//Server elpais.com
				if(_satellite.getVar("server") == "elpais.com"){
					//Productos diferentes al producto CORE
					let products = {
						"deportes": "Elpaisdeportes",
						"tecnologia": "Elpaistecnologia",
						"icon": "Elpaisicon",
						"icon_design": "Elpaisdeportes"
					};

					//Si es una de las secciones con producto propio le damos su valor, en caso contrario el product CORE
					publisherID = products && products.hasOwnProperty(this.vars.seccion) ? products[this.vars.seccion] : "Elpais";

				//Subdominios con producto propio
				}else{
					let products = {
						"cartelera.elpais.com": "Elpaiscartelera",
						"cincodias.elpais.com": "Cincodiaselpais",
						"fondosyplanes.cincodias.elpais.com": "Cincodiaselpais",
						"elcomidista.elpais.com": "Elcomidistaelpais",
						"elviajero.elpais.com": "Elviajeroelpais",
						"programacion-tv.elpais.com": "Elpaisprogramaciontv",
						"smoda.elpais.com": "Smodaelpais",
						"retina.elpais.com": "Elpaisretina"
					}

					//Si es una de los subdominios con producto propio le damos su valor, en caso contrario el product CORE
					publisherID = products && products.hasOwnProperty(this.vars.server) ? products[this.vars.server] : "Elpais";
					publisherID += gfk_platform;
				}
			}

			return publisherID;
		},
		/** 
		* Mtodo para el autocalculo del parmetro updateDate del digitalData
		* Se calcula a travs de meta og:updated_time
		* Solo lo calculamos en artculos (pageType = articulo) o galeras (pageType = fotogaleria)
		* @return ttulo de artculo, vaco en caso de no estar en un artculo
		*/ 
		getUpdateDate: function(){

			//Solo lo devolvemos en artculos y galeras
			if(this.vars.pageType != "articulo" && this.vars.pageType != "fotogaleria")
				return "";

			//Lo recogemos desde meta og:title
			var updateDate = "not-set";
			var metaUpdateDate = DTM.utils.getMetas("property", "og:updated_time");

			if(metaUpdateDate != ""){
				updateDate = new Date(metaUpdateDate[0]);
				updateDate = updateDate.getFullYear() + "/" + DTM.utils.formatDate(updateDate.getMonth() + 1) + "/" + DTM.utils.formatDate(updateDate.getDate());
			}
		    
		    return updateDate;
		},
		/** 
		* Mtodo para el autocalculo del parmetro pageHeight del digitalData
		* Se calcula a travs del document.body.scrollHeight, con lo que es necesario que Launch est en el body
		* Solo lo calculamos en canal web, con un timeout de 400 ms para dar tiempo a cargar el body
		* @return ID de artculo extrado de la URL en caso de artculo PEP, cadena vaca en caso contrario
		*/ 
		getPageHeight: function(){
			//Lo recogemos de document.body.scrollHeight solo para canal web, not-set por defecto
			setTimeout(function(){
				var pageHeight = _satellite.getVar("platform") == DTM.PLATFORM.WEB && typeof document.body != "undefined" && typeof document.body.clientHeight != "undefined" ? document.body.clientHeight : "not-set";
				DTM.dataLayer.setParam("page.pageInfo.pageHeight", pageHeight);
			}, 400);			
		},
		/**
		 * Funcin para extraer el domain del referrer (URL) pasado por parmetro
		 * @param ref URL de referrer pasada por parmetro, si no se pasa se calcula desde document.referrer
		 * @return string con el host del referrer pasado o cadena vaca en caso de referrer incorrecto o vaco 
		 */
		getReferringDomain: function(ref){
			//Si no lo pasan 
			ref = typeof ref == "string" ? ref : (typeof document.referrer == "string" ? document.referrer : "");

			//Si la URL pasada es incorrecta o es un referrer vaco devolvemos false
			if(ref == "")
				return "";

			//En caso contrario lo calculamos usando la clase URL
			try{
			    ref = (new URL(ref)).hostname;
			}catch(e){
				DTM.notify("Error al recuperar el referringDomain" + e, "error"); 
			}

			return ref;
		},
		getCanonical: function(){
			var canonical = "";
			if(typeof document != "undefined" && typeof document.querySelector == "function"){
				canonical = document.querySelector("link[rel='canonical']");
				canonical = canonical != null ? canonical.href : "";
			}else{
				var links = document.getElementsByTagName("link");
				for(var i = 0, j = links.length; (i < j && canonical == ""); i++){
					if (links[i].getAttribute("rel") === "canonical")
						canonical = links[i].getAttribute("href")
				}
			}
			return canonical;
		},
		getCMS: function(server){
			if(typeof server == "undefined" || server == "")
				return "not-set";
				
			var cmss = {"elpais.com":"pep","brasil.elpais.com":"pep","cincodias.elpais.com":"pep","verne.elpais.com":"pep","elcomidista.elpais.com":"pep","elviajero.elpais.com":"pep","retina.elpais.com":"pep","cat.elpais.com":"pep","resultados.elpais.com":"pep","smoda.elpais.com":"wp","motor.elpais.com":"wp","fichasyprecios.motor.elpais.com":"wp","servicios.motor.elpais.com":"wp","chinawatch.elpais.com":"wp","juegos.elpais.com":"wp","escuela.elpais.com":"wp"};
			return cmss.hasOwnProperty(server) ? cmss[server] : "otros";	
		},
		/**
		* Functin que calcula el tipo de dispositivo a travs del userAgent
		*/
		getDeviceType: function(){
			var ua = navigator.userAgent;

			//Tablet
			if(/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua))
			  return "tablet";
			
			//Mobile
			if(/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua))
			  return "mobile";

			//Desktop
			return "desktop";
		},
		/** 
		 * Funcin que calcula la edicin del contenido a travs del server
		 * @return string con con la edicin del contenido: espaa, brasil, english o catalua
		 */
		getEdition: function(){

			var edition = "espaa";

			switch(this.vars.server){
				case "brasil.elpais.com":
					edition = "brasil";
					break;
				case "english.elpais.com":
					edition = "english";
					break;
				case "cat.elpais.com":
					edition = "catalua";
					break;
				default:
					edition = "espaa";
			}

			return edition;
		},
		getUrlParams: function(){
			//Por defecto lo sacamos de la destinationURL
			var url = this.vars.destinationURL;

			//En AMP del parmetro ampdocUrl pasado al stats.html
			if(this.vars.platform == DTM.PLATFORM.AMP){
				var _ampDocUrl = DTM.utils.getQueryParam("ampdocUrl", location.href);
				if(_ampDocUrl != "")
					url = _ampDocUrl;
			//En IA de la shareURL
			}else if(this.vars.platform == DTM.PLATFORM.FBIA){
				if(typeof ia_document != "undefined" && typeof ia_document.shareURL != "undefined")
					url = ia_document.shareURL;
			}

			return DTM.utils.getQueryParam("", url);
		},
		getUserInfo: function(){
			//Consultamos siempre la info de usuario
			var profileID = "", registeredUser = "", userName = "", country = DTM.utils.getCookie("eptz");
			window.setTimeout(function(){
				if(typeof(window.PRISA) != "undefined"){
					var datos = PRISA.user.getData();
					if(datos != undefined){
						profileID = datos.uid;
						if(datos.nickname != undefined){
							registeredUser = "1";
							userName = datos.nickname;
						}else{
							registeredUser = "0";
						}
					}
				}else{
					if(typeof(window.PEPuidEnv) != "undefined" && typeof(window.PEPuid) == "undefined"){
						window.cookieEnabled = (navigator.cookieEnabled) ? true : false;
						if(typeof(navigator.cookieEnabled) == "undefined" && !window.cookieEnabled){
							document.cookie = "testcookie";
							cookieEnabled = (document.cookie.indexOf("testcookie") != -1) ? true : false;
						}
						if(window.cookieEnabled)
							window.PEPuid = window.PEPuidEnv;
					}

					if(typeof(window.PEPuid) != "undefined")
						profileID = window.PEPuid;

					if(typeof(window.PEPuname) != "undefined") {
						registeredUser = "1";
						userName = window.PEPuname;
					}else
						registeredUser = "0";
				}
				
				DTM.dataLayer.setParam("user.profileID", (profileID != "" ? profileID : "not-set"));
				DTM.dataLayer.setParam("user.registeredUser", (profileID != "" ? registeredUser : "not-set"));
				DTM.dataLayer.setParam("user.name", userName);
				DTM.dataLayer.setParam("user.country", (!country ? "" : country.toLowerCase()));
				//ECID
				DTM.dataLayer.setParam("user.experienceCloudID", DTM.utils.getVisitorID());

				//calculo setPaywallInfo directamente cuando no haya paywall
				if((_satellite.getVar("platform") == DTM.PLATFORM.WEB || _satellite.getVar("platform") == DTM.PLATFORM.FBIA) && DTM.paywallActive !== true)
					DTM.dataLayer.setPaywallInfo();

				//AMP
				if(_satellite.getVar("platform") == DTM.PLATFORM.AMP)
					DTM.dataLayer.setPaywallInfoAMP();

				DTM.notify("User info received from user.js lib");
				DTM.utils.dispatchEvent("DTMUserInfoCompleted");
				DTM.dataLayer.userInfoCompleted = true;
			}, 500);
		},
		getUserType: function(){
			//userType
			if(_satellite.getVar("user:type") == "not-set"){

				//User Type desde user.js
				var _userTypeEP = "not-set";
				//Por otro lado calcularemos el valor de la cookie uid_ns
				var _userTypeCookie = "not-set";
				//Variable que se fijar en el digitalData
				var _userType = "not-set";

				var _userProduct = [];

				try{
					
					//-------------------Desde la librera EP ----------------------
					if(typeof EP != "undefined" && typeof EP.user != "undefined"){
						if(EP.user.getData().product === true)
							_userTypeEP = "suscriptor";
						else
							_userTypeEP = _satellite.getVar("user:registeredUser") == "0" ? "anonimo" : (_satellite.getVar("user:registeredUser") == "1" ? "registrado" : "not-set");
					}

					//-------------------Hacemos la consulta a la cookie ----------------------------
					var paywallProducts = _satellite.getVar("paywall:productList");

				    var c = DTM.utils.getCookie("uid_ns");
				    //Buscamos la cookie uid_ns
				    if(c != null){

				        var c_parts = c.substr(7).split('#');
				        var findedSubscription = false;

				        //Buscamos en la cookie los productos del usuario
				        if(c_parts.length > 2){
				            var products = c_parts[2].split(':');

				            //Buscamos cada producto del usuario en el listado de productos vlidos
				            for(var n = 0, m = products.length; (n < m); n++){

				                var result_re = /([0-9]*)\|([0-9]*)/ig.exec(products[n]);
				                
				                if(result_re != null){
				                    var prodData = result_re[1];

				                    //Si el producto ledo es vlido y se encuentra en el listado y no ha expirado: suscripcin encontrada
				                    if(prodData.length > 1 && paywallProducts.hasOwnProperty(prodData) && (new Date()).getTime() < (result_re[2] * 1000)){
				                        
				                        //Aadimos product al array
			                        	_userProduct.push(paywallProducts[prodData].sku);

			                        	//Solo ser suscriptor si alguno de los productos que tiene dan acceso al dominio actual
			                        	if(!findedSubscription && paywallProducts[prodData].access == _satellite.getVar("paywall:access")){
			                        		 findedSubscription = true;
			                        		 _userTypeCookie = "suscriptor";
			                        	}		                        
				                        
				                    }
				                }
				            }//for cookie
				            
				        }//if c_parts.length

				      	//Si no es suscriptor comprobamos si est logueado para determinar si es registrado o annimo
					    if(!findedSubscription)
					    	_userTypeCookie = _satellite.getVar("user:registeredUser") == "0" ? "anonimo" : (_satellite.getVar("user:registeredUser") == "1" ? "registrado" : "not-set");

				    }//if c null

				    //Si ambas estn a not-set, aseguramos los anonimos y dejamos a not-set los logueados (no sabemos si son registrados o suscriptores)
					if(_userTypeEP == "not-set" && _userTypeCookie == "not-set")
						_userType = _satellite.getVar("user:registeredUser") == "0" ? "anonimo" : "not-set";
					//Si alguna de las dos est rellena gana la cookie
					else
						_userType = _userTypeCookie == "not-set" ? _userTypeEP : _userTypeCookie;

					DTM.dataLayer.setParam("user.type", _userType);

					//Productos calculados desde la cookie
					if(_userProduct.length > 0)
						this.vars.cookiePaywallProduct = _userProduct.join(",");

				}catch(e){
					DTM.notify("Error al calcular el userType", "error");
					DTM.dataLayer.setParam("user.type", "not-set");
				}
				
			}
		},
		internalSearch: function(){
			if(this.vars.search == "1") {
				if(typeof(window.texto_busqueda) != "undefined" && window.texto_busqueda != "")
					this.vars.search_keyword = window.texto_busqueda;
				if(typeof(window.contador_busqueda) != "undefined" && parseInt(window.contador_busqueda) >= 0)
					this.vars.search_results = window.contador_busqueda;
			}
			this.setParam("page.pageInfo.onsiteSearch", this.vars.search);
			this.setParam("page.pageInfo.onsiteSearchTerm", this.vars.search_keyword);
			this.setParam("page.pageInfo.onsiteSearchResults", this.vars.search_results);
		},
		isBrandedContent: function(){
			var str_tags = JSON.stringify(_satellite.getVar("tags"));
			return (str_tags.indexOf("\"192925\"") != -1 || str_tags.indexOf("\"197500\"") != -1 || str_tags.indexOf("\"197760\"") != -1 || str_tags.indexOf("\"branded_content") != -1) ? "1" : "0";
		},
		/**
		* Mtodo para fijar la propiedad validPage. Se considera validPage (true) cuando la pgina se sirve desde .elpais.com o si es una traduccin de Translate.
		* Se debe comprobar despus de calcular el Data Layer, para que server est relleno. Cuidado con AMP/IA donde el server viene por parmetro, no es el de la URL
		*/
		isValidPage: function(){
			//son validas las pginas dentro de .elpais.com y las traducidas de Google
			return  this.vars.server.indexOf("elpais.com") != -1 || this.vars.translatePage;
		},
		paramExists: function(oO){
			if(typeof oO == "string"){
				var oOP = oO.split(".");
				var oOPL = oOP.length;
				var cV = window.digitalData[oOP[0]];
				if(typeof cV === "undefined")
					return false;
				else if(oOPL > 1){
					for(var i = 1;i < oOPL;i++){
						cV = cV[oOP[i]];
						if(typeof cV === "undefined")
							return false;
					}
					return true;
				}else 
					return true;
			}else 
				return false;
		},
		setParam: function(param, value){
			if(!this.paramExists(param) || typeof param !== "string" || typeof value == "undefined")
				return false;

			var oOP = param.split(".");
			var oOPL = oOP.length;
			switch(oOPL){
				case 1:
					digitalData[oOP[0]] = value;
					break;
				case 2:
					digitalData[oOP[0]][oOP[1]] = value;
					break;
				case 3:
					digitalData[oOP[0]][oOP[1]][oOP[2]] = value;
					break;
				default:
					return false;
			}
		},
		getUserSubscriptions: function(){
			//paywallProduct lo calculamos, no nos lo pasan
			if(_satellite.getVar("user:subscriptions") == "not-set"){
				//Si se ha calculado por la cookie en getUserType lo cogemos
				if(this.vars.cookiePaywallProduct !== false)
					DTM.dataLayer.setParam("user.subscriptions", this.vars.cookiePaywallProduct);
				//Sino buscamos en ArcP
				else if(typeof ArcP != "undefined" && typeof ArcP._facts != "undefined" && typeof ArcP._facts.sub != "undefined" && typeof ArcP._facts.sub.p != "undefined"){
					if(ArcP._facts.sub.p.length > 0 && _satellite.getVar("user:type") == "suscriptor")
						DTM.dataLayer.setParam("user.subscriptions", ArcP._facts.sub.p.join(","));
					else if(_satellite.getVar("user:type") == "suscriptor")
						DTM.dataLayer.setParam("user.subscriptions", "not-set");
					else
						DTM.dataLayer.setParam("user.subscriptions", "no-suscriptor");
				}
			}else{
				//Si tenemos el del Data Layer pero es distinto del de la cookie, gana la cookie
				if(this.vars.cookiePaywallProduct != false && _satellite.getVar("user:subscriptions") != this.vars.cookiePaywallProduct)
					DTM.dataLayer.setParam("user.subscriptions", this.vars.cookiePaywallProduct);
			}

			//Vaciamos el product en caso de ser usuario annimo
			if(_satellite.getVar("user:registeredUser") == "0" || (_satellite.getVar("user:type") == "registrado" && _satellite.getVar("user:subscriptions") == "not-set"))
				DTM.dataLayer.setParam("user.subscriptions", "no-suscriptor");
		},
		setPaywallInfo: function(data){

			if(typeof data == "undefined")
				data =  {};

			//paywall access
			if(_satellite.getVar("paywall:access") == "not-set"){
				//El acceso es por edicin, todos los subdominios que no sean ediciones los atribuimos a Espaa
				switch(_satellite.getVar("server")){
					case "brasil.elpais.com":
					case "english.elpais.com":
						DTM.dataLayer.setParam("paywall.access", _satellite.getVar("server"));
						break;
					default:
						DTM.dataLayer.setParam("paywall.access", "elpais.com");
				}

			}

			//userType
			if(_satellite.getVar("platform") == DTM.PLATFORM.WEB || _satellite.getVar("platform") == DTM.PLATFORM.FBIA)
				DTM.dataLayer.getUserType();

			//Product
			DTM.dataLayer.getUserSubscriptions();

			//privateMode
			if(_satellite.getVar("privateMode") == "not-set"){
				if(typeof ArcP != "undefined" && typeof ArcP._facts != "undefined" && typeof ArcP._facts.pm != "undefined")
					DTM.dataLayer.setParam("page.pageInfo.privateMode", ArcP._facts.pm === true ? "1" : "0");
			}

			//Counter, nos lo pasan por la funcin
			if(data.hasOwnProperty("numArticulos") && typeof data.numArticulos != "undefined"){
				if(typeof data.numArticulos == "undefined" && data.hasOwnProperty("contentRestriction") && data.contentRestriction.toLowerCase().indexOf("excluido") == -1 && _satellite.getVar("user:type") == "suscriptor"){
					DTM.dataLayer.setParam("paywall.counter", "0");
				}else{
					DTM.dataLayer.setParam("paywall.counter", (data.numArticulos == -1 ? "0" : data.numArticulos.toString()));
				}
			}

			//Active, signwall, status & ad
			if(data.hasOwnProperty("contentRestriction")){

				var section_excl = (typeof ArcP != "undefined" && typeof ArcP._facts != "undefined" && typeof ArcP._facts.s != "undefined" && (ArcP._facts.s.indexOf("planeta_futuro") != -1 || ArcP._facts.s.indexOf("escaparate") != -1));

				//Incluidas
				if(data.contentRestriction.toLowerCase().indexOf("excluido") == -1 && section_excl === false){
					DTM.dataLayer.setParam("paywall.active", true);
					DTM.dataLayer.setParam("paywall.type", "metered");
					
					//Premium
					if(data.contentRestriction.toLowerCase() == "premium")
						DTM.dataLayer.setParam("paywall.signwallType", "reg");

					//Por tipo de usuario
					if(_satellite.getVar("user:type") == "suscriptor"){
						DTM.dataLayer.setParam("paywall.contentAdType", "none");
						DTM.dataLayer.setParam("paywall.contentBlocked", "0");
					}else if(_satellite.getVar("user:type") == "registrado"){
						//Bloqueado
						if(data.hasOwnProperty("callbackResult") && data.callbackResult.hasOwnProperty("triggered") && data.callbackResult.triggered != null){
							DTM.dataLayer.setParam("paywall.contentAdType", "bloqueante");
							DTM.dataLayer.setParam("paywall.contentBlocked", "1");
							DTM.dataLayer.setParam("paywall.counter", "-1");
						}else{
							DTM.dataLayer.setParam("paywall.contentAdType", "none");
							DTM.dataLayer.setParam("paywall.contentBlocked", "0");
						}
					}else if(_satellite.getVar("user:type") == "anonimo"){
						//Bloqueado
						if(data.hasOwnProperty("callbackResult") && data.callbackResult.hasOwnProperty("triggered") && data.callbackResult.triggered != null){
							DTM.dataLayer.setParam("paywall.contentAdType", "bloqueante");
							DTM.dataLayer.setParam("paywall.contentBlocked", "1");
							DTM.dataLayer.setParam("paywall.counter", "-1");
						}else{
							DTM.dataLayer.setParam("paywall.contentAdType", "none");
							DTM.dataLayer.setParam("paywall.contentBlocked", "0");
						}
					}
				//Excluida
				}else{
					//Signwall annimos
					if(DTM.pageDataLayer.hasOwnProperty("paywall") && DTM.pageDataLayer.paywall == "reg"){
						DTM.dataLayer.setParam("paywall.active", true);
						DTM.dataLayer.setParam("paywall.signwallType", "reg");
						DTM.dataLayer.setParam("paywall.contentAdType", "signwall");
						DTM.dataLayer.setParam("paywall.contentBlocked", "1");
					}else{
						DTM.dataLayer.setParam("paywall.active", false);
						DTM.dataLayer.setParam("paywall.signwallType", "free");
						DTM.dataLayer.setParam("paywall.contentAdType", "none");
						DTM.dataLayer.setParam("paywall.contentBlocked", "0");
					}
				}

			}
		},
		setPaywallInfoAMP: function(){

			//paywall access
			if(_satellite.getVar("paywall:access") == "not-set"){
				//El acceso es por edicin, todos los subdominios que no sean ediciones los atribuimos a Espaa
				switch(_satellite.getVar("server")){
					case "brasil.elpais.com":
					case "english.elpais.com":
						DTM.dataLayer.setParam("paywall.access", _satellite.getVar("server"));
						break;
					default:
						DTM.dataLayer.setParam("paywall.access", "elpais.com");
				}
			}

			//QueryParams
			var paywallType_param = DTM.utils.getQueryParam("paywallType", location.href);
			var rid_param = DTM.utils.getQueryParam("rid", location.href);
  			
			DTM.dataLayer.setParam("paywall.active", false);
			DTM.dataLayer.setParam("paywall.contentBlocked", "0");
			DTM.dataLayer.setParam("paywall.contentAdType", "none");
			//userType
			DTM.dataLayer.getUserType();
			//Paywall Product
			DTM.dataLayer.getUserSubscriptions();
			//Obtenemos registeredUserAMP & paywallStatus a travs del servicio de login de AWS (registeredUser y PUCI vienen de getUserInfo) 
			if(rid_param != ""){
				//Peticin al servicio de AWS que controla los login en AMP, necesitamos el READER_ID desde el amp-analytics
				DTM.dataLayer.setParam("user.registeredUserAMP", "not-set");
				try{
					var xhttp = new XMLHttpRequest();
					xhttp.onreadystatechange = function() {
						if(this.readyState == 4 && this.status == 200) {
							DTM.notify("User info received from aws service");
							var log = JSON.parse(this.responseText).success;
							//registeredUser de servicio AWS
							DTM.dataLayer.setParam("user.registeredUserAMP", (log === true ? "1" : "0"));
							//Signwall
							var _signwall = paywallType_param ? (paywallType_param == "reg" ? "reg" : "free") : DTM.dataLayer.vars.paywall.type;
							DTM.dataLayer.setParam("paywall.signwallType", _signwall);

							//El status del paywall depender de este valor
							if(_signwall === "1"){
								var status = _satellite.getVar("user:registeredUserAMP") == "1" ? "0" : (_satellite.getVar("user:registeredUserAMP") == "0" ? "1" : "not-set");
								DTM.dataLayer.setParam("paywall.contentBlocked", status);
							}
						}
					};
					xhttp.open("GET", "https://qygy5uq660.execute-api.eu-west-1.amazonaws.com/prod/amp-access?rid=" + rid_param + "&url=" + _satellite.getVar("destinationURL") + "&ref=&_=" + Math.random() + "&__amp_source_origin=https%3A%2F%2Fseguro.elpais.com", true);
					xhttp.send();
				}catch(e){
					DTM.notify("Error in getUserInfoAMP", "error");
				}
			}else{
				//userType
				DTM.dataLayer.getUserType();
			}
		
		}
	},
	utils: {
		/**
		* Mtodo seguro para aadir listeners Javascript, se asegura la compatibilidad con navegadores antiguos
		* @param element elemento DOM donde se fijar el listener
		* @param evento string nombre del evento a escuchar
		* @param func function callback a ejecutar con el listener
		*/
		addEvent: function(element, evento, func){
			if(document.addEventListener)
				element.addEventListener(evento, func, false);
			else
				element.attachEvent('on'+evento, func);
		},
		/**
		* Funcin para copiar objetos por valor no por referencia (duplicar)
		* @param objetoOrigen parmetro con el objeto de Origen a copiar.
		* return retornamos el objeto duplicado.
		**/
		copyObject: function(objectOrigin){
			
			if(typeof objectOrigin != "object")
				return false;

			var objectResult = {};

			//Recorremos los valores del objecto inicial y los copiamos al nuevo, uno por uno
			for(var param in objectOrigin)
				objectResult[param] = objectOrigin[param];			

			return objectResult;
		},
		/**
		* Mtodo seguro para lanzar eventos personalizados Javascript, se asegura la compatibilidad con navegadores antiguos
		* @param evento string nombre del evento a lanzar
		*/
		dispatchEvent: function(evento){
			var event;
			if(typeof(Event) === "function")
				event = new Event(evento);
			else{
				event = document.createEvent("Event");
				event.initEvent(evento, true, true);
			}
			if(document.dispatchEvent)
				document.dispatchEvent(event);
		},
		/** 
		* Funcin para decodificar parmetros de URL de forma segura, con control de excepciones
		* @param component string con el valor a decodificar
		* @return string con el componente decodificado, mismo valor de component en caso de excepcin
		*/
		decodeURIComponent: function(component){
			var decodedComponent = component;
			try{
				decodedComponent = decodeURIComponent(component);
			}catch(e){
				decodedComponent = component;
				DTM.notify("decodedComponent: error al decodificar el componente: " + component, "error");
			}
			return decodedComponent;
		},
		encoder: {
			_keyStr : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
			encode : function(r) {
				var t, e, o, h, n, a, c, i = "",
					d = 0;
				for (r = this._utf8_encode(r); d < r.length;) h = (t = r.charCodeAt(d++)) >> 2, n = (3 & t) << 4 | (e = r.charCodeAt(d++)) >> 4, a = (15 & e) << 2 | (o = r.charCodeAt(d++)) >> 6, c = 63 & o, isNaN(e) ? a = c = 64 : isNaN(o) && (c = 64), i = i + this._keyStr.charAt(h) + this._keyStr.charAt(n) + this._keyStr.charAt(a) + this._keyStr.charAt(c);
				return i
			},
			decode : function(r) {
				var t, e, o, h, n, a, c = "",
					i = 0;
				for (r = r.replace(/[^A-Za-z0-9\+\/\=]/g, ""); i < r.length;) t = this._keyStr.indexOf(r.charAt(i++)) << 2 | (h = this._keyStr.indexOf(r.charAt(i++))) >> 4, e = (15 & h) << 4 | (n = this._keyStr.indexOf(r.charAt(i++))) >> 2, o = (3 & n) << 6 | (a = this._keyStr.indexOf(r.charAt(i++))), c += String.fromCharCode(t), 64 != n && (c += String.fromCharCode(e)), 64 != a && (c += String.fromCharCode(o));
				return c = this._utf8_decode(c)
			},
			_utf8_encode : function(r) {
				r = r.replace(/\r\n/g, "\n");
				for (var t = "", e = 0; e < r.length; e++) {
					var o = r.charCodeAt(e);
					o < 128 ? t += String.fromCharCode(o) : o > 127 && o < 2048 ? (t += String.fromCharCode(o >> 6 | 192), t += String.fromCharCode(63 & o | 128)) : (t += String.fromCharCode(o >> 12 | 224), t += String.fromCharCode(o >> 6 & 63 | 128), t += String.fromCharCode(63 & o | 128))
				}
				return t
			},
			_utf8_decode : function(r) {
				for (var t = "", e = 0, o = c1 = c2 = 0; e < r.length;)(o = r.charCodeAt(e)) < 128 ? (t += String.fromCharCode(o), e++) : o > 191 && o < 224 ? (c2 = r.charCodeAt(e + 1), t += String.fromCharCode((31 & o) << 6 | 63 & c2), e += 2) : (c2 = r.charCodeAt(e + 1), c3 = r.charCodeAt(e + 2), t += String.fromCharCode((15 & o) << 12 | (63 & c2) << 6 | 63 & c3), e += 3);
				return t
			}
		},
		formatData: function(data){
			var formatData = {};
			for(var param in data){
				if(data[param] != undefined){
					var formatValue = (typeof data[param] != "object") ? data[param].toString().toLowerCase().replace(/"/g, "\\\"") : data[param];
					switch(param){
						case "videoName":
						case "mediaName":
							formatValue = formatValue.replace(/\-\d+$/, "").replace(/#/g, "");
							break;
						case "userID":
						case "videoYoutubeChannel":
						case "pageTitle":
						case "articleTitle":
						case "uniqueVideoID":
							formatValue = data[param];
							break;
						case "pageName":
							formatValue = _satellite.getVar("siteID") + data[param].replace(/[\?#].*?$/g, "").replace(/http.?:\/\/[^\/]*/, "");
							break;
					}
					formatData[param] = formatValue;
				}else{
					formatData[param] = "";
				}
			}
			return formatData;
		},
		formatDate: function(date) {
			if(date < 10)
			   return "0" + date;
			return date;
		},
		getCookie: function(name){
			var nameEQ = name + "=";
			var ca = document.cookie.split(';');
			for(var i = 0, j = ca.length; i < j; i++) {
				var c = ca[i];
				while(c.charAt(0)==' ') c = c.substring(1,c.length);
				if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
			}
			return null;
		},
		/**
		*  Funcin seleccionar nodos <meta> dentro del DOM
		*  @param attr atributo de la etiqueta a obtener
		*  @param value valor de la etiqueta a obtener
		*  return meta array de string con los valores de los atributos content de los nodos seleccionados
		**/
		getMetas: function(attr, value) {
		    if(!attr || !value || typeof document.getElementsByTagName != "function")
		        return [];

		    attr = attr.toLowerCase();
		    value = value.toLowerCase();
		    //Devolvemos un array porque es muy comn que las metas estn duplicadas, p.ej article:tag
		    var meta = [];

		    //Utilizamos querySelectorAll
		    if(typeof document.querySelectorAll === "function"){
		      //De cada nodo extraemos su atributo content
		      document.querySelectorAll("meta[" + attr +"='" + value + "']").forEach(function(m){
		          meta.push(m.getAttribute("content"));
		      });
		    //Compatibilidad para navegadores antiguos
		    }else{
		      var metas = document.getElementsByTagName('meta');
		      //De cada nodo extraemos su atributo content
		      for(i = 0, j = metas.length; i < j; i++)
		          if(metas[i].getAttribute(attr) == value)
		              meta.push(metas[i].getAttribute("content"));
		    }

		    return meta;
		},
		/**
		* Mtodo para recoger parmetros de la URL. Si el digitalData ya est formado se recogen los valores de all, en caso contrario se har de la URL.
		* @param name nombre del parmetro a recoger, si se pasase como cadena vaca, se devolvern todos los parmetros encontrados
		* @param url string con la url donde buscar los parmetros, en caso de no pasarse se utiliar location.href
		* @return string valor del parmetro buscado, object con todos los parmetros en caso de no pasarse nombre
		**/
		getQueryParam: function(name, _url){
			var params = "";
			name = (typeof name == "undefined" || name == "") ? -1 : name;
			url = (typeof _url == "undefined" || _url == "") ? window.location.href : _url;
			
			//Si el digitalData est generado lo devolvemos de all, siempre que no se pase una nueva URL
			if(DTM.dataLayer.vars.urlParams !== false && typeof _url == "undefined"){
				var dlParams = _satellite.getVar("urlParams");
				if(name != -1)
					return dlParams.hasOwnProperty(name) ? dlParams[name] : "";
				else
					return _satellite.getVar("urlParams");
			}
			
			//Si no hay digitalData lo calculamos de la URL
			if(name == -1){
				params = [];
				if(url.indexOf("?") != -1){
					var search = url.substr(url.indexOf("?") + 1).replace(/\?/g, "&");
					search = search.split("&");
					for(var i = 0, j = search.length; i < j; i++){
						if(search[i].indexOf("=") != -1){
							var param_key = search[i].substr(0, search[i].indexOf("="));
							var param_value = search[i].substr(search[i].indexOf("=") + 1);
							params[param_key] = param_value.replace(/#(.*)/g, "");
						}else
							params[search[i]] = "";
					}
				}
			//Si se pasa nombre, se devuelve
			}else{
				params = "";
				//Buscamos en la URL
				name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
				var regexS = "[\\?&]" + name + "=([^&#]*)";
				var results = (new RegExp(regexS)).exec(url);
				params = (results == null) ? "" : DTM.utils.decodeURIComponent(results[1].replace(/\+/g, " ").replace(/#(.*)/g, ""));
			}
			return params;
		},
		getVisitorID: function(){
			var omn_visitorID = "";
			var omn_cookie = DTM.utils.getCookie("AMCV_2387401053DB208C0A490D4C%40AdobeOrg");
			if(typeof DTM.s != "undefined" && typeof DTM.s.marketingCloudVisitorID != "undefined"){
				omn_visitorID = DTM.s.marketingCloudVisitorID;
			}else if(typeof omn_cookie != "undefined"){
				var r = /(MCMID)\/([^\/]*)\/(.*)/.exec(DTM.utils.decodeURIComponent(omn_cookie).replace(/\|/g, "/"));
				omn_visitorID = (r != null) ? r[2] : "";
			}

			return omn_visitorID;
		},
		/**
		* Funcin que permite la carga de scripts en el head fijando un callback pasado por parmetro
		* @param src string con el src del script a cargar
		* @param callback funcin a ejecutar como callback
		**/
		loadScript: function(src, callback){
			var ss = document.createElement('script');
			ss.type = 'text/javascript';
			ss.async = true;

			var head = document.getElementsByTagName('head')[0];
			if(ss.addEventListener)
				ss.addEventListener('load', callback, false);
			else{
				if(ss.onload)
					ss.onload = callback;
				else{
					if(document.all){
						s.onreadystatechange = function() {
							var state = s.readyState;
							if(state === 'loaded' || state === 'complete'){
								callback();
								s.onreadystatechange = null;
							}
						}
					}
				}
			}

			ss.src = src;
			head.appendChild(ss);
		},
		/**
	     * Funcin para calcular el tipo de player en funcin del nombre del player pasado por trackEvent
	     * @param playerName data.playerType pasado por parmetro en trackEvent, viene con el nombre completo de player, necesitamos obtener el nombre genrico
	     * @return playerName nombre genrico del player, valores: "html5", "triton", "dailymotion", "jwplayer" o "youtube"
	     */
	    getPlayerType: function(playerName){

	        var playerType = "html5";

	        if(playerName.indexOf("html5 vdeo v2") != -1)
	        	playerType = "pep";
	        else if(playerName.indexOf("youtube") != -1)
	            playerType = "youtube";
	        else if(playerName.indexOf("triton") != -1)
	            playerType = "triton"
	        else if(playerName.indexOf("dailymotion") != -1)
	            playerType = "dailymotion";
	        else if(playerName.indexOf("jwplayer") != -1)
	            playerType = "jwplayer";
	        else if(playerName.indexOf("realhls") != -1)
	            playerType = "realhls";

	        return playerType;

	    },
		/**
		* Objeto para la gestin segura del localStorage. Especialmente importante en modos incgnito.
		*/
		localStorage: {
			/**
			* Mtodo para el uso seguro del mtodo getItem del localStorage.
			* @param item nombre del item a leer del localStorage
			* @return boolean que indica si la lectura del item se hizo de forma correcta (true) o incorrecta (false)
			*/
			getItem: function(item){
				var _item = false;
				try{
					if(typeof localStorage != "undefined" && typeof localStorage.getItem == "function")
						_item = localStorage.getItem(item);
				}catch(e){
					_item = false;
					DTM.notify("Error in getItem in localStorage", "error");
				}
				return _item;			
			},
			/**
			* Mtodo para el uso seguro del mtodo removeItem del localStorage.
			* @param item nombre del item a eliminar del localStorage
			* @return boolean que indica si la eliminacin del item se hizo de forma correcta (true) o incorrecta (false)
			*/
			removeItem: function(item){
				var _item = false;
				try{
					if(typeof localStorage != "undefined" && typeof localStorage.removeItem == "function"){
						localStorage.removeItem(item);
						_item = true;
					}
				}catch(e){
					_item = false;
					DTM.notify("Error in removeItem in localStorage", "error");
				}	
				return _item;
			},
			/**
			* Mtodo para el uso seguro del mtodo setItem del localStorage.
			* @param item nombre del item a setear del localStorage
			* @param value valor del item a setear
			* @return boolean que indica si el seteo se hizo de forma correcta (true) o incorrecta (false)
			*/
			setItem: function(item, value){
				var _item = false;
				try{
					if(typeof localStorage != "undefined" && typeof localStorage.setItem == "function"){
						localStorage.setItem(item, value);
						_item = true;
					}
				}catch(e){
					_item = false;
					DTM.notify("Error in setItem in localStorage", "error");
				}	
				return _item;
			}
		},
		/**
		* Mtodo para el envo de informacin mediante peticin de pixel, utiliza la funcionalidad navigator.sendBeacon de los navegadores, es compatible para navegadores antiguois
		* @param url string URL de peticin del pixel, sin parmetros
		* @param data objeto con los parmetros a enviar en la peticin
		* @param useSendBeacon boolean [opcional] activa o desactiva el uso de navigator.sendBeacon, por defecto es true
		* @param randomParam string [opcional] indica si se debe aadir un parmetro random para evitar el cache, el valor pasado ser la key del parmetro
		* @return boolean que indica si el envo de los datos es correcto
		*/
		sendBeacon: function(url, data, useSendBeacon, randomParam, encoded){

			if(typeof url != "string" || typeof data != "object")
				return false;

			var beaconSent = false;

			try{
				//Utilizamos la funcin sendBeacon de navigator, aunque no es soportada por todos los navegadores
				if(typeof navigator != "undefined" && typeof navigator.sendBeacon == "function" && (typeof useSendBeacon == "undefined" || useSendBeacon === true)){
					beaconSent = navigator.sendBeacon(url, JSON.stringify(data));
				//Si el navegador no es compatible con la nueva funcin de navigator formamos el pixel a mano con un elemento img
				}else{
					var imgBeacon = new Image(1, 1);

					//Pasamos los datos pasados a string para formar el pixel, los metemos en un array y hacemos un join con &
					var dataString = [];
					for(var param in data){
						if(typeof encoded != "undefined" && encoded === false)
							dataString.push(param + "=" + data[param]);
						else
							dataString.push(param + "=" + encodeURIComponent(data[param]));
					}

					//El random para el descacheo se define por parmetro, si viene cogemos el valor que se indica, si no, no podemos nada
					var randomParamPixel = "";
					if(typeof randomParam == "string")
						 randomParamPixel = randomParam + "=" + String(Math.random()).substr(2, 9);

					//Formamos la peticin: eliminamos posibles ? en el src
					imgBeacon.src = url.replace(/\?/ig, "") + "?" + dataString.join("&") + (dataString.length > 0 && randomParamPixel != "" ? "&" : "") + randomParamPixel;
					beaconSent = true;
				}
			}catch(e){
				DTM.notify("Error in sendBeacon: " + e, "error");
				beaconSent = false;
			}

			return beaconSent;

		},
		setCookie: function(name, value, domain, time) {
			if(time){
				var date = new Date();
				date.setTime(date.getTime() + time);
				var expires = "; expires=" + date.toGMTString();
			}else
				var expires = "";
			document.cookie = name + "=" + value + expires + ";domain=" + domain + ";path=/";
		}
	},
	events: {
		ABDESACT: "ABdesact",
		ABDETECTED: "ABdetected",
		ADEND: "adEnd",
		ADPLAY: "adPlay",
		ADEND: "adEnd",
		ADERROR: "adError",
		ADSKIP: "adSkip",
		ADPAUSED: "adPaused",
		ADRESUMED: "adResumed",
		ADTIMEOUT: "adTimeout",
		AUDIOPLAY: "audioPlay",
		AUDIO50: "audio50",
		AUDIOEND: "audioEnd",
		AUDIOPAUSED: "audioPaused",
		AUDIORESUMED: "audioResumed",
		AUDIOREADY: "audioReady",
		BUTTONCLICK: "buttonClick",
		COMMENTS: "comments",
		CONC: "conc",
		CONCPARTICIPATE: "concParticipate",
		DOWNLOADLINK: "downloadLink",
		EMAILREGISTER: "emailRegister",
		EXITLINK: "exitLink",
		EXTERNALLINK: "externalLink",
		EXTERNALLINKART: "externalLinkArticle",
		FORMABANDON: "formAbandon",
		FORMERROR: "formError",
		FORMSUCESS: "formSucess",
		INTERNALPIXEL: "internalPixel",
		INTERNALSEARCH: "internalSearch",
		INTERNALSEARCHEMPTY:"internalSearchEmpty",
		INTERNALSEARCHRESULTS:"internalSearchResults",
		PAGEVIEW: "pageView",
		PAYERROR: "payError",
		PAYOK: "payOK",
		PHOTOGALLERY: "photogallery",
		PHOTOZOOM: "photoZoom",
		PRODVIEW: "prodView",
		PURCHASE: "purchase",
		READARTICLE: "readArticle",
		RECOMMENDERIMPRESSION: "recommenderImpression",
		SALEBUTTON: "saleButton",
		SCADD: "scAdd",
		SCCHECKOUT: "scCheckout",
		SCREMOVE: "scRemove",
		SCVIEW: "scView",
		SHARE: "share",
		SCROLL: "scroll",
		SCROLLINF: "scrollInf",
		TEST: "test",
		USERCONNECT: "userConnect",
		USERDISCONNECT: "userDisconnect",
		USERLOGIN: "userLogin",
		USERLOGININIT: "userLoginInit",
		USERLOGINREGISTER: "userLoginRegister",
		USERLOGOFF: "userLogOFF",
		USERNEWSLETTERIN: "userNewsletterIN",
		USERNEWSLETTEROFF: "userNewsletterOFF",
		USERPREREGISTER: "userPreRegister",
		USERREGISTER: "userRegister",
		USERUNREGISTER: "userUnregister",
		USERVINC: "userVinc",
		UUVINC: "UUvinc",
		USERLOGOFF: "userLogOFF",
		USERCONNECT: "userConnect",
		VIDEOADSERVERRESPONSE: "videoAdserverResponse",
		VIDEOPLAY: "videoPlay",
		VIDEOEND: "videoEnd",
		VIDEO25: "video25",
		VIDEO50: "video50",
		VIDEO75: "video75",
		VIDEORESUMED: "videoResumed",
		VIDEOPAUSED: "videoPaused",
		VIDEOPLAYEROK:"videoPlayerOK",
		VIDEOREADY: "videoReady",
		VIEWARTICLE:"viewArticle",
		VIDEORELOAD: "videoReload",
		VIDEOREPLAY: "videoReplay",
		init: function(){
			//Recorremos los listeners definidos uno a uno
			for(var eventH in this.eventHandlers){
				//En el caso de los widgets solamente cargamos el listeners "videoWidgets"
				if(_satellite.getVar("platform") != DTM.PLATFORM.WIDGET || eventH == "videoWidgets"){

					switch(this.eventHandlers[eventH].type){
						case "domready":
							(function (eventH) {
								DTM.utils.addEvent(document, 'DOMContentLoaded', function(){
									DTM.events.eventHandlers[eventH].init();
									DTM.notify("Event listener <" + eventH + "> added (domready)");
								});
							}(eventH));
							break;
						case "top":
							this.eventHandlers[eventH].init();
							DTM.notify("Event listener <" + eventH + "> added");
							break;
						case "onload":
							(function (eventH) {
								DTM.utils.addEvent(window, 'load', function(){
									DTM.events.eventHandlers[eventH].init();
									DTM.notify("Event listener <" + eventH + "> added (onload)");
								});
							}(eventH));
							break;
						case "custom":
							(function (eventH) {
								DTM.utils.addEvent(document, DTM.events.eventHandlers[eventH].cevent, function(){
									DTM.events.eventHandlers[eventH].init();
									DTM.notify("Event listener <" + eventH + "> added (custom)");
								});
							}(eventH));
							break;
					}
				}
			}
		},
		vars:{
			readArticleInterval: -1,
			trackLinks: false,
			readArticleTime: 60000
		},
		eventHandlers:{
			userRegisterLogin:{
				type: "custom",
				cevent: "OmniturePVTracked",
				init: function(){
					if(!DTM.tools.omniture.trackedPV)
						return;

					var p_event_log = DTM.utils.getQueryParam("event_log");
					var p_event = DTM.utils.getQueryParam("event");					
					var p_o = DTM.utils.getQueryParam("o");
					var p_prod = DTM.utils.getQueryParam("prod");

					//Si es un logoff el usuario tiene que estar annimo
					if(DTM.utils.getQueryParam("event_log") == "okdesc" && _satellite.getVar("user:registeredUser") != "0")
						return false;

					//Si es cualquier otro evento tiene que ser logueado
					if(DTM.utils.getQueryParam("event_log") != "okdesc" && _satellite.getVar("user:registeredUser") != "1")
						return false;
					
					//Logins
					if(p_event_log != ""){
						var logTypes = {"oklogin":"clasico", "okdesc":"clasico", "okvinculacion":"clasico", "fa":"facebook", "tw":"twitter", "go":"google", "me":"msn", "li":"linkedin"};
						if(logTypes.hasOwnProperty(p_event_log)){
							var logEvent = (p_event_log == "okdesc") ? DTM.events.USERLOGOFF : ((p_event_log == "okvinculacion") ? DTM.events.UUVINC : DTM.events.USERLOGIN);
							if(DTM.tools.omniture.loaded && DTM.tools.omniture.trackedPV)
								DTM.trackEvent(logEvent, {registerType:logTypes[p_event_log],registerOrigin:p_o,registerProd:p_prod});
						}
					}
					//Registros
					if(p_event != ""){
						var regTypes = {"okregistro": "clasico", "fa": "facebook", "tw": "twitter", "go": "google", "me": "msn", "li": "linkedin"};
						if(regTypes.hasOwnProperty(p_event))
							if(DTM.tools.omniture.loaded && DTM.tools.omniture.trackedPV)
								DTM.trackEvent(DTM.events.USERREGISTER, {registerType:regTypes[p_event],registerOrigin:p_o,registerProd:p_prod});
					}
				}
			},
			readArticle:{
				type: "top",
				init: function(){
					if(_satellite.getVar("pageType") == "articulo"){
						DTM.events.vars.readArticleInterval = setTimeout(function(){
							DTM.trackEvent(DTM.events.READARTICLE, {articleTitle:_satellite.getVar("pageTitle")});
						}, DTM.events.vars.readArticleTime);
					}
				}
			},
			shareLinks:{
				type: "domready",
				init: function(){
					if(_satellite.getVar("pageType") != "articulo" && _satellite.getVar("pageType") != "fotogaleria")
						return false;
					
					var shareLinks = {superior_fb:"facebook_superior",superior_twit:"twitter_superior",superior_linkedin:"linkedin_superior",superior_gp:"google_superior",superior_enviar:"enviar_superior",superior_bomn_imprimir:"imprimir_superior",superior_bomn_whatsapp:"whatasapp_superior",superior_guardar:"guardar_superior",inferior_fb:"facebook_inferior",inferior_twit:"twitter_inferior",inferior_linkedin:"linkedin_inferior",inferior_gp:"google_inferior",inferior_enviar:"enviar_inferior",inferior_bomn_imprimir:"imprimir_inferior",inferior_bomn_whatsapp:"whatasapp_inferior",inferior_guardar:"guardar_inferior",fb:"facebook",twit:"twitter",linkedin:"linkedin",gp:"google",bomn_tuenti:"tuenti",bomn_meneame:"meneame",bomn_whatsapp:"whatasapp",bomn_eskup:"eskup",enviar:"enviar",bomn_imprimir:"imprimir",bomn_guardar:"guardar",superior_pinit:"pinterest_superior",inferior_pinit:"pinterest_inferior"};
					for(var link in shareLinks){
						if(document.getElementById(link)){
							var shareLink = document.getElementById(link);
							if(shareLink.href != undefined && shareLink.href != "" && shareLink.href.indexOf('javascript') == -1)
								shareLink.target = "_blank";
							shareLink.idx = shareLinks[link];
							DTM.utils.addEvent(shareLink, "click", function(){DTM.trackEvent(DTM.events.SHARE, {shareRRSS:this.idx})});
						}
					}
				}
			},
			internalLinks:{
				type: "domready",
				init: function(){
					if(!DTM.events.vars.trackLinks || !document.getElementById('cuerpo_noticia'))
						return false;

					var nodosInternos = document.getElementById('cuerpo_noticia').getElementsByTagName("a");
					for(var idx_int = 0, j = nodosInternos.length; idx_int < j; idx_int++){
						var nod = nodosInternos[idx_int];
						if (nod.href != "" && nod.href.indexOf("javascript") == -1){
							DTM.utils.addEvent(nod, "click", function(){
								DTM.trackEvent(DTM.events.EXTERNALLINKART, {articleTitle:_satellite.getVar("pageTitle"), buttonName: this.href});
							});
						}
					}
				}
			},
			widgetND:{
				type: "domready",
				init: function(){
					var widget = document.getElementsByClassName("contenedor_clasificados__interior");
					for(var i = 0, j = widget.length; i < j; i++){
						var links = widget[i].getElementsByTagName("a");
						var linksNames = {"my_savings": "iahorro", "apartment": "fotocasa", "courses": "emagister cursos", "directorio": "emagister centros"};
						var widgetName = widget[i].id.trim().toLowerCase();
						widgetName = linksNames.hasOwnProperty(widgetName) ? linksNames[widgetName] : widgetName;
						for(var k = 0, l = links.length; k < l; k++){
							var link = links[k];
							link.idx = "clasificados " + widgetName;
							DTM.utils.addEvent(link, "click", function(a){
								DTM.trackEvent(DTM.events.EXTERNALLINK, {buttonName: this.idx, externalURL: this.href});
								if(this.target != "_blank"){
									a.preventDefault();
									(function (href, targ) {
										window.setTimeout(function(){
											window.open(href, targ);
										}, 500);
									}(this.href, "_self"));
								}
							});
						}
					}
				}
			},
			videoWidgets:{
				type: "top",
				init: function(){
					DTM.utils.addEvent(window, "message", function(event){
						try{
							if(typeof event != "undefined" && typeof event.data != "undefined" && typeof event.data.eventType != "undefined" && typeof event.data.data == "object")
								DTM.trackEvent(event.data.eventType, event.data.data);
						}catch(e){
							DTM.notify("Error en video iframe", "error");
						}
					}, false);
				}
			}
		},
		/** Funcin para actualizar el digitalData.event y fijar que el evento eventID ha sido marcado en una herramienta pasada por parmetro
		 * Es llamada desde los mtodos trackEvent de cada tool y sirve para dejar en el Data Layer constancia de que el evento ha sido marcado
		 * @param eventID number solamente pasado para registrar en digitalData un evento marcado en una determinada herramienta. Se pasa desde trackEvent de cada tool.
		 * @param tool string nombre de la herramienta donde se marc el evento. Solo pasado cuando se ejecuta desde trackEvent de una tool.
		 * @param tracked booleano que indica que el evento se marc (true) o no (false). Por defecto ser true.
		 **/ 
		setEffect: function(eventID, tool, tracked){

			if(typeof tracked == "undefined")
				tracked = true;

			//Si se trata de un evento, actualizamos el digitalData para notificar en qu herramienta se marc el evento (effect)
			if(typeof eventID != "undefined" && typeof tool != "undefined"){
				if(typeof window.digitalData.event[eventID] != "undefined")
					window.digitalData.event[eventID].eventInfo.effect[tool] = tracked;
			}
		},
		/**
		* Funcin para comprobar si la clave pasada es un evento vlido
		* @param event nombre del evento a comprobar
		* @return valid boolen que indica si el evento es vlido (true) o no (false)
		**/
		validEvent: function(event){
			var valid = false;
			//Se comprueba dentro de las claves de DTM.events si el evento pasado es correcto
			for(var eventValid in this)
				if(typeof this[eventValid] == "string" && this[eventValid] == event)
					return true;
			return valid;
		}
	},
	tools: {
		initialized: true,
		allowAll: true,
		DISABLED: 0,
		ENABLED: 1,
		ONLYEVENTS: 2,
		TRACK_DELAY: "delay",
		TRACK_TOP: "top",
		TRACK_NO: "notrack",
		TRACK_CUSTOM: "custom",
		init: function(){
			/* Sistema para activar/desactivar las tools desde pgina
			 * allowAll permite fijar el comportamiento por defecto, true si no se pasa
			 * Se crea una variable por cada herramienta, para activar/desactivar individualmente.*/
			DTM.tools.allowAll = (typeof DTM.config.allowAll != "undefined") ? DTM.config.allowAll : true;

			//Iniciamos todas las herramientas una por una
			for(var tool in this)
				if(typeof(this[tool].init) == "function" && typeof(this[tool].dl) == "object")
					this[tool].init();
			DTM.tools.initialized = true;

			DTM.notify("Tools initialized");
		},
		omniture:{
			enabled: 1,
			dl: {},
			trackType: -1,
			eventQueue: [],
			eventRequired: false,
			eventRequiredFired: false,
			loaded: false,
			trackedPV: false,
			map: {
				events: {},
				vars: {},
				consents: {}
			},
			init: function(){
				//Enabled
				this.enabled = this.isEnabled();
				//Map
				this.createMap();
				//Track type
				this.trackType = DTM.tools.TRACK_DELAY;
				//Event required, si es paywall o signwall en web marcar con evento personalizado
				this.eventRequired = this.getEventRequired();
				//Formamos los datos para Omniture y los introducimos en el dataLayer
				this.setDL({
					"adobeTargetEnabled": typeof DTM.config.atg != "undefined" && DTM.config.atg ? true : false,
					"articleID": /(\d+)_(\d+)/.exec(_satellite.getVar("articleID")) != null ? _satellite.getVar("articleID") : "",
					"authors": this.formatListVar(_satellite.getVar("author"), "id"),
					"fromHome": _satellite.getVar("referringURL").replace(/[\?#].*?$/g, "") == "https://elpais.com/" ? _satellite.getVar("pageName") : "",
					"tags": this.formatListVar(_satellite.getVar("tags"), "id")
				});
			},
			getEventRequired: function(){
				var eventRequired = false;

				//Paywall
				if(typeof DTM.paywallActive != "undefined" && DTM.paywallActive === true)
					eventRequired = "DTMPaywallActive";
				//Signwall
				else if(_satellite.getVar("paywall:signwallType") == "reg" && _satellite.getVar("platform") != DTM.PLATFORM.AMP)
					eventRequired = "DTMSignwallActive";

				return eventRequired;
			},
			createMap: function(){
				//events
				this.map.events[DTM.events.INTERNALSEARCH] = "event1";
				this.map.events[DTM.events.PAGEVIEW] = "event2";
				this.map.events[DTM.events.SCROLL] = "event5";
				this.map.events[DTM.events.VIDEO25] = "event8";
				this.map.events[DTM.events.VIDEO75] = "event9";
				this.map.events[DTM.events.SCROLLINF] = "event10";
				this.map.events[DTM.events.VIDEOPLAY] = "event11";
				this.map.events[DTM.events.VIDEOREPLAY] = "event11";
				this.map.events[DTM.events.VIDEOEND] = "event12";
				this.map.events[DTM.events.ADPLAY] = "event13";
				this.map.events[DTM.events.ADEND] = "event14";
				this.map.events[DTM.events.ADSKIP] = "event15";
				this.map.events[DTM.events.AUDIOPLAY] = "event16";
				this.map.events[DTM.events.AUDIOEND] = "event17";
				this.map.events[DTM.events.AUDIO50] = "event18";
				this.map.events[DTM.events.USERPREREGISTER] = "event19";
				this.map.events[DTM.events.USERLOGINREGISTER] = "event20";
				this.map.events[DTM.events.USERREGISTER] = "event21";
				this.map.events[DTM.events.EXTERNALLINK] = "event22";
				this.map.events[DTM.events.USERLOGIN] = "event23";
				this.map.events[DTM.events.USERLOGININIT] = "event24";
				this.map.events[DTM.events.USERUNREGISTER] = "event25";
				this.map.events[DTM.events.FORMABANDON] = "event26";
				this.map.events[DTM.events.FORMSUCESS] = "event27";
				this.map.events[DTM.events.FORMERROR] = "event28";
				this.map.events[DTM.events.BUTTONCLICK] = "event33";
				this.map.events[DTM.events.COMMENTS] = "event34";
				this.map.events[DTM.events.SALEBUTTON] = "event35";
				this.map.events[DTM.events.USERNEWSLETTERIN] = "event38";
				this.map.events[DTM.events.USERNEWSLETTEROFF] = "event39";
				this.map.events[DTM.events.CONC] = "event50";
				this.map.events[DTM.events.VIDEOPLAYEROK] = "event59";
				this.map.events[DTM.events.SHARE] = "event69";
				this.map.events[DTM.events.PHOTOZOOM] = "event76";
				this.map.events[DTM.events.VIEWARTICLE] = "event77";
				this.map.events[DTM.events.PHOTOGALLERY] = "event78";
				this.map.events[DTM.events.VIDEO50] = "event79";
				this.map.events[DTM.events.READARTICLE] = "event80";
				this.map.events[DTM.events.CONCPARTICIPATE] = "event81";
				this.map.events[DTM.events.EXTERNALLINKART] = "event99";
				this.map.events[DTM.events.TEST] = "event100";
				this.map.events[DTM.events.PAYOK] = "event102";
				this.map.events[DTM.events.PAYERROR] = "event103";
				this.map.events[DTM.events.DOWNLOADLINK] = "";
				this.map.events[DTM.events.EXITLINK] = "";
				//vars
				this.map.vars.destinationURL = "eVar1";
				this.map.vars.playerType = "eVar2";
				this.map.vars.pageName = "eVar3";
				this.map.vars.videoName = "eVar8";
				this.map.vars.mediaName = "eVar8";
				this.map.vars.adTitle = "eVar9";
				this.map.vars.searchKeyword = "eVar16";
				this.map.vars.adMode = "eVar24";
				this.map.vars.videoSource = "eVar25";
				this.map.vars.mediaSource = "eVar25";
				this.map.vars.videoRepMode = "eVar26";
				this.map.vars.mediaRepMode = "eVar26";
				this.map.vars.formAnalysis = "eVar34";
				this.map.vars.registerType = "eVar37";
				this.map.vars.regType = "eVar37";
				this.map.vars.videoID = "eVar38";
				this.map.vars.mediaID = "eVar38";
				this.map.vars.videoRepType = "eVar42";
				this.map.vars.mediaRepType = "eVar42";
				this.map.vars.photoURL = "eVar46";
				this.map.vars.scrollPercent = "eVar56";
				this.map.vars.buttonName = "eVar58";
				this.map.vars.formName = "eVar65";
				this.map.vars.adEnable = "eVar67";
				this.map.vars.externalURL = "eVar68";
				this.map.vars.externalLink = "eVar68";
				this.map.vars.downloadLink = "eVar68";
				this.map.vars.shareRRSS = "eVar69";
				this.map.vars.mediaFormat = "eVar70";
				this.map.vars.uniqueVideoID = "eVar71";
				this.map.vars.videoDuration = "eVar74";
				this.map.vars.mediaDuration = "eVar74";
				this.map.vars.videoChannels = "eVar75";
				this.map.vars.mediaChannels = "eVar75";
				this.map.vars.videoOrder = "eVar76";
				this.map.vars.mediaOrder = "eVar76";
				this.map.vars.videoCreateSection = "eVar77";
				this.map.vars.mediaCreateSection = "eVar77";
				this.map.vars.registerOrigin = "eVar85";
				this.map.vars.registerProd = "eVar86";
				this.map.vars.videoIframe = "eVar98";
				this.map.vars.mediaIframe = "eVar98";
				this.map.vars.videoYoutubeChannel = "eVar95";
				this.map.vars.videoIframe = "eVar98";
				this.map.vars.videoContractID = "eVar99";
				this.map.vars.mediaContractID = "eVar99";
				this.map.vars.pageNameEP = "eVar166";
				this.map.vars.pageTitleEP = "eVar170";
				this.map.vars.redention = "eVar174";
			},
			getDL: function(){
				return this.dl;
			},
			setDL: function(dl){
				this.dl = dl;
			},
			isEnabled: function(){
				var omn_enabled = (typeof DTM.config.omn_enabled != "undefined") ? DTM.config.omn_enabled : DTM.tools.allowAll;

				//No Widgets
				if(omn_enabled && _satellite.getVar("platform") == DTM.PLATFORM.WIDGET)
					omn_enabled = false;
				omn_enabled = (omn_enabled) ? DTM.tools.ENABLED : DTM.tools.DISABLED;

				return omn_enabled;
			},
			initTracker: function(){
				//AppMeasurement config
				DTM.s = window.s;
		        if(_satellite.environment.stage == "production" && !_satellite.getVar("validPage"))
					s.account = "prisacomfiltradourls";
				DTM.s.debugTracking = false;
				DTM.s.dstStart = _satellite.getVar("date:dstStart");
				DTM.s.dstEnd = _satellite.getVar("date:dstEnd");
				DTM.s.currentYear = _satellite.getVar("date:year");
				DTM.s.cookieDomainPeriods = document.URL.indexOf(".com.") > 0 ? "3" : "2";
				DTM.s.siteID = _satellite.getVar("siteID");
				DTM.s.trackInlineStats = true;
				DTM.s.linkTrackVars = "None";
				DTM.s.linkTrackEvents = "None";
			},
			formatListVar: function(arrayList, key){
				if(typeof arrayList == "string")
					return arrayList.replace(/,;|,/g,";").replace(/^;/,"");

				var formatList = [];
				key = (typeof key == "undefined") ? "id" : key;
				try{
					for(var i = 0, j = arrayList.length; i < j; i++)
						formatList.push(arrayList[i][key]);
				}catch(e){
					formatList = [];
				}

				if(key == "id")
					return formatList.join(";");
				return formatList.join(",");
			},
			trackPV: function(){
				
				//Si no est habilitada o ya se ha marcado no se marca
				if(this.enabled != DTM.tools.ENABLED || this.trackedPV || !this.loaded)
					return false;

				//Si se requiere un evento y no se ha lanzado o se ha lanzado antes de tiempo, no se marca
				if((this.eventRequired !== false && !this.eventRequiredFired) || (this.eventRequired !== false && !DTM.dataLayer.timeOutCompleted))
					return false;

				//Inicializamos el objeto s
				this.initTracker();

				var omniture_dl = this.getDL();

				/* AMP Adapter*/
				if(_satellite.getVar("platform") == DTM.PLATFORM.AMP){
					DTM.s.pageURL = _satellite.getVar("destinationURL");
					DTM.s.referrer = _satellite.getVar("referringURL");
				}

				/* IA Adapter */
				if(_satellite.getVar("platform") == DTM.PLATFORM.FBIA)
					DTM.s.referrer = _satellite.getVar("referringURL");
				
				//PageName & Channel
				DTM.s.pageName = _satellite.getVar("pageName");			
				DTM.s.channel = _satellite.getVar("primaryCategory");
				//Server
				DTM.s.server = _satellite.getVar("server");
				//Page Type
				DTM.s.pageType = _satellite.getVar("primaryCategory") == "error-404" ? "errorPage" : "";
				//Hier
				DTM.s.hier1 = 'D=c18+">"+c19+">"+c20+">"+c1+">"pageName';

				//List vars
				DTM.s.list1 = omniture_dl.tags;
				DTM.s.list2 = omniture_dl.authors;
				//Campaign
				if(!DTM.s.campaign){
					DTM.s.campaign = _satellite.getVar("campaign");
					DTM.s.campaign = DTM.s.getValOnce(DTM.s.campaign,'s_campaign',0);
				}
				
				//Custom traffic variables
				DTM.s.prop1 = _satellite.getVar("subCategory1");
				DTM.s.prop2 = _satellite.getVar("subCategory2");
				DTM.s.prop3 = _satellite.getVar("pageType");
				DTM.s.prop5 = "D=g";
				DTM.s.prop6 = "D=r";
				DTM.s.prop7 = _satellite.getVar("referringDomain");
				DTM.s.prop8 =_satellite.getVar("omniture:weekDay");
				DTM.s.prop10 = _satellite.getVar("articleLength");
				DTM.s.prop11 = _satellite.getVar("language");
				DTM.s.prop14 = _satellite.getVar("geoRegion");
				DTM.s.prop16 = _satellite.getVar("onsiteSearchTerm");
				DTM.s.prop17 = _satellite.getVar("sysEnv");
				DTM.s.prop18 = _satellite.getVar("org");
				DTM.s.prop19 = _satellite.getVar("publisher");
				DTM.s.prop20 = _satellite.getVar("domain");
				DTM.s.prop21 = _satellite.getVar("omniture:newRepeat");
				DTM.s.prop23 = _satellite.getVar("articleID");
				DTM.s.prop28 = _satellite.getVar("omniture:visitNumDay");
				DTM.s.prop30 = _satellite.getVar("businessUnit");
				DTM.s.prop31 = _satellite.getVar("thematic");
				DTM.s.prop33 = _satellite.getVar("omniture:visitNumMonth");
				DTM.s.prop34 = _satellite.getVar("user:profileID");
				DTM.s.prop35 = _satellite.getVar("omniture:hourSection");
				DTM.s.prop39 = _satellite.getVar("articleTitle");
				DTM.s.prop42 = _satellite.getVar("user:type");
				DTM.s.prop44 = _satellite.getVar("creationDate");
				DTM.s.prop45 = _satellite.getVar("pageTitle");
				DTM.s.prop47 = _satellite.getVar("edition");
				DTM.s.prop49 = _satellite.getVar("liveContent");
				DTM.s.prop50 = _satellite.getVar("cms");
				DTM.s.prop51 = _satellite.getVar("omniture:brandedContent");
				DTM.s.prop53 = _satellite.getVar("canonicalURL");
				DTM.s.prop54 = _satellite.getVar("clickOrigin");
				DTM.s.prop60 = _satellite.getVar("pageTypology");
				DTM.s.prop61 = _satellite.getVar("editionNavigation");
				DTM.s.prop62 = _satellite.getVar("omniture:registeredUser");
				DTM.s.prop66 = _satellite.getVar("loadType");
				DTM.s.prop72 = _satellite.getVar("omniture:articleDays");

				//Conversion custom variables			
				//Limpiamos eVars
				for(var dataKey in this.map.vars)
					DTM.s[this.map.vars[dataKey]] = "";
				DTM.s.eVar1 = "D=g";
				DTM.s.eVar3 = "D=pageName";
				DTM.s.eVar4 = "D=ch"; 
				DTM.s.eVar5 = DTM.s.prop1 ? "D=c1": "";
				DTM.s.eVar6 = DTM.s.prop2 ? "D=c2" : "";
				DTM.s.eVar7 = DTM.s.prop3 ? "D=c3" : "";
				DTM.s.eVar10 = DTM.s.prop10 ? "D=c10" : "";
				DTM.s.eVar11 = DTM.s.prop11 ? "D=c11" : "";
				DTM.s.eVar14 = DTM.s.prop14 ? "D=c14" : "";	
				DTM.s.eVar16 = DTM.s.prop16 ? "D=c16" : "";
				DTM.s.eVar17 = DTM.s.prop17 ? "D=c17" : "";
				DTM.s.eVar18 = DTM.s.prop18 ? "D=c18" : "";
				DTM.s.eVar19 = DTM.s.prop19 ? "D=c19" : "";
				DTM.s.eVar20 = DTM.s.prop20 ? "D=c20" : "";
				DTM.s.eVar21 = DTM.s.prop21 ? "D=c21" : "";
				DTM.s.eVar23 = DTM.s.prop23 ? "D=c23" : "";
				DTM.s.eVar22 = DTM.s.prop62 ? "D=c62" : "";
				DTM.s.eVar27 = _satellite.getVar("cleanURL");
				DTM.s.eVar28 = DTM.s.prop28 ? "D=c28" : "";
				DTM.s.eVar30 = DTM.s.prop30 ? "D=c30" : "";
				DTM.s.eVar31 = _satellite.getVar("pageInstanceID");
				DTM.s.eVar32 = DTM.s.prop33 ? "D=c33" : "";   
				DTM.s.eVar33 = _satellite.getVar("onsiteSearchResults");
				DTM.s.eVar35 = DTM.s.prop35 ? "D=c35" : "";
				DTM.s.eVar36 = _satellite.getVar("omniture:registeredUserAMP") == "1" ? "logueado" : (_satellite.getVar("omniture:registeredUserAMP") == "0" ? "anonimo" : _satellite.getVar("omniture:registeredUserAMP"));
				DTM.s.eVar39 = DTM.s.prop39 ? "D=c39" : "";
				DTM.s.eVar41 = _satellite.getVar("publisherID");
				DTM.s.eVar43 = DTM.s.prop34 ? "D=c34" : "";
				DTM.s.eVar44 = DTM.s.prop44 ? "D=c44" : "";
				DTM.s.eVar45 = _satellite.getVar("pageTitle");
				DTM.s.eVar47 = DTM.s.prop47 ? "D=c47" : "";
				DTM.s.eVar48 = DTM.s.prop8 ? "D=c8" : "";		
				DTM.s.eVar49 = DTM.s.prop49 ? "D=c49" : "";
				DTM.s.eVar50 = DTM.s.prop50 ? "D=c50" : "";
				DTM.s.eVar51 = DTM.s.prop51 ? "D=c51" : "";
				DTM.s.eVar53 = DTM.s.prop53 ? "D=c53" : "";
				DTM.s.eVar54 = DTM.s.prop54 ? "D=c54" : "";
				DTM.s.eVar55 = _satellite.getVar("omniture:videoContent");
				DTM.s.eVar60 = DTM.s.prop60 ? "D=c60" : "";
				DTM.s.eVar61 = DTM.s.prop61 ? "D=c61" : "";
				DTM.s.eVar62 = DTM.s.prop31 ? "D=c31" : "";
				DTM.s.eVar63 = DTM.s.prop6 ? DTM.s.prop6 : "";
				DTM.s.eVar64 = DTM.s.prop7 ? "D=c7" : "";
				DTM.s.eVar66 = DTM.s.prop66 ? "D=c66" : "";		
				DTM.s.eVar72 = DTM.s.prop72 ? "D=c72" : "";
				DTM.s.eVar73 = _satellite.getVar("test");
				DTM.s.eVar79 = _satellite.getVar("serverAMP");
				DTM.s.eVar80 = _satellite.getVar("urlAMP");
				DTM.s.eVar81 = "D=mid";
				DTM.s.eVar83 = DTM.utils.getQueryParam("mid");
				DTM.s.eVar84 = DTM.utils.getQueryParam("bid");
				DTM.s.eVar85 = DTM.utils.getQueryParam("o");
				DTM.s.eVar86 = DTM.utils.getQueryParam("prod");
				DTM.s.eVar92 = _satellite.getVar("user:type");
				DTM.s.eVar94 = _satellite.getVar("updateDate");
				DTM.s.eVar96 = _satellite.getVar("pageHeight");
				DTM.s.eVar100 = _satellite.getVar("publishDate");
				DTM.s.eVar101 = _satellite.getVar("DTM:version");
				DTM.s.eVar102 = _satellite.getVar("AppMeasurement:version");
				DTM.s.eVar103 = _satellite.getVar("Visitor:version");
				DTM.s.eVar104 = _satellite.getVar("omniture:trackingServer");
				DTM.s.eVar105 = DTM.dataLayer.sync;
				DTM.s.eVar106 = DTM.internalTest;
				DTM.s.eVar151 = _satellite.getVar("paywall:signwallType");
				DTM.s.eVar153 = _satellite.getVar("omniture:paywall:contentBlocked");
				DTM.s.eVar154 = _satellite.getVar("paywall:counter");
				DTM.s.eVar155 = _satellite.getVar("paywall:contentAdType");
				DTM.s.eVar156 = _satellite.getVar("user:subscriptions");
				DTM.s.eVar157 = _satellite.getVar("omniture:paywall:active");
				DTM.s.eVar161 = _satellite.getVar("omniture:privateMode");
				DTM.s.eVar166 = _satellite.getVar("pageName");
				DTM.s.eVar170 = _satellite.getVar("pageTitle");
				DTM.s.eVar193 = _satellite.getVar("paywall:type");

				//Events
				var omn_events = "event2";
				//Bsquedas internas, las obtenemos del layer principal
				if(_satellite.getVar("onsiteSearch") == "1")
					omn_events += ",event1";			
				//Ver artculo
				if(_satellite.getVar("pageType") == "articulo")
					omn_events += ",event77";
				//Adobe Target
				if(omniture_dl.adobeTargetEnabled)
					omn_events += ",event91";

				DTM.s.events = omn_events;

				//Track
				DTM.s.t();

				DTM.s.linkTrackEvents = "None";
				DTM.s.linkTrackVars = "None";
				this.trackedPV = true;
				DTM.utils.dispatchEvent("OmniturePVTracked");

				//Vaciamos la cola de eventos
				for(var eventQ in this.eventQueue)
					this.trackEvent(eventQ);
			},
			trackEvent: function(eventID){
				if(this.enabled == DTM.tools.DISABLED){
					DTM.events.setEffect(eventID, "omniture", false);
					return;
				}

				//Si la pgina no marc, lo aadimos a la cola de eventos.
				if(this.enabled == DTM.tools.ENABLED && !this.trackedPV){
					this.eventQueue.push(eventID);
					return;
				}

				var omniture_dl = this.getDL();

				//Event from data layer
				if(typeof _satellite.getVar("event")[eventID] == "undefined"){
					DTM.notify("Omniture event past not valid <" + eventType + ">", "error");
					return;
				}

				var eventType = _satellite.getVar("event")[eventID].eventInfo.eventName;
				var data = _satellite.getVar("event")[eventID].attributes;

				//Comportamientos particulares
				if((eventType == DTM.events.VIDEO25 || eventType == DTM.events.VIDEO75) && _satellite.getVar("brandedContent") == "0"){
					DTM.events.setEffect(eventID, "omniture", false);
					return false;
				}

				//Event mapping
				if(!this.map.events.hasOwnProperty(eventType)){
					DTM.events.setEffect(eventID, "omniture", false);
					return false;
				}

				var evento = this.map.events[eventType];

				//Tags
				var tags = typeof data.tags != "undefined" && data.tags.length > 0 ? this.formatListVar(data.tags, "id") : omniture_dl.tags;
				var eTags = typeof data.eventTags != "undefined" ? this.formatListVar(data.eventTags, "id") : "";

				//Data from data layer
				DTM.s.linkTrackEvents = evento;
				DTM.s.events = evento;
				DTM.s.server = typeof data.server != "undefined" ? data.server : DTM.s.server;
				DTM.s.pageName = typeof data.pageName != "undefined" ? data.pageName : _satellite.getVar("pageName");
				DTM.s.linkTrackVars = 'events,server,list1,list2,eVar1,eVar3,eVar4,eVar5,eVar6,eVar7,eVar10,eVar16,eVar17,eVar18,eVar19,eVar20,eVar22,eVar23,eVar27,eVar30,eVar31,eVar35,eVar36,eVar39,eVar41,eVar43,eVar45,eVar47,eVar48,eVar49,eVar50,eVar51,eVar53,eVar54,eVar55,eVar60,eVar61,eVar63,eVar64,eVar66,eVar72,eVar73,eVar81,eVar85,eVar86,eVar92,eVar94,eVar96,eVar100,eVar101,eVar102,eVar103,eVar104,eVar105,eVar106,eVar151,eVar153,eVar154,eVar155,eVar156,eVar157,eVar161,eVar166,eVar170,eVar193';
				DTM.s.list1 = eTags == "" ? tags : (tags == "" ? eTags : tags + ";" + eTags);
				DTM.s.list2 = typeof data.authors != "undefined" ? this.formatListVar(data.authors, "id") : omniture_dl.authors;
				DTM.s.eVar1 = _satellite.getVar("destinationURL");
				DTM.s.eVar3 = _satellite.getVar("pageName");
				DTM.s.eVar4 = _satellite.getVar("primaryCategory");
				DTM.s.eVar5 = _satellite.getVar("subCategory1");
				DTM.s.eVar6 = _satellite.getVar("subCategory2");
				DTM.s.eVar7 = _satellite.getVar("pageType");
				DTM.s.eVar10 = _satellite.getVar("articleLength");
				DTM.s.eVar16 = _satellite.getVar("onsiteSearchTerm");
				DTM.s.eVar17 = _satellite.getVar("sysEnv");
				DTM.s.eVar18 = _satellite.getVar("org");
				DTM.s.eVar19 = _satellite.getVar("publisher");
				DTM.s.eVar20 = _satellite.getVar("domain");
				DTM.s.eVar22 = _satellite.getVar("omniture:registeredUser");
				DTM.s.eVar23 = _satellite.getVar("articleID");
				DTM.s.eVar27 = _satellite.getVar("cleanURL");
				DTM.s.eVar30 = _satellite.getVar("businessUnit");
				DTM.s.eVar31 = _satellite.getVar("pageInstanceID");
				DTM.s.eVar35 = _satellite.getVar("omniture:hourSection");
				DTM.s.eVar36 = _satellite.getVar("omniture:registeredUserAMP");
				DTM.s.eVar39 = _satellite.getVar("articleTitle");
				DTM.s.eVar41 = _satellite.getVar("publisherID");
				DTM.s.eVar43 = _satellite.getVar("user:profileID");
				DTM.s.eVar45 = _satellite.getVar("pageTitle");
				DTM.s.eVar47 = _satellite.getVar("edition");
				DTM.s.eVar48 = _satellite.getVar("omniture:weekDay");
				DTM.s.eVar49 = _satellite.getVar("liveContent");
				DTM.s.eVar50 = _satellite.getVar("cms");
				DTM.s.eVar51 = _satellite.getVar("omniture:brandedContent");
				DTM.s.eVar53 = _satellite.getVar("canonicalURL");
				DTM.s.eVar54 = _satellite.getVar("clickOrigin");
				DTM.s.eVar55 = _satellite.getVar("omniture:videoContent");
				DTM.s.eVar60 = _satellite.getVar("pageTypology");
				DTM.s.eVar61 = _satellite.getVar("editionNavigation");
				DTM.s.eVar63 = _satellite.getVar("referringURL");
				DTM.s.eVar64 = _satellite.getVar("referringDomain");
				DTM.s.eVar66 = _satellite.getVar("loadType");
				DTM.s.eVar72 = _satellite.getVar("omniture:articleDays");
				DTM.s.eVar73 = _satellite.getVar("test");
				DTM.s.eVar81 = "D=mid";
				DTM.s.eVar85 = _satellite.getVar("queryParam:o");
				DTM.s.eVar86 = _satellite.getVar("queryParam:prod");
				DTM.s.eVar92 = _satellite.getVar("user:type");
				DTM.s.eVar94 = _satellite.getVar("updateDate");
				DTM.s.eVar96 = _satellite.getVar("pageHeight");
				DTM.s.eVar100 = _satellite.getVar("publishDate");
				DTM.s.eVar101 = _satellite.getVar("DTM:version");
				DTM.s.eVar102 = _satellite.getVar("AppMeasurement:version");
				DTM.s.eVar103 = _satellite.getVar("Visitor:version");
				DTM.s.eVar104 = _satellite.getVar("omniture:trackingServer");
				DTM.s.eVar106 = DTM.internalTest;
				DTM.s.eVar151 = _satellite.getVar("paywall:signwallType");
				DTM.s.eVar153 = _satellite.getVar("omniture:paywall:contentBlocked");
				DTM.s.eVar154 = _satellite.getVar("paywall:counter");
				DTM.s.eVar155 = _satellite.getVar("paywall:contentAdType");
				DTM.s.eVar156 = _satellite.getVar("user:subscriptions");
				DTM.s.eVar157 = _satellite.getVar("omniture:paywall:active");
				DTM.s.eVar161 = _satellite.getVar("omniture:privateMode");
				DTM.s.eVar166 = typeof data.pageName != "undefined" ? data.pageName : _satellite.getVar("pageName");
				DTM.s.eVar170 = _satellite.getVar("pageTitle");
				DTM.s.eVar193 = _satellite.getVar("paywall:type");
				
				//eVars mapping
				if(data.hasOwnProperty("pageName"))
					data.pageNameEP = data.pageName;
				if(data.hasOwnProperty("pageTitle"))
					data.pageTitleEP = data.pageTitle;
				//eVars mapping
				for(var dataKey in this.map.vars){
					if(data.hasOwnProperty(dataKey)){
						DTM.s[this.map.vars[dataKey]] = data[dataKey];
						DTM.s.linkTrackVars += "," + this.map.vars[dataKey];
					}
				}

				//Los eventos de Exit Link y Download Link marcan directamente
				if(eventType != DTM.events.EXITLINK && eventType != DTM.events.DOWNLOADLINK){
					DTM.s.tl(this, 'o', eventType);
					DTM.s.linkTrackEvents = "None";
					DTM.s.linkTrackVars = "None";
				}

				//Notify
				DTM.notify("Event <" + eventType + "> tracked in tool <Adobe Analytics>");
				DTM.events.setEffect(eventID, "omniture", true);
			}
		},
		marfeel:{
			enabled: 1,
			dl: {
				"proId" : "2223",
				"environment" : "",
				"filterId": "1059", 
				"contentVisibility" : "",
				"mapEvents" : {
							"adPlay": "adPlay",
							//"adSkip":
							//"adEnd":
							"videoPlay": "play",
							"videoResumed": "play",
							"videoPaused": "pause",
							//"video50":
							"videoEnd": "end",
							"audioPlay": "play",
							"audioPaused" : "pause",
							"audioResumed": "play",
							// "audio50":
							"audioEnd": "end"
                }
			},
			lib: {
				init: function () {
					var marfeel_dl = DTM.tools.marfeel.dl;
					function e(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=document.createElement("script");c.src=e,t?c.type="module":(c.async=!0,c.type="text/javascript",c.setAttribute("nomodule",""));var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(c,n)}function t(t,c,n){var a,o,r;null!==(a=t.marfeel)&&void 0!==a||(t.marfeel={}),null!==(o=(r=t.marfeel).cmd)&&void 0!==o||(r.cmd=[]),t.marfeel.config=n,t.marfeel.config.accountId=c;var i="https://sdk.mrf.io/statics";e("".concat(i,"/marfeel-sdk.js?id=").concat(c),!0),e("".concat(i,"/marfeel-sdk.es5.js?id=").concat(c),!1)}!function(e,c){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t(e,c,n)}(window, marfeel_dl.environment,{pageType: _satellite.getVar("platform"), multimedia:{}});
					DTM.tools.marfeel.ABTesting();
				},
				testab: function (type) {
					var marfeel_dl = DTM.tools.marfeel.dl;
					var testType = "";
					if (type == "module"){
						testType = "https://marfeelexperimentsexperienceengine.mrf.io/experimentsexperience/render?siteId=" + marfeel_dl.environment +"&url=" + document.location.origin + "&experimentType=HeadlineAB&lang=es&version=esnext";
					}else if (type == "nomodule"){ 
						testType = "https://marfeelexperimentsexperienceengine.mrf.io/experimentsexperience/render?siteId=" + marfeel_dl.environment +"&url=" + document.location.origin + "&experimentType=HeadlineAB&lang=es&version=legacy";
					}
					return testType;
				}
			},
			trackedPV: false,
			init: function(){
				
				// Slo si es IA. Necesita tener datos en la variable ia_document
				if (_satellite.getVar("platform") == "fbia"){
					window.ia_document = {
				            shareURL: _satellite.getVar("destinationURL"),
				            referrer: _satellite.getVar("referringURL")
				        };
				}

				//Enabled
				this.enabled = this.isEnabled();
				var marfeel_dl = DTM.tools.marfeel.dl;

				//Entornos de desarrollo/staging, pginas invlidas o traducidas: se enva a cuenta de filtrado
				if(_satellite.environment.stage != "production" || !_satellite.getVar("validPage") || _satellite.getVar("translatePage")){
				 	this.dl.environment = marfeel_dl.filterId;
				} else {
				 	this.dl.environment = marfeel_dl.proId;
				}
				
				if (_satellite.getVar("paywall:active") != undefined && _satellite.getVar("paywall:signwallType") != undefined) {
					marfeel_dl.contentVisibility = _satellite.getVar("paywall:active") && _satellite.getVar("user:type") != "suscriptor" ? "hard-paywall" : ""
					marfeel_dl.contentVisibility = _satellite.getVar("paywall:signwallType").indexOf("reg") > -1 ? "dynamic-signwall" : ""
				}

				//List
				if(this.enabled != DTM.tools.DISABLED){
					//DTM.tools.list.push("marfeel");
					this.lib.init();
				};
			},
			trackPV: function(){
				window.marfeel.cmd.push(['compass', function(compass) {
					compass.setUserType(_satellite.getVar("user:type") == "suscriptor" ? "paid" : (_satellite.getVar("user:type") == "registrado" ? "logged" : "anonymous"));
					compass.setSiteUserId(_satellite.getVar("user:profileID"));
					if (DTM.tools.marfeel.dl.contentVisibility !=  "" && DTM.tools.marfeel.dl.contentVisibility != undefined)
						compass.setPageVar('closed', DTM.tools.marfeel.dl.contentVisibility);

				}]);
				//Notify
				DTM.notify("PV tracked in tool <marfeel> (Data Layer)");
				return true;
			},
			trackAsyncPV: function(){
				if(this.enabled == DTM.tools.DISABLED)
					return false;
				window.marfeel.cmd.push(['compass', function(compass) {
					compass.trackNewPage({url: _satellite.getVar("destinationURL"), rs: ""});
				}]);
			},
			trackEvent: function(eventID){

				if(this.enabled == DTM.tools.DISABLED){
					DTM.events.setEffect(eventID, "marfeel", false);
					return false;
				}

				//Event from data layer
				if(typeof _satellite.getVar("event")[eventID] == "undefined"){
					DTM.notify("Marfeel event past not valid <" + eventType + ">", "error");
					return false;			
				}

				var eventType = _satellite.getVar("event")[eventID].eventInfo.eventName;
				var data = _satellite.getVar("event")[eventID].attributes;

				// Eventos Scroll y Newsletter

				switch(eventType){
					case "scrollInf":
						window.marfeel.cmd.push(['compass', function(compass) {
							compass.trackNewPage({rs: 'ScrollInf'});
						}]);
					
						DTM.notify("Event <" + eventType + "> tracked in tool <Marfeel>");
						DTM.events.setEffect(eventID, "marfeel", true);
						break;
					case "userNewsletterIN":
						window.marfeel.cmd.push(['compass', function(compass) {
							var nwlCodes = "";
							for (code in data.newsletters){
	    						nwlCodes = nwlCodes +  " " + data.newsletters[codes];
	    					}
							compass.trackNewPage({rs: 'userNewsletterIN ' + nwlCodes});
						}]);
				
						DTM.notify("Event <" + eventType + "> tracked in tool <Marfeel>");
						DTM.events.setEffect(eventID, "marfeel", true);
						break;
					case "userLogin":
						window.marfeel.cmd.push(['compass', function(compass) {
							compass.trackNewPage({rs: "userLogin"});
						}]);
				
						DTM.notify("Event <" + eventType + "> tracked in tool <Marfeel>");
						DTM.events.setEffect(eventID, "marfeel", true);
						break;
					case "userRegister":
						window.marfeel.cmd.push(['compass', function(compass) {
							compass.trackNewPage({rs: "userRegister"});
						}]);
				
						DTM.notify("Event <" + eventType + "> tracked in tool <Marfeel>");
						DTM.events.setEffect(eventID, "marfeel", true);
						break;
					case "audioReady":
					case "videoReady":
						window.marfeel.cmd.push(['multimedia', function(multimedia) {
							multimedia.initializeItem((data.mediaID != undefined ? data.mediaID : "not-set"), DTM.utils.getPlayerType(data.playerType) ,(data.mediaID != undefined ? data.mediaID : "not-set"), (data.mediaFormat != undefined ? data.mediaFormat : "not-set"), {
								isLive: data.mediaRepType != undefined && data.mediaRepType == "streaming" ? true : false,
								title: data.mediaName != undefined ? data.mediaName : "not-set",
								description: data.mediaName != undefined ? data.mediaName : "not-set",
								url: data.mediaUrl != undefined ? data.mediaUrl : "not-set",
								thumbnail: data.mediaThumbnail != undefined ? data.mediaThumbnail : "not-set",
								authors: data.mediaAuthors != undefined ? data.mediAuthors : "not-set",
								publishTime: data.mediaPlublishTime != undefined ? data.mediaPlublishTime : "not-set" , 
								duration: data.mediaDuration != undefined ? data.mediaDuration : "not-set"
							});
						}]);
						DTM.notify("Event <" + eventType + "> tracked in tool <Marfeel>");
						break;
					case "adPlay":
					//case "adSkip":
					//case "adEnd":
					case "videoPlay":
					case "videoPaused":
					case "videoResumed":
					//case "video50":
					case "videoEnd":
					case "audioPlay":
					case "audioResumed":
					case "audioPaused":
					//case "audio50": 
					case "audioEnd":
						window.marfeel.cmd.push(['multimedia', function(multimedia) {
							multimedia.registerEvent((data.mediaID != undefined ? data.mediaID : "not-set"), DTM.tools.marfeel.dl.mapEvents[eventType] , data.currentTime);
						}]);
						DTM.notify("Event <" + eventType + "> tracked in tool <Marfeel>");
						break;
					case "share":
						window.marfeel.cmd.push(['compass', function(compass) {
							compass.setPageVar('share', data.shareRRSS);
						}]);
						DTM.notify("Event <" + eventType + "> tracked in tool <Marfeel>");
						DTM.events.setEffect(eventID, "marfeel", true);
						break;
					default:
						DTM.events.setEffect(eventID, "marfeel", false);
						return false;
				}

				if(_satellite.getVar("subCategory2") == "epmas>suscripcion>confirmation"){
						window.marfeel.cmd.push(['compass', function(compass) {
							compass.trackNewPage({rs: "userSubscription"});
						}]);
				
						DTM.notify("Event <userSubscription> tracked in tool <Marfeel>");
						DTM.events.setEffect(eventID, "marfeel", true);
				}
				return true;
			},
			isEnabled: function(){
				var mrf_enabled = (typeof DTM.config.mrf_enabled != "undefined") ? DTM.config.mrf_enabled : DTM.tools.allowAll;

				//No AMP, IA ni Wigdet
				if(mrf_enabled && (_satellite.getVar("platform") == DTM.PLATFORM.AMP || _satellite.getVar("platform") == DTM.PLATFORM.WIDGET))
					mrf_enabled = false;
				//Filtrado de secciones donde no se debe marcar
				if(mrf_enabled){
					var blackSections = ["archivo","buscador","comentario","concursos","descargables","desconocido","elpais","elpais_html","entrevistas","eskup","estaticos","eventos","eyeblaster","firmas","formularios","gp","kioskoymas","lomasvisto","misfavoritos","proxy","scripts","suscripciones"];
					mrf_enabled = (blackSections.indexOf(_satellite.getVar("primaryCategory")) == -1);
				}
				mrf_enabled = (mrf_enabled) ? DTM.tools.ENABLED : DTM.tools.DISABLED;

				return mrf_enabled;
			},
			ABTesting: function(){
				if(_satellite.getVar("platform") == DTM.PLATFORM.FBIA)
					return false;
				if(_satellite.getVar("pageType") != "portada" && _satellite.getVar("pageType") != "portadilla" && _satellite.getVar("pageType") != "articulo")
					return false;
				//Module
				var e = document.createElement('script');
				e.setAttribute('language', 'javascript');
				e.setAttribute('type', 'module');
				e.setAttribute('src', DTM.tools.marfeel.lib.testab("module"));
				document.head.appendChild(e);

				//NoModule
				var f = document.createElement('script');
				f.setAttribute('language', 'javascript');
				f.setAttribute('type', 'text/javascript');
				f.setAttribute('nomodule', '');
				f.setAttribute('src', DTM.tools.marfeel.lib.testab("nomodule"));
				document.head.appendChild(f);
			}
		},
		chartbeat:{
			enabled: 1,
			dl: {},
			eventRequired: false,
			eventRequiredFired: false,
			trackType: -1,
			trackedPV: false,
			init: function(){
				//Enabled
				this.enabled = this.isEnabled();
				//Track type
				this.trackType = DTM.tools.TRACK_DELAY;
				//Event Required, solamente se necesitar en pginas del paywall en web
				this.eventRequired = this.getEventRequired();

				//CH params
				var ch_src = _satellite.getVar("platform") == DTM.PLATFORM.FBIA ? "//ep00.epimg.net/js/gdt/chartbeat/chartbeat_fia.js" : "//ep00.epimg.net/js/gdt/chartbeat/chartbeat_video.js";
				var ch_uid = "61731";
				var ch_domain = (_satellite.environment.stage != "production" || !_satellite.getVar("validPage") || _satellite.getVar("translatePage")) ? "staging.elpais.com" : "elpais.com";
				var ch_useCanonical = (_satellite.getVar("canonicalURL") != _satellite.getVar("destinationURL").replace(/[\?#].*?$/g, "")) ? false : true;
				var ch_path = ch_useCanonical ? "" : document.location.pathname;

				if(this.enabled){
					window._sf_async_config = window._sf_async_config || {};
					window._sf_async_config.uid = ch_uid;
					window._sf_async_config.flickerControl = false;
					window._sf_async_config.autoDetect = false;
					window._sf_async_config.domain = ch_domain;
					window._sf_async_config.useCanonical = ch_useCanonical;
					window._sf_async_config.useCanonicalDomain = false;

					if(!ch_useCanonical)
						window._sf_async_config.path = ch_path;

					/** Video Strategy **/
					this.videoStrategy();
					/** Chartbeat headLineTesting **/
					this.headLineTesting();
				}

				//Creacin del Data Layer
				this.setDL({
					"authors": this.getAuthors(),
					"autoDetect": false,
					"domain": ch_domain,
					"id": ch_uid,
					"path": ch_path,
					"sections": this.getSections(),
					"src": ch_src,
					"useCanonical": ch_useCanonical
				});
			},
			getDL: function(){
				return this.dl;
			},
			setDL: function(dl){
				this.dl = dl;
			},
			isEnabled: function(){
				var chb_enabled = (typeof DTM.config.chb_enabled != "undefined") ? DTM.config.chb_enabled : DTM.tools.allowAll;

				//No AMP ni Widget
				if(chb_enabled && (_satellite.getVar("platform") == DTM.PLATFORM.AMP || _satellite.getVar("platform") == DTM.PLATFORM.WIDGET))
					chb_enabled = false;
				//Filtrado de secciones donde no se debe marcar
				if(chb_enabled){
					var blackSections = ["archivo","buscador","comentario","concursos","descargables","desconocido","elpais","elpais_html","entrevistas","eskup","estaticos","eventos","eyeblaster","firmas","formularios","gp","kioskoymas","lomasvisto","misfavoritos","proxy","scripts","suscripciones"];
					chb_enabled = (blackSections.indexOf(_satellite.getVar("primaryCategory")) == -1);
				}
				chb_enabled = (chb_enabled) ? DTM.tools.ENABLED : DTM.tools.DISABLED;
				
				return chb_enabled;
			},
			getEventRequired: function(){
				var eventRequired = false;
				//Paywall
				if(typeof DTM.paywallActive != "undefined" && DTM.paywallActive === true)
					eventRequired = "DTMPaywallActive";
				//Signwall
				else if(_satellite.getVar("paywall:signwallType") == "reg" && _satellite.getVar("platform") != DTM.PLATFORM.AMP)
					eventRequired = "DTMSignwallActive";

				return eventRequired;
			},
			headLineTesting : function(){
				if(_satellite.getVar("platform") == DTM.PLATFORM.FBIA)
					return false;
				if(_satellite.getVar("pageType") != "portada" && _satellite.getVar("pageType") != "portadilla" && _satellite.getVar("pageType") != "articulo")
					return false;

				window._sf_async_config.flickerControl = false;
				var e = document.createElement('script');
				e.setAttribute('language', 'javascript');
				e.setAttribute('type', 'text/javascript');
				e.setAttribute('async', '');
				e.setAttribute('src', '//ep00.epimg.net/js/gdt/chartbeat/chartbeat_mab.js');
				document.head.appendChild(e);
			},
			videoStrategy: function(){
				//HTML5
				function PNCHVideoStrategy(t){this.player_=t,this.ready_=!1,this.currentAdPosition_=void 0,this.videoPlayed_=!1,this.viewStartTime_=(new Date).getTime(),this.videoStartTime_=void 0,this.subscribeEvents_()}window._cbv_strategies=window._cbv_strategies||[],window._cbv_strategies.push(PNCHVideoStrategy),PNCHVideoStrategy.ContentType={AD:"ad",CONTENT:"ct"},PNCHVideoStrategy.AdPosition={PREROLL:"a1",MIDROLL:"a2",POSTROLL:"a3",OVERLAY:"a4",SPECIAL:"a5"},PNCHVideoStrategy.VideoState={UNPLAYED:"s1",PLAYED:"s2",STOPPED:"s3",COMPLETED:"s4"},PNCHVideoStrategy.prototype.subscribeEvents_=function(){2<this.player_.readyState&&(this.ready_=!0),0<this.player_.currentTime&&!this.player_.paused&&!this.player_.ended&&this.onVideoPlay_(),this.player_.addEventListener("canplay",this.bind_(this.onPlaybackReady_,this)),this.player_.addEventListener("playing",this.bind_(this.onVideoPlay_,this))},PNCHVideoStrategy.prototype.bind_=function(t,e){return function(){t.call(e)}},PNCHVideoStrategy.prototype.onPlaybackReady_=function(){this.ready_=!0},PNCHVideoStrategy.prototype.onVideoPlay_=function(){this.videoStartTime_=(new Date).getTime(),this.videoPlayed_=!0},PNCHVideoStrategy.prototype.isReady=function(){return this.ready_},PNCHVideoStrategy.prototype.getTitle=function(){return this.player_.attributes.title&&this.player_.attributes.title.value||""},PNCHVideoStrategy.prototype.getVideoPath=function(){if(void 0!==this.player_.idMedia)var t=this.player_.idMedia;else t=this.player_.currentSrc;return t||""},PNCHVideoStrategy.prototype.getContentType=function(){return PNCHVideoStrategy.ContentType.CONTENT},PNCHVideoStrategy.prototype.getAdPosition=function(){return""},PNCHVideoStrategy.prototype.getTotalDuration=function(){var t=this.player_.duration;return this.getTimeInSeconds_(t)},PNCHVideoStrategy.prototype.getState=function(){return this.videoPlayed_?this.player_.ended?PNCHVideoStrategy.VideoState.COMPLETED:this.player_.paused?PNCHVideoStrategy.VideoState.STOPPED:PNCHVideoStrategy.VideoState.PLAYED:PNCHVideoStrategy.VideoState.UNPLAYED},PNCHVideoStrategy.prototype.timeElapsed_=function(t){return void 0===t?0:(new Date).getTime()-t},PNCHVideoStrategy.prototype.onEmbedCodeChanged_=function(){this.currentAdPosition_=void 0,this.adStartTime_=void 0},PNCHVideoStrategy.prototype.getCurrentPlayTime=function(){var t=this.player_.currentTime;return this.getTimeInSeconds_(t)},PNCHVideoStrategy.prototype.getBitrate=function(){return-1},PNCHVideoStrategy.prototype.getThumbnailPath=function(){return this.player_.attributes.poster&&this.player_.attributes.poster.value||""},PNCHVideoStrategy.prototype.getPlayerType=function(){},PNCHVideoStrategy.prototype.getViewStartTime=function(){return isNaN(this.viewStartTime_)?0:this.timeElapsed_(this.viewStartTime_)},PNCHVideoStrategy.prototype.getViewPlayTime=function(){return this.videoPlayed_?this.timeElapsed_(this.viewStartTime_):-1},PNCHVideoStrategy.prototype.getViewAdPlayTime=function(){return-1},PNCHVideoStrategy.prototype.getTimeInSeconds_=function(t){return-1===t||isNaN(t)?-1:1e3*t},PNCHVideoStrategy.verify=function(t){return t instanceof HTMLElement&&"VIDEO"===t.nodeName&&void 0!==t.idMedia};
				window.PNCHVideoStrategy = PNCHVideoStrategy;
			},
			getSections: function(){
				var ch_section = _satellite.getVar("primaryCategory");
				if(_satellite.getVar("domain") == "brasil.elpais.com")
					ch_section = "brasil";
				else if(_satellite.getVar("primaryCategory") == "icon_design")
					ch_section = "icon-design,icon-total";
				else if(_satellite.getVar("primaryCategory") == "icon")
					ch_section = "icon,icon-total";
				else if(_satellite.getVar("primaryCategory") == "planeta_futuro")
					ch_section = "planeta-futuro";
				else{
					var ch_subsections = ["ccaa>catalunya","ccaa>madrid","cultura>television","cultura>babelia","cincodias>territorio_pyme","cincodias>smartlife"];
					for(var i = 0, j = ch_subsections.length; i < j; i++){
						if(_satellite.getVar("subCategory1").indexOf(ch_subsections[i]) == "0" && ch_subsections[i].indexOf(">") != -1)
							ch_section += "," + ch_subsections[i].split(">")[1];
					}
				}
				if(_satellite.getVar("brandedContent") == "1")
					ch_section += ",branded content";
				return ch_section;
			},
			getAuthors: function(){
				
				var ch_authors = "";

				var dtm_authors = _satellite.getVar("author");
				var dl_authors = [];
				var dl_author_name = "";
				var res_aut = "";

				//Recorremos los autores del Data Layer para quedarnos con los nombres normalizados y formatearlos
				for(var i = 0, j = dtm_authors.length; i < j; i++){
					//Si tenemos la firma la marcamos
					if(dtm_authors[i].sign != "")
						dl_authors.push(dtm_authors[i].sign);
					//Si no, formateamos el nombre normalizado
					else{
						var dl_author_name = dtm_authors[i].name;
						if(res_aut = /^(.*)_a$/.exec(dl_author_name))
							dl_author_name = res_aut[1];
						dl_authors.push(dl_author_name.replace(/_/g, " ").replace(/\b\w/g, function(l){ return l.toUpperCase() }));	
					}
				}
			
				return dl_authors.join(",");
			},
			trackPV: function(){
				//Si no est habilitada o ya se ha marcado, no se marca
				if(this.enabled != DTM.tools.ENABLED || this.trackedPV)
					return false;
				//Si se requiere un evento y no se ha lanzado o se ha lanzado antes de tiempo, no se marca
				if((this.eventRequired !== false && !this.eventRequiredFired) || (this.eventRequired !== false && !DTM.dataLayer.timeOutCompleted))
					return false;

				var chartbeat_dl = this.getDL();
				window._sf_async_config.sections = chartbeat_dl.sections;
				window._sf_async_config.title = _satellite.getVar("pageTitle");
				window._sf_async_config.type = _satellite.getVar("pageType");
				window._sf_async_config.authors = chartbeat_dl.authors;
				window._sf_async_config.alias = _satellite.getVar("destinationURL");
				var _cbq = window._cbq = (window._cbq || []);
				_cbq.push(['_acct', _satellite.getVar("user:type") == "suscriptor" ? "paid" : (_satellite.getVar("user:registeredUser") == "1" ? "lgdin" : "anon")]);
				//ID SYNC
				if(_satellite.getVar("platform") == DTM.PLATFORM.WEB){
					window._sf_async_config.idSync = _sf_async_config.idSync || {}; 
					window._sf_async_config.idSync.l = _satellite.getVar("user:profileID");
				}

				var e = document.createElement('script');
				var n = document.getElementsByTagName('script')[0];
				e.type = 'text/javascript';
				if(_satellite.getVar("platform") == DTM.PLATFORM.FBIA)
					e.setAttribute('defer', '');
				else
					e.async = true;
				e.src = chartbeat_dl.src;
				n.parentNode.insertBefore(e, n);

				this.trackedPV = true;
			},
			trackEvent: function(eventID){

				if(this.enabled == DTM.tools.DISABLED){
					DTM.events.setEffect(eventID, "chartbeat", false);
					return false;
				}

				var chartbeat_dl = this.getDL();

				//Event from data layer
				if(typeof _satellite.getVar("event")[eventID] == "undefined"){
					DTM.notify("Chartbeat event past not valid <" + eventType + ">", "error");
					return false;
				}	
				
				var eventType = _satellite.getVar("event")[eventID].eventInfo.eventName;
				var data = _satellite.getVar("event")[eventID].attributes;

				switch(eventType){
					case DTM.events.VIDEOREADY:
						window._cbv = window._cbv || (window._cbv = []);
						window._cbv.push(data.player);
						break;
					case DTM.events.SCROLLINF:
						if(typeof pSUPERFLY != "undefined"){
							pSUPERFLY.virtualPage({
							  sections: _satellite.getVar("primaryCategory"),
							  path: _satellite.getVar("destinationURL").replace(/http.?:\/\/[^\/]*/, ""),
							  title: _satellite.getVar("pageTitle")
							});
						}else{
							DTM.events.setEffect(eventID, "chartbeat", false);
							return false;
						}
						break;
					default:
						DTM.events.setEffect(eventID, "chartbeat", false);
						return false;
				}

				DTM.notify("Event <" + eventType + "> tracked in tool <Chartbeat>");
				DTM.events.setEffect(eventID, "chartbeat", true);

				return true;
			}
		},
		krux:{
			enabled: 1,
			dl: {},
			consents: -1,
			consentsID: "c:salesforce",
			trackType: -1,
			trackedPV: false,
			eventRequired: false,
			eventRequiredFired: false,
			map: {
				events:{}
			},
			init: function(){
				//Enabled
				this.enabled = this.isEnabled();
				//Track type
				this.trackType = DTM.tools.TRACK_DELAY;
				//Event required, si es paywall o signwall en web marcar con evento personalizado
				this.eventRequired = this.getEventRequired();
				//Consents
				this.consents = DTM.CONSENTS.DEFAULT;
				//Map
				this.createMap();
				//Creacin del Data Layer
				this.setDL({
					"data": {},
					"src": "//beacon.krxd.net/event.gif",
					"geoItem": "kxprisabrand_geo"
				});
			},
			getEventRequired: function(){
				var eventRequired = false;
				//Paywall
				if(typeof DTM.paywallActive != "undefined" && DTM.paywallActive === true)
					eventRequired = "DTMPaywallActive";
				//Signwall
				else if(_satellite.getVar("paywall:signwallType") == "reg" && _satellite.getVar("platform") != DTM.PLATFORM.AMP)
					eventRequired = "DTMSignwallActive";

				return eventRequired;
			},
			createMap: function(){
				this.map.events[DTM.events.VIDEOPLAY] = "vvid_0";
				this.map.events[DTM.events.VIDEOREPLAY] = "vvid_0";
				this.map.events[DTM.events.VIDEO50] = "vvid_50";
				this.map.events[DTM.events.VIDEOEND] = "vvid_100";
				this.map.events[DTM.events.AUDIOPLAY] = "default";
				this.map.events[DTM.events.AUDIO50] = "default";
				this.map.events[DTM.events.AUDIOEND] = "default";
				this.map.events[DTM.events.SHARE] = "social";
				this.map.events[DTM.events.EXTERNALLINK] = "default";
				this.map.events[DTM.events.FORMSUCESS] = "fd";
				this.map.events[DTM.events.CONC] = "pageview";
				this.map.events[DTM.events.USERREGISTER] = "default";
			},
			getDL: function(){
				return this.dl;
			},
			setDL: function(dl){
				this.dl = dl;
			},
			isEnabled: function(){
				var krx_enabled = (typeof DTM.config.krx_enabled != "undefined") ? DTM.config.krx_enabled : DTM.tools.allowAll;

				//No AMP ni IA ni Widget
				if(krx_enabled && (_satellite.getVar("platform") == DTM.PLATFORM.AMP || _satellite.getVar("platform") == DTM.PLATFORM.FBIA || _satellite.getVar("platform") == DTM.PLATFORM.WIDGET))
					krx_enabled = false;
				//La pgina vista solamente se marcar en algunas ocasiones, no podemos deshabilitar la herramienta ya que puede haber pginas que marquen eventos y no PV
				if((typeof DTM.config.krx_enabledPV != "undefined" && DTM.config.krx_enabledPV) || _satellite.getVar("articleID") != "" || _satellite.getVar("subCategory1").indexOf("branded_content") != -1)
					krx_enabled = DTM.tools.ENABLED;
				else
					krx_enabled = (krx_enabled) ? DTM.tools.ONLYEVENTS : DTM.tools.DISABLED;
				
				return krx_enabled;
			},
			formatListVar: function(arrayList, key){
				if(typeof arrayList == "string")
					return arrayList.replace(/,;|,/g,";").replace(/^;/,"");

				var formatList = [];
				key = (typeof key == "undefined") ? "id" : key;
				try{
					for(var i = 0, j = arrayList.length; i < j; i++){
						if(arrayList[i][key] != "")
							formatList.push(arrayList[i][key].replace(/\/tag\//g, "").replace(/\//g, "_").replace(/_$/g, ""));
					}
				}catch(e){
					formatList = [];
				}

				return formatList.join(", ");
			},
			getGeo: function(){

				var krx_geo = {country: "", zip: "", region: "", province: ""};
				var krux_dl = this.getDL();

				//Leemos los datos del localStorage
				var geo = DTM.utils.localStorage.getItem(krux_dl.geoItem);

				if(!geo)
					return krx_geo;

				try{
					geo = geo.split("&");
					var geo_json = {};
					for(var i = 0, j = geo.length; i < j; i++){
						var geo_p = geo[i].split("=");
						geo_json[geo_p[0]] = geo_p[1];
					}

					krx_geo.country = typeof geo_json.country != "undefined" ? geo_json.country : "";
					krx_geo.zip = typeof geo_json.zip != "undefined" ? geo_json.zip : "";
					krx_geo.region = typeof geo_json.region != "undefined" ? geo_json.region : "";

					//Calculo province
					if(krx_geo.country == "es" && krx_geo.zip.length > 1){
						var krx_provs = {"10":"caceres","11":"cadiz","12":"castellon","13":"ciudad_real","14":"cordoba","15":"la_corua","16":"cuenca","17":"gerona","18":"granada","19":"guadalajara","20":"guipuzcoa","21":"huelva","22":"huesca","23":"jaen","24":"leon","25":"lerida","26":"la_rioja","27":"lugo","28":"madrid","29":"malaga","30":"murcia","31":"navarra","32":"orense","33":"asturias","34":"palencia","35":"las_palmas","36":"pontevedra","37":"salamanca","38":"santa_cruz_de_tenerife","39":"cantabria","40":"segovia","41":"sevilla","42":"soria","43":"tarragona","44":"teruel","45":"toledo","46":"valencia","47":"valladolid","48":"vizcaya","49":"zamora","50":"zaragoza","51":"ceuta","52":"melilla","01":"alava","08":"barcelona","02":"albacete","09":"burgos","03":"alicante","04":"almeria","05":"avila","06":"badajoz","07":"islas_baleares"};
						var krx_key = krx_geo.zip.substr(0, 2);
						if(krx_provs.hasOwnProperty(krx_key))
							krx_geo.province = krx_provs[krx_key];
					}
				}catch(e){
					krx_geo = {country: "", zip: "", region: "", province: ""};
					DTM.notify("Error in Krux getGeo");
				}
				return krx_geo;
			},
			trackPV: function(){

				var _trackedPV = false;

				if(this.enabled == DTM.tools.DISABLED || this.trackedPV === true)
					return _trackedPV;

				//Si se requiere un evento y no se ha lanzado o se ha lanzado antes de tiempo, no se marca
				if((this.eventRequired !== false && !this.eventRequiredFired) || (this.eventRequired !== false && !DTM.dataLayer.timeOutCompleted))
					return false;
				
				var krux_dl = this.getDL();
				if(this.enabled == DTM.tools.ENABLED){
					krux_dl.data = {
						businessUnit: _satellite.getVar("businessUnit"),
						creationDate: _satellite.getVar("creationDate").replace(/\//g, ""),
						destinationURL: _satellite.getVar("destinationURL"),
						domain: _satellite.getVar("domain"),
						edition: _satellite.getVar("editionNavigation"),
						geo: this.getGeo(),
						geoRegion: _satellite.getVar("geoRegion"),
						language: _satellite.getVar("language"),
						pageTitle: _satellite.getVar("pageTitle"),
						pageType: _satellite.getVar("pageType"),
						primaryCategory: _satellite.getVar("primaryCategory"),
						profileID: _satellite.getVar("user:profileID"),
						publisher: _satellite.getVar("publisher"),
						referringURL: _satellite.getVar("referringURL"),
						source: _satellite.getVar("platform") === DTM.PLATFORM.WEB && _satellite.getVar("device:type") == "mobile" ? "web_movil": _satellite.getVar("sysEnv"),
						subCategory1: _satellite.getVar("subCategory1"),
						tags: _satellite.getVar("tags"),
						thematic: _satellite.getVar("thematic")
					};
					_trackedPV = true;
				}else
					krux_dl.data = false;
				
				window.DataLayerKrx = krux_dl.data;
				DTM.utils.dispatchEvent("DataLayerKrxGenerated");

				//Paywall bloqueante
				if(_satellite.getVar("paywall:contentAdType") == "bloqueante"){
					var _trackedPixel = DTM.utils.sendBeacon(krux_dl.src, {
						"event_id": "Nvpxa3Yd",
						"event_type": "default"
					}, false, "rnd");

					_trackedPV = _trackedPV && _trackedPixel;
				}

				this.trackedPV = _trackedPV;

				return this.trackedPV;
                
			},
			trackEvent: function(eventID){

				//Enabled
				if(this.enabled == DTM.tools.DISABLED || this.consents != DTM.CONSENTS.ACCEPT){
					DTM.events.setEffect(eventID, "krux", false);
					return false;
				}

				//Event from data layer
				if(typeof _satellite.getVar("event")[eventID] == "undefined"){
					DTM.notify("Krux event past not valid <" + eventType + ">", "error");
					return false;
				}

				var eventType = _satellite.getVar("event")[eventID].eventInfo.eventName;
				var data = _satellite.getVar("event")[eventID].attributes;

				//Mapping event, comprobamos si est en el mapa, tiene ID y funcin de ejecucin
				if(!this.map.events.hasOwnProperty(eventType) || !this.map.events[eventType].hasOwnProperty("eventFunction") || !this.map.events[eventType].hasOwnProperty("id")){
					DTM.events.setEffect(eventID, "krux", false);
					return false;
				}

				var evento = this.map.events[eventType];
				var trackedEvent = false;
				var krux_dl = this.getDL();

				var krux_params = {};

				switch(eventType){
					//Eventos de vdeo
					case DTM.events.VIDEO50:
					case DTM.events.VIDEOPLAY:
					case DTM.events.VIDEOREPLAY:
					case DTM.events.VIDEOEND:
						//Parmetros del evento
						krux_params = {
							"event_id": "Lj2mKIH_",
							"event_type": evento.split("_")[0],
							"video.percent": evento.split("_")[1],
							"publisher": _satellite.getVar("publisher"),
							"video.url": _satellite.getVar("destinationURL")
						};

						//Tags
						krux_params["video.meta_keywords"] = data.hasOwnProperty("eventTags") ? this.formatListVar(data.eventTags, "name") : "";
						//VideoName
						krux_params["video.title"] = data.hasOwnProperty("mediaName") ? data.mediaName : (data.hasOwnProperty("videoName") ? data.videoName : "");

						trackedEvent = true;
						break;
					//Eventos de audio
					case DTM.events.AUDIOPLAY:
					case DTM.events.AUDIO50:
					case DTM.events.AUDIOEND:
						//Parmetros del evento
						krux_params = {
							"event_id": "L1NAu_lK",
							"event_type": evento,
							"audio.porcentaje": (eventType == DTM.events.AUDIOPLAY) ? "0" : (eventType == DTM.events.AUDIOEND ? "100" : "50"),
							"audio.publisher": _satellite.getVar("publisher"),
							"landing": location.pathname,
							"status": _status
						}

						//RepType
						krux_params["audio.tipo"] = data.hasOwnProperty("mediaRepType") ? data.mediaRepType : (data.hasOwnProperty("videoRepType") ? data.videoRepType : "");
						//Player type
						krux_params["audio.programa"] = data.hasOwnProperty("playerType") ? data.playerType : "";
						//VideoName
						krux_params["audio.titulo"] = data.hasOwnProperty("mediaName") ? data.mediaName : (data.hasOwnProperty("videoName") ? data.videoName : "");


						trackedEvent = true;
						break;
						//Compartir contenido
					case DTM.events.SHARE:
						//Parmetros del evento
						krux_params = {
							"event_id": "L51Iqage",
							"event_type": evento,
							"page.tags": this.formatListVar(_satellite.getVar("tags"), "name"),
							"page.title": _satellite.getVar("pageTitle"),
							"page.domain": _satellite.getVar("domain"),
							"page.url": _satellite.getVar("destinationURL")
						}

						//shareRRSS
						krux_params["network.name"] = (data.hasOwnProperty("shareRRSS")) ? data.shareRRSS : "";

						trackedEvent = true;
						break;
					//Formulario enviado
					case DTM.events.FORMSUCESS:
						//Solo enviado en las calculadores de Cinco Das
						if(data.hasOwnProperty("formAnalysis") && data.formAnalysis.indexOf("cincodias calculadora") == 0){
							//Parmetros del evento
							krux_params = {
								"event_id": "L51HKfM0",
								"event_type": evento,
								"type": data.formAnalysis
							}

							trackedEvent = true;
						}
						break;
					//Evento para el widget de clasificados
					case DTM.events.EXTERNALLINK:
						//Evento para el widget de clasificados
						if(!data.hasOwnProperty("buttonName") || !data.hasOwnProperty("externalURL") || data.buttonName.indexOf("clasificados") != 0){
							trackedEvent = false;
						}else{
							//Parmetros del evento
							krux_params = {
								"event_id": "MDggfE1S",
								"event_type": evento,
								"link": data.externalURL,
								"type": data.buttonName
							}

							trackedEvent = true;
						}
						break;
					//Concursos
					case DTM.events.CONC:
						if(!data.hasOwnProperty("redention")){
							trackedEvent = false;
						}else{

							//Parmetros del evento
							krux_params = {
								"event_id": "MUQkC414",
								"event_type": evento,
								"step": "thankyoupage",
								"title": data.redention
							}

							trackedEvent = true;
						}
						break;
					//OK registro en EP+
					case DTM.events.USERREGISTER:
						//Registros en EP+
						if(_satellite.getVar("subCategory1").indexOf("tematicos>elpaismas") == -1 && _satellite.getVar("primaryCategory") != "suscripciones"){
							trackedEvent = false;
						}else{
							//Parmetros del evento
							krux_params = {
								"event_id": "M8fkDKVT",
								"event_type": evento
							}

							trackedEvent = true;
						}
						break;
					default:
						trackedEvent = false;
				}
				
				//Notify
				if(trackedEvent){
					//Formamos el pixel mediante sendBeacon
					trackedEvent = DTM.utils.sendBeacon(krux_dl.src, krux_params, false, "rnd");
					DTM.notify("Event <" + eventType + "> tracked in tool <Krux>");
				}

				//Effect
				DTM.events.setEffect(eventID, "krux", trackedEvent);

				return trackedEvent;				
			}
		},
		gfk:{
			enabled: 1,
			dl: {},
			trackedPV: false,
			myStreamingAnalytics: [],
			streamingLoaded: false,
			youtubeLoaded: false,
			init: function(){
				//Enabled
				this.enabled = this.isEnabled();
				//Track type
				this.trackType = DTM.tools.TRACK_TOP;

				//Creacin del Data Layer
				this.setDL({
					"mediaID": _satellite.getVar("publisherID"),
					"regionID": "ES",
					"hosts": {
						"staging": "ES-config-preproduction.sensic.net",
						"production": "ES-config.sensic.net"
					},
					"environment": _satellite.environment.stage != "production" || !_satellite.getVar("validPage") || _satellite.getVar("translatePage") ? "staging" : "production",
					"libs": {
						"page": "s2s-web.js",
						"html5": "html5vodextension.js",
						"youtube": "youtubevodextension.js"
					},
					"url": "",
					"type": "WEB",
					"optin": true, //optional
				    "logLevel": "none" //optional
				});

			},
			getDL: function(){
				return this.dl;
			},
			setDL: function(dl){
				this.dl = dl;
			},
			isEnabled: function(){
				var gfk_enabled = (typeof DTM.config.gfk_enabled != "undefined") ? DTM.config.gfk_enabled : DTM.tools.allowAll;

				//Solo Web
				if(gfk_enabled && _satellite.getVar("platform") != DTM.PLATFORM.WEB)
					gfk_enabled = false;

				gfk_enabled = (gfk_enabled) ? DTM.tools.ENABLED : DTM.tools.DISABLED;

				return gfk_enabled;
			},
		    /**
		     * Mtodo para el marcado de pginas vistas en GFK
		     * Se utiliza para marcar la pgina vista secuencial cargando previamente la librera third-party de GFK
		     * Debemos rellenar los customParams indicados a partir de funciones auxiliares
		     * @return boolean indica si la pgina vista marc correctamente (true) o no (false)
		     **/
		    trackPV: function(){

				if(this.enabled != DTM.tools.ENABLED || this.trackedPV === true)
					return false;

				var gfk_dl = this.getDL();

				//Cargamos la librera de pgina
				this.loadCoreLib();

				//Cargamos las libreras de streaming en pgina
				this.loadStreamingLibs();

				//Recogemos el objeto dejado por la librera de terceros
        		var agent = gfkS2s.getAgent();

        		//Rellenamos los parmetros custom
				var customParams = {
					"c1": _satellite.getVar("server"), 
					"c2": this.getPrimaryCategory()
				};
				 
		       	//Marcamos la pgina vista
		       	agent.impression("default", customParams);

				this.trackedPV = true;
			},
			/**
		     * Mtodo para el marcado de eventos de GFK
		     * Debemos rellenar los customParams indicados a partir de funciones auxiliares, en galeras marcamos pgina vista
		     * @return boolean indica si la pgina vista marc correctamente (true) o no (false)
		     **/
		    trackEvent: function(eventID){

				if(this.enabled == DTM.tools.DISABLED){
					DTM.events.setEffect(eventID, "gfk", false);
					return false;
				}

				//Event from data layer
				if(typeof _satellite.getVar("event")[eventID] == "undefined"){
					DTM.notify("GFK event past not valid <" + eventType + ">", "error");
					return false;			
				}

				var eventType = _satellite.getVar("event")[eventID].eventInfo.eventName;
				var data = _satellite.getVar("event")[eventID].attributes;

				var trackedEvent = false;

				switch(eventType){
					case "photogallery":
					case "scrollInf":
						//Recogemos el objeto dejado por la librera de terceros
		        		var agent = gfkS2s.getAgent();

		        		//Rellenamos los parmetros custom
						var customParams = {
							"c1": _satellite.getVar("server"), 
							"c2": this.getPrimaryCategory()
						};
						 
				       	//Marcamos la pgina vista
				       	agent.impression("default", customParams);

				       	trackedEvent = true;

						break;

					case "videoReady":
					case "audioReady":

						//Adaptacin para el player de PEP
						if(!data.hasOwnProperty("playerType") && data.hasOwnProperty("player") && typeof data.player.id != "undefined" && data.player.id.indexOf("pepvideo") != -1){
							data.mediaID = data.player.id.replace(/pepvideo_/ig, "");
							data.playerType = "html5 vdeo v2";
						}

						//Si la librera de sensic streaming no est cargada o por parmetro no se nos pasa el player y el mediaID o ya habamos marcado ya este player, retornamos
		                if(!this.isStreamingLibsLoaded() || !data.hasOwnProperty("player") || !data.hasOwnProperty("mediaID") || this.myStreamingAnalytics.hasOwnProperty(data.mediaID))
		                	return false;

	                    var player = data.player;
	                    var mediaName = data.hasOwnProperty("mediaName") ? data.mediaName : (player.hasOwnProperty("title") ? player.title : "");
	                    var mediaDuration = data.hasOwnProperty("mediaDuration") ? data.mediaDuration : (player.hasOwnProperty("duration") ? parseInt(player.duration) : "");
	                    var playerType = data.hasOwnProperty("playerType") ? DTM.utils.getPlayerType(data.playerType) : "html5";

	                    //El marcado depender del tipo de player
	                    switch(playerType){
	                    	//Players PEP
	                    	case "pep":
                    			//Para el player de PEP creamos la instancia en el play, que es cuando tendremos el nombre y la duracin del vdeo
                    			this.myStreamingAnalytics[data.mediaID] = {
                                	"gfkObject": null,
                                	"player": player
                                }
	                    		break;
	                    	//Players HTML5
	                        case "html5":
	                        case "realhls":
	                            if(data.hasOwnProperty("mediaRepType") && data.mediaRepType == "streaming"){
	                                this.myStreamingAnalytics[data.mediaID] = {
	                                	"gfkObject": new window.gfkS2sExtension.HTML5LiveExtension(player, window.gfkS2sConf, 'default', {"programmname": mediaName, "channelname": _satellite.getVar("publisher"), "c1": _satellite.getVar("server"), "c2": this.getPrimaryCategory()}),
	                                	"player": player
	                                }
	                            }
	                            else{
	                                this.myStreamingAnalytics[data.mediaID] = {
	                                	"gfkObject": new window.gfkS2sExtension.HTML5VODExtension(player, window.gfkS2sConf, 'default', {"programmname": mediaName, "channelname": _satellite.getVar("publisher"), "streamlength": mediaDuration, "c1": _satellite.getVar("server"), "c2": this.getPrimaryCategory()}),
	                                	"player": player
	                                }
	                            }

	                            trackedEvent = true;
	                            break;
	                        //Youtube
                        	case "youtube":
	                            if(data.hasOwnProperty("mediaRepType") && data.mediaRepType == "vod"){    
	                                this.myStreamingAnalytics[data.mediaID] = {
	                                    "gfkObject": new window.gfkS2sExtension.YoutubeVODExtension(player, window.gfkS2sConf, 'default', {"programmname": mediaName, "channelname": _satellite.getVar("publisher"), "streamlength": mediaDuration, "c1": _satellite.getVar("server"), "c2": this.getPrimaryCategory()}),
	                                    "player": player
	                                }
	                            }
	                            trackedEvent = true;
                            	break;
	                        default:
	                            trackedEvent = false;
	                    }

						break;

					case "videoPlay":
					case "videoResumed":
						//Si la librera de sensic streaming no est cargada o por parmetro no se nos el mediaID o no hemos recibido el videoReady, retornamos
	                	if(!this.isStreamingLibsLoaded() || !data.hasOwnProperty("mediaID") || !this.myStreamingAnalytics.hasOwnProperty(data.mediaID))
	                		return false;

	                	var playerType = data.hasOwnProperty("playerType") ? DTM.utils.getPlayerType(data.playerType) : "html5";

	                	//En Youtube refrescamos los parmetros custom para las reproducciones secuenciales
	                	if(playerType == "youtube" && eventType == "videoPlay"){
	                		let agent = this.myStreamingAnalytics[data.mediaID].gfkObject;
	                		let player = this.myStreamingAnalytics[data.mediaID].player;
	                		let mediaName = data.hasOwnProperty("mediaName") ? data.mediaName : (player.hasOwnProperty("videoTitle") ? player.videoTitle : "");
	                		let mediaDuration = data.hasOwnProperty("mediaDuration") ? data.mediaDuration : (typeof player.getDuration == "function" ? parseInt(player.getDuration()) : "");
	                		//Seteamos los parmetros custom
	                		agent.setParameter("default", {"programmname": mediaName, "channelname": _satellite.getVar("publisher"), "streamlength": mediaDuration, "c1": _satellite.getVar("server"), "c2": this.getPrimaryCategory()});
	                	//En PEP creamos la instancia en el play, que es cuando tenemos los datos
	                	}else if(playerType == "pep"){
	                		let player = this.myStreamingAnalytics[data.mediaID].player;
	                		let mediaName = data.hasOwnProperty("mediaName") ? data.mediaName.replace(/\- (.*)/ig, "") : (player.hasOwnProperty("videoTitle") ? player.videoTitle : "");
	                		let mediaDuration = data.hasOwnProperty("mediaDuration") ? data.mediaDuration : (player.hasOwnProperty("duration") ? player.duration : 0);
	                		this.myStreamingAnalytics[data.mediaID].gfkObject = new window.gfkS2sExtension.HTML5VODExtension(player, window.gfkS2sConf, 'default', {"programmname": mediaName, "channelname": _satellite.getVar("publisher"), "streamlength": mediaDuration, "c1": _satellite.getVar("server"), "c2": this.getPrimaryCategory()})
	                	}
						
						break;

					default:
						trackedEvent = false;
				}

				if(trackedEvent === true)
					DTM.notify("Event <" + eventType + "> tracked in tool <GFK>");
				
				DTM.events.setEffect(eventID, "gfk", trackedEvent);

				return trackedEvent;
			},
		    /**
		     * Mtodo que calcula la ruta completa de la librera de GFK pedida por parmetro
		     * Calcular el host de la librera dependiendo del enviroment calculado en el dl de GFK
		     * Si la librera pedida no est definida se devuelve false
		     * @param libName key a buscar en el listado de libreras del dl
		     * @return string con la ruta completa de la libera en caso de pedir una lib vlida, false en caso contrario
		     **/
		    getLibURL: function(libName){

		    	var gfk_lib = false;
		    	var gfk_dl = this.dl;
		    	
		    	//Recuperamos el host, que depender del entorno
		    	var gfk_host = gfk_dl.hosts[gfk_dl.environment];

		    	//Formamos la ruta concatenando el host con el path de la librera solicitada
		    	if(gfk_dl.libs.hasOwnProperty(libName))
		    		gfk_lib = "https://" + gfk_host + "/" + gfk_dl.libs[libName];

		    	return gfk_lib;
		    },
		    /**
		     * Mtodo que indica si las libreras de streaming se han cargado correctamente en pgina
		     * @return boolean true si las libreras estn cargadas, false en caso contrario 
		     **/
		    isStreamingLibsLoaded: function(){
		    	return this.youtubeLoaded && this.streamingLoaded;
		    },
		    /**
		     * Funcin que calcula la seccin a enviar a GFK, en principio enviamos el primaryCategory, si no tiene valor lo sacamos  de la URL, entendida como el primer campo tras el host
		     * @return string con la seccin extrada de la URL
		     **/
		    getPrimaryCategory: function(){

		        var primaryCategory = "";

		        //Por defecto la primaryCategory
		        if(_satellite.getVar("primaryCategory") != ""){
		            primaryCategory = _satellite.getVar("primaryCategory") == "home" ? "homepage" : _satellite.getVar("primaryCategory");
		        }else{
		            //Lo extraemos va regExp de la URL del Data Layer (destinationURL)
		            var categoryURLRegExp = /http.?:\/\/([^\/]*)\/([^\/]*)\//i.exec(_satellite.getVar("destinationURL"));

		            //Si la URL no tiene segundo nivel entendemos que estamos en la home
		            primaryCategory = (categoryURLRegExp) ? categoryURLRegExp[2] : "homepage";
		        }

		        return primaryCategory
		    },
		    /**
		     * Funcin que carga la librera third-party de GFK para poder realizar el marcado
		     **/
		    loadCoreLib: function(){

		    	var gfk_dl = this.getDL();

				//Rellenamos el objeto de configuracin global que necesita la librera
				window.gfkS2sConf = {
				    media: gfk_dl.mediaID,
				    url: this.getLibURL("page"),
				    type: gfk_dl.type
				}

				var w = window;
				var d = document;
				var c = gfkS2sConf;
				var s = "script";
				var id = "gfkS2s";
				var v = "visUrl";

			    if (d.getElementById(id)) {
			        return;
			    }
			  
			    w.gfkS2sConf = c;
			    w[id] = {};
			    w[id].agents = [];
			    var api = ["playStreamLive", "playStreamOnDemand", "stop", "skip", "screen", "volume", "impression"];
			    w.gfks = (function () {
			        function f(sA, e, cb) {
			            return function () {
			                sA.p = cb();
			                sA.queue.push({f: e, a: arguments});
			            };
			        }
			        function s(c, pId, cb) {
			            var sA = {queue: [], config: c, cb: cb, pId: pId};
			            for (var i = 0; i < api.length; i++) {
			                var e = api[i];
			                sA[e] = f(sA, e, cb);
			            }
			            return sA;
			        }
			        return s;
			    }());
			    w[id].getAgent = function (cb, pId) {
			        var a = {
			            a: new w.gfks(c, pId || "", cb || function () {
			                return 0;
			            })
			        };
			        function g(a, e) {
			            return function () {
			                return a.a[e].apply(a.a, arguments);
			            }
			        }
			        for (var i = 0; i < api.length; i++) {
			            var e = api[i];
			            a[e] = g(a, e);
			        }
			        w[id].agents.push(a);
			        return a;
			    };
			  
			    var lJS = function (eId, url) {
			        var tag = d.createElement(s);
			        var el = d.getElementsByTagName(s)[0];
			        tag.id = eId;
			        tag.async = true;
			        tag.type = 'text/javascript';
			        tag.src = url;
			        el.parentNode.insertBefore(tag, el);
			    };
			  
			    if (c.hasOwnProperty(v)) {lJS(id + v, c[v]);}
			    lJS(id, c.url);
			},
			/**
			 * Funcin que carga las libreras de streaming de GFK
			 * Se cargarn en entorno web y siempre que la pgina contenga un audio o un vdeo
			 **/
			loadStreamingLibs: function(){

				//Cargamos las libreras de streaming en todo canal web
		        if(_satellite.getVar("platform") != DTM.PLATFORM.WEB)
		        	return false;

		        //Siempre que haya un video o un audio en la pgina
		        if(_satellite.getVar("videoContent") === false && _satellite.getVar("audioContent") === false)
		        	return false;

		        //Calculamos las URLs de las libreras, que dependen del enviroment actual
	        	var gfk_htmlLib = this.getLibURL("html5");
	        	var gfk_youtubeLib = this.getLibURL("youtube");

	        	//Cargamos los scripts
	        	//HTML 5 extension
	        	if(gfk_htmlLib !== false){
		            DTM.utils.loadScript(gfk_htmlLib, function(){
		                DTM.tools.gfk.streamingLoaded = true;
		            });
		        }

	            //Youtube extension
	            if(gfk_youtubeLib !== false){
		            DTM.utils.loadScript(gfk_youtubeLib, function(){
		                DTM.tools.gfk.youtubeLoaded = true;
		            });
		        }

		        return true;	        
			}
		},
		comscore:{
			enabled: 1,
			dl: {},
			trackType: -1,
			consents: -1,
			consentsID: 77,
			map: {
				consents: {}
			},
			trackedPV: false,
			init: function(){
				//Enabled
				this.enabled = this.isEnabled();
				//Track type
				this.trackType = DTM.tools.TRACK_TOP;
				//Consents
				this.consents = DTM.CONSENTS.DEFAULT;
				//Map
				this.createMap();

				//Creacin del Data Layer
				this.setDL({
					"id": (_satellite.environment.stage != "production" || !_satellite.getVar("validPage")) ? "-1" : "8671776",
					"pbn": "PRISA",
					"src": _satellite.getVar("ssl") == "1" ? "https://sb.scorecardresearch.com" : "http://b.scorecardresearch.com",
					"c3": encodeURIComponent("ELPAIS.COM Sites"),
					"c4": encodeURIComponent("ELPAIS.COM")
				});

				//VideoMetrix - Cargamos la librera siempre que la tool est enabled y si no nos dicen explicitamente que no hay video
				if(this.enabled != DTM.tools.DISABLED && _satellite.getVar("videoContent") !== false){
					this.videoMetrix.enabled = true;
					this.videoMetrix.load();
				}

			},
			getDL: function(){
				return this.dl;
			},
			setDL: function(dl){
				this.dl = dl;
			},
			isEnabled: function(){
				var csc_enabled = (typeof DTM.config.csc_enabled != "undefined") ? DTM.config.csc_enabled : DTM.tools.allowAll;

				//No AMP, IA ni Wigdet
				if(csc_enabled && (_satellite.getVar("platform") == DTM.PLATFORM.AMP || _satellite.getVar("platform") == DTM.PLATFORM.FBIA || _satellite.getVar("platform") == DTM.PLATFORM.WIDGET))
					csc_enabled = false;

				//Deshabilitado en Brasil
				if(csc_enabled && _satellite.getVar("server") === "brasil.elpais.com")
					csc_enabled = false;

				csc_enabled = (csc_enabled) ? DTM.tools.ENABLED : DTM.tools.DISABLED;
				
				return csc_enabled;
			},
			createMap: function(){
				this.map.consents[DTM.CONSENTS.WAITING] = "";
				this.map.consents[DTM.CONSENTS.DEFAULT] = "1";
				this.map.consents[DTM.CONSENTS.ACCEPT] = "1";
				this.map.consents[DTM.CONSENTS.REJECT] = "0";
			},
			trackPV: function(){
				if(this.enabled != DTM.tools.ENABLED || this.trackedPV === true)
					return false;

				var comscore_dl = this.getDL();
				window._comscore = window._comscore || [];

				window._comscore.push({ c1: "2", c2: comscore_dl.id, cs_ucfr: this.map.consents[this.consents]});

				//Cargamos el tag desde ComScore
				(function(){
					window.COMSCORE=function(n){function e(n,e,r){-1==n.indexOf("?")&&(n+="?");var o=!1;(-1!=n.indexOf("&")||n.length-1>n.indexOf("?"))&&(o=!0);for(var a=0;a<e.length;++a){var t=e[a];for(var i in t)o&&(n+="&"),o=!0,n+=i+"="+c(t[i]+"")}return n=function(n,e){if(n.length>e){var r=n.substring(0,e-8).lastIndexOf("&");n=(n=n.substring(0,r)+"&ns_cut="+c(n.substring(r+1))).substring(0,e)}return n}(n,r)}function r(n){for(var e={},r=n.split("&"),o=0;o<r.length;++o){var a=r[o].split("=");2==a.length&&(e[a[0]]=t(a[1]))}return e}function o(n,e){for(var r in e)n[r]=e[r]}function a(n,e){o(n[0],e[0]),o(n[1],e[1]),o(n[2],e[2])}var c="undefined"!=typeof encodeURIComponent?encodeURIComponent:escape,t="undefined"!=typeof decodeURIComponent?decodeURIComponent:unescape,i=document;var f,u,p=(function(n,e){Object.defineProperty(e,"o",{value:!0}),e.t=e.i=void 0;var r,o=[1,7,8,9,10],a=-1,c=!1,t=!1,i=[];function f(){for(var n=0,e=i;n<e.length;n++)(0,e[n])()}function u(){var n;return function(){if(!t){t=!0;var n=+new Date;"function"==typeof __tcfapi&&__tcfapi("addEventListener",2,(function(e,o){o&&(-1==a&&(a=+new Date-n),r=e,f())}))}}(),"function"==typeof __tcfapi&&(__tcfapi("getTCData",2,(function(e){c||(-1==a&&(a=0),n=e,r=e,f())})),n||(c=!0),!0)}function p(n){var e={};if(!n)return e;for(var r=0,a=o;r<a.length;r++){var c=a[r];e[c]=n["purpose"]["consents"][c]}return e}e.i=function(){try{if(!u())return!1;if(r)return r["gdprApplies"]?{u:r["cmpId"],p:r["cmpVersion"],v:c,l:a,s:!0,m:!0,_:!0,C:r["isServiceSpecific"],h:r["purposeOneTreatment"],g:r["vendor"]["legitimateInterests"][77],A:r["vendor"]["consents"][77],I:p(r),R:r["publisherCC"]||""}:{u:r["cmpId"],p:r["cmpVersion"],v:c,l:a,s:!0,m:!1}}catch(n){}return{s:!1,v:!0}},e.t=function(n){i.indexOf(n)>-1||i.push(n)}}(f={O:{}},f.O),f.O);(u=p)&&u.o&&Object.prototype.hasOwnProperty.call(u,"default")&&u["default"];p.t;var v=p.i;function l(){var n=v();if(!n)return!1;var e,r={gdpr:0,gdpr_p1t:"",gdpr_li:"",gdpr_purps:"",gdpr_pcc:""};if(!n.s)return{s:!1,k:!0,labels:{cs_cmp_nc:1}};if(r["cs_cmp_nc"]=n.v?1:0,r["cs_cmp_id"]=n.u,r["cs_cmp_sv"]=n.p,r["cs_cmp_rt"]=n.l,!n.m)return{s:!0,k:!0,labels:r};if(r["gdpr"]="1",!n._)return{s:!0,k:!1,labels:r};r["gdpr_li"]=n.g?"1":"0",r["gdpr_pcc"]=n.R,n.C&&n.h?(r["gdpr_p1t"]="1",e=!0):(r["gdpr_p1t"]="0",e=n.I[1]);var o=!1;if(n.A){o=e;var a=[];e&&a.push(1),n.I[7]&&a.push(7),n.I[8]&&a.push(8),n.I[9]&&a.push(9),n.I[10]&&a.push(10),r["gdpr_purps"]=a.join(",")}return{s:!0,k:o,labels:r}}function s(n,e){if(e.images){var r=new Image;window.ns_p||(window.ns_p=r),r.src=n}}function d(n,e){var a=[{},{cs_it:n,cv:"3.8.0.210223",ns__t:+new Date,ns_c:e?e.characterSet:""},{}];e&&(a[2]={c7:e.URL,c8:e.title,c9:e.referrer});var c="comScore=";if(e)for(var t=0,i=e.cookie.split(";");t<i.length;++t)-1!=i[t].indexOf(c)&&o(a[1],r(unescape(i[t].substring(t+c.length))));return a}function m(n){if(n){var c=n.options||{},t=function(n,e){var a=[{},{},{}];for(var c in n){var t=n[c],i=typeof t;"string"!=i&&"number"!=i||("c1"==c||"c2"==c?a[0][c]=t:a[1][c]=t)}if(!a[0]["c2"])return!1;if(a[0]["c1"]||(a[0]["c1"]=2),e.url_append){var f=r(e.url_append.replace(/&amp;/,"&"));o(a[1],f)}return a}(n,c);if(t){var f=!0;if(!c.disableTcfIntegration){var u=l();u&&(f=u.k,o(t[1],u.labels))}a(t,d("b2",i)),window!=window.top&&(t[1]["ns_if"]=1),s(e(f?"https://sb.scorecardresearch.com/b?":"https://sb.scorecardresearch.com/b2?",t,2048),i)}}}function w(n){n=n||_comscore;for(var e=0;e<n.length;++e)m(n[e]);_comscore=[]}return window.udm_=function(n){var r=[{},{},{}];a(r,d("b2",i)),window!=window.top&&(r[1]["ns_if"]=1);var c=l();c&&o(r[1],c.labels),s(e(n,r,2048),i)},"undefined"==typeof _comscore&&(window._comscore=[]),w(),n.beacon=m,n.purge=w,n}({});
				})()

				this.trackedPV = true;
			},
			trackEvent: function(eventID){

				if(this.enabled == DTM.tools.DISABLED){
					DTM.events.setEffect(eventID, "comscore", false);
					return false;
				}

				var comscore_dl = this.getDL();
				var trackedEvent = false;

				//Event from data layer
				if(typeof _satellite.getVar("event")[eventID] == "undefined"){
					DTM.notify("ComScore event past not valid <" + eventType + ">", "error");
					return false;
				}

				var eventType = _satellite.getVar("event")[eventID].eventInfo.eventName;
				var data = _satellite.getVar("event")[eventID].attributes;
				var currentTime = data.hasOwnProperty("currentTime") ? (data.currentTime * 1000) : -1;
				var videoID = data.hasOwnProperty("mediaID") ? data.mediaID : (data.hasOwnProperty("videoID") ? data.videoID : false);
				var playerType = data.hasOwnProperty("playerType") ? DTM.utils.getPlayerType(data.playerType) : "";

				switch(eventType){
					//Eventos de photogallery
					case "photogallery":
						if(typeof COMSCORE != "undefined"){
							COMSCORE.beacon({
								c1: '2',
								c2: comscore_dl.id,
								cs_ucfr: this.map.consents[this.consents]
							});

							trackedEvent = true;
						}
						break;
					//VideoMetrix VideoReady
					case DTM.events.VIDEOREADY:
						//Iniciamos videoMetrix para el player actual
						if(this.videoMetrix.enabled === false || !this.videoMetrix.isValidPlayer(playerType) || videoID === false || !this.videoMetrix.init(videoID))
							trackedEvent = false;
						else
							trackedEvent = true;
						
						break;
					//Reinicios
					case DTM.events.VIDEORELOAD:
						if(this.videoMetrix.enabled === false || !this.videoMetrix.isValidPlayer(playerType) || videoID === false)
							trackedEvent = false;
						else{
							//Hacemos el replay, elimina la instancia para ese player y continua como un play normal
							this.videoMetrix.replay(videoID);
							trackedEvent = true;
						}
						break;
					//VideoMetrix AD Plays y Reanudaciones
					case DTM.events.ADPLAY:
					case DTM.events.ADRESUMED:
					case DTM.events.VIDEOPLAY:
					case DTM.events.VIDEORESUMED:
						//Iniciamos videoMetrix para el player actual
						if(this.videoMetrix.enabled === false || !this.videoMetrix.isValidPlayer(playerType) || videoID === false || !this.videoMetrix.init(videoID))
							trackedEvent = false;
						else{
							//Seteamos los metadatos de anuncio
							if(eventType == DTM.events.ADPLAY || eventType == DTM.events.ADRESUMED)
								this.videoMetrix.setAdMetadata(data, videoID);
							else
								//Seteamos los metadatos
								this.videoMetrix.setMetadata(data, videoID);
							
							//Marcamos el play
							this.videoMetrix.play(videoID, eventType, currentTime);
							trackedEvent = true;
						}
						break;
					//VideoMetrix Ad / Video ends
					case DTM.events.VIDEOEND:
					case DTM.events.ADEND:
					case DTM.events.ADSKIP:
						//Iniciamos videoMetrix para el player actual
						if(this.videoMetrix.enabled === false || !this.videoMetrix.isValidPlayer(playerType) || videoID === false || !this.videoMetrix.init(videoID))
							trackedEvent = false;
						else{
							//Marcamos el end
							this.videoMetrix.end(videoID, eventType, currentTime);
							trackedEvent = true;
						}
						break;
					//VideoMetrix Pause
					case DTM.events.VIDEOPAUSED:
					case DTM.events.ADPAUSED:
						//Iniciamos videoMetrix para el player actual
						if(this.videoMetrix.enabled === false || !this.videoMetrix.isValidPlayer(playerType) || videoID === false || !this.videoMetrix.init(videoID))
							trackedEvent = false;
						else{
							//Marcamos el pause
							this.videoMetrix.pause(videoID, eventType, currentTime);
							trackedEvent = true;
						}

						break;
					default:
						trackedEvent = false;
				}

				//NOtify
				if(trackedEvent)
					DTM.notify("Event <" + eventType + "> tracked in tool <ComScore>");

				DTM.events.setEffect(eventID, "comscore", trackedEvent);

				return trackedEvent;
			},
			/** Gestin de todos los eventos de VideoMetrix **/
			videoMetrix: {
				enabled: false,
				initialized: false,
				//Array con las instancias del objeto de VideoMetrix para cada player de la pgina. Se utilizar como key el id del vdeo cargado
				myStreamingAnalytics: [],
				//Ruta a la librera de streamsense de VideoMetrix
				lib: "https://ep00.epimg.net/js/comun/streamsense.js",
				/**
				* Funcin para cargar la librera de VideoMetrix. La carga se hace directa para evitar scripts de terceros. Adems, se fija la configuracin del objeto que se fijar en window.ns_
				*/
				load: function(){
					var comscore_dl = DTM.tools.comscore.dl;

					//Cargamos VideoMetrix desde ruta local
					DTM.utils.loadScript(this.lib, function(){
						window.ns_ = ns_.analytics;
						window.ns_.PlatformApi.setPlatformAPI(window.ns_.PlatformApi.PlatformApis.WebBrowser);
						window.ns_.configuration.addClient(new window.ns_.configuration.PublisherConfiguration({'publisherId': comscore_dl.id}));
						window.ns_.configuration.setUsagePropertiesAutoUpdateMode(window.ns_.configuration.UsagePropertiesAutoUpdateMode.FOREGROUND_AND_BACKGROUND);
					});
				},
				/**
				* Funcin para inicializar el objeto de VideoMetrix para el player cuyo ID es pasado por parmetro
				* @param idPlayer identificador del player/video cargado para gestin de las instancias alojadas en myStreamingAnalytics
				**/
				init: function(idPlayer){
					if(this.enabled === false || typeof window.ns_ == "undefined" || typeof idPlayer == "undefined")
						return false;

					//Inicializamos VideoMetrix si no lo estaba ya
					if(!this.initialized){
						this.initialized = true;
						window.ns_.start();
					}

					//Comprobamos que est creada la instancia de StreamingAnalytics para el player pasado
					if(typeof this.myStreamingAnalytics[idPlayer] == "undefined"){

						//Creamos la instancia para el player actual
						this.myStreamingAnalytics[idPlayer] = {
							"sa": new window.ns_.StreamingAnalytics(), 
							"state": "",
							"currentTime": 0
						};

						//Iniciamos playback
						this.myStreamingAnalytics[idPlayer].sa.createPlaybackSession();
					}

					return true;
				},
				/**
				 * Funcin que determina si el player actual debe marcar en VideoMetrix
				 * @param playerType tipo de player calculado previamente
				 * @return boolean que indica si el player actual es vlido (true) o no (false)
				 **/
				isValidPlayer: function(playerType){

					//No marcamos ni en Dailymotion ni en Youtube
					var noValidPlayers = ["youtube"];

					return noValidPlayers.indexOf(playerType) == -1;
				},
				/**
				* Funcin para setear los metadatos del player pasado por parmetro en su instancia de VideoMetrix
				* @param data objeto de datos del evento pasada en trackEvent
				* @param videoID string con el ID del vdeo, false en caso de no haberse pasado por el evento
				**/
				setMetadata: function(data, videoID){

					//Se comprueba que est cargada la librera de videoMetrix y que el objeto data contenga el videoID que sirve como key
					if(typeof window.ns_ == "undefined" || typeof data == "undefined" || videoID === false)
						return false;

					var comscore_dl = DTM.tools.comscore.dl;

					//Tipo de reproduccin
					var mediaRepType = data.hasOwnProperty("mediaRepType") ? data.mediaRepType : (data.hasOwnProperty("videoRepType") ? data.videoRepType : "");
					mediaRepType = mediaRepType != "" ? (mediaRepType == "streaming" ? window.ns_.StreamingAnalytics.ContentMetadata.ContentType.LIVE : window.ns_.StreamingAnalytics.ContentMetadata.ContentType.SHORT_FORM_ON_DEMAND) : "";
					//Longitud multimedia
					var mediaDuration = data.hasOwnProperty("mediaDuration") ? data.mediaDuration : (data.hasOwnProperty("videoDuration") ? data.videoDuration : "");
					mediaDuration = mediaDuration != "" ? (parseInt(mediaDuration) * 1000) : 0;

					//Preparamos los metadatos
					var cm = new ns_.StreamingAnalytics.ContentMetadata();
					cm.setMediaType(mediaRepType);
					cm.setUniqueId(videoID === false ? "null" : videoID);
					cm.setLength(mediaDuration); // 23m58s in milliseconds
					cm.setDictionaryClassificationC3(comscore_dl.c3);
					cm.setDictionaryClassificationC4(comscore_dl.c4);
					cm.setDictionaryClassificationC6( "*null" );
					cm.setPublisherName(comscore_dl.pbn);
					//Aadimos los metadatos a la instancia del player correspondiente
					this.myStreamingAnalytics[videoID].sa.setMetadata(cm);
				},
				/**
				* Funcin para setear los metadatos de anuncio del player pasado por parmetro en su instancia de VideoMetrix
				* @param data objeto de datos del evento pasada en trackEvent
				* @param videoID string con el ID del vdeo, false en caso de no haberse pasado por el evento
				**/
				setAdMetadata: function(data, videoID){

					//Se comprueba que est cargada la librera de videoMetrix y que el objeto data contenga el videoID que sirve como key
					if(typeof window.ns_ == "undefined" || typeof data == "undefined" || videoID === false)
						return false;

					var comscore_dl = DTM.tools.comscore.dl;

					//Tipo de reproduccin
					var mediaRepType = data.hasOwnProperty("mediaRepType") ? data.mediaRepType : (data.hasOwnProperty("videoRepType") ? data.videoRepType : "");
					mediaRepType = mediaRepType != "" ? (mediaRepType == "streaming" ? window.ns_.StreamingAnalytics.ContentMetadata.ContentType.LIVE : window.ns_.StreamingAnalytics.ContentMetadata.ContentType.SHORT_FORM_ON_DEMAND) : "";
					//Longitud multimedia
					var mediaDuration = data.hasOwnProperty("mediaDuration") ? data.mediaDuration : (data.hasOwnProperty("videoDuration") ? data.videoDuration : "");
					mediaDuration = mediaDuration != "" ? (parseInt(mediaDuration) * 1000) : 0;

					//Preparamos los metadatos
					var cm = new ns_.StreamingAnalytics.ContentMetadata();
					cm.setMediaType(mediaRepType);
					cm.setUniqueId(videoID === false ? "null" : videoID);
					cm.setLength(mediaDuration); // 23m58s in milliseconds
					cm.setDictionaryClassificationC3(comscore_dl.c3);
					cm.setDictionaryClassificationC4(comscore_dl.c4);
					cm.setDictionaryClassificationC6( "*null" );
					cm.setPublisherName(comscore_dl.pbn);

					//Ad metadatos
					var am = new window.ns_.StreamingAnalytics.AdvertisementMetadata();

					var adType = "";
					if(typeof data.adMode != "undefined"){
						switch(data.adMode){
							case "post-roll":
							case "postroll":
								adType = window.ns_.StreamingAnalytics.AdvertisementMetadata.AdvertisementType.ON_DEMAND_POST_ROLL;
								break;
							case "pre-roll":
							case "preroll":
								adType = window.ns_.StreamingAnalytics.AdvertisementMetadata.AdvertisementType.ON_DEMAND_PRE_ROLL;
								break;
							case "mid-roll":
							case "midroll":
								adType = window.ns_.StreamingAnalytics.AdvertisementMetadata.AdvertisementType.ON_DEMAND_MID_ROLL;
								break;
						}
					}

					am.setMediaType(adType);
					am.setRelatedContentMetadata(cm);
					//Aadimos los metadatos a la instancia del player correspondiente
					this.myStreamingAnalytics[videoID].sa.setMetadata(am);
				},
				/**
				* Funcin para notificar un evento de play (content y ad) en VideoMetrix
				* @param idPlayer identificador del player para gestin de las instancias de VideoMetrix
				**/
				play: function(idPlayer, eventType, currentTime){

					//Se comprueba que est cargada la librera de videoMetrix
					if(typeof window.ns_ == "undefined" || typeof idPlayer == "undefined")
						return false;

					//Seeks, sern si es una reanudacin tras pausa y el currentTime actual es distinto al guardado en la pausa
					if(eventType == DTM.events.VIDEORESUMED && this.myStreamingAnalytics[idPlayer].state === DTM.events.VIDEOPAUSED && currentTime != this.myStreamingAnalytics[idPlayer].currentTime){
						this.myStreamingAnalytics[idPlayer].sa.startFromPosition(currentTime);
						this.myStreamingAnalytics[idPlayer].sa.notifySeekStart();
					}else{
						//Notificamos el play
						this.myStreamingAnalytics[idPlayer].sa.notifyPlay();
					}

					//State
					this.myStreamingAnalytics[idPlayer].state = eventType;
					//CurrentTime
					this.myStreamingAnalytics[idPlayer].currentTime = currentTime;
				},
				/**
				* Funcin para gestionar los replays en VideoMetrix. Se debe crear una instancia nueva del objeto, con lo que eliminamos el objeto actual. Cuando se haga el init se crear la instancia nueva.
				* @param idPlayer identificador del player para gestin de las instancias de VideoMetrix
				**/
				replay: function(idPlayer, eventType, currentTime){

					//Se comprueba que est cargada la librera de videoMetrix
					if(typeof window.ns_ == "undefined" || typeof idPlayer == "undefined")
						return false;

					//Se elimina la instancia actual
					if(typeof this.myStreamingAnalytics[idPlayer] != "undefined")
						delete this.myStreamingAnalytics[idPlayer];
				},
				/**
				* Funcin para notificar un evento de pause (content y ad) en VideoMetrix
				* @param idPlayer identificador del player para gestin de las instancias de VideoMetrix
				**/
				pause: function(idPlayer, eventType, currentTime){

					//Se comprueba que est cargada la librera de videoMetrix
					if(typeof window.ns_ == "undefined" || typeof idPlayer == "undefined")
						return false;

					//Notificamos el pause
					this.myStreamingAnalytics[idPlayer].sa.notifyPause();
					//State
					this.myStreamingAnalytics[idPlayer].state = eventType;
					//CurrentTime
					this.myStreamingAnalytics[idPlayer].currentTime = currentTime;

				},
				/**
				* Funcin para notificar un evento de end (content y ad) en VideoMetrix
				* @param idPlayer identificador del player para gestin de las instancias de VideoMetrix
				**/
				end: function(idPlayer, eventType, currentTime){

					//Se comprueba que est cargada la librera de videoMetrix
					if(typeof window.ns_ == "undefined" || typeof idPlayer == "undefined")
						return false;

					//Notificamos el end
					this.myStreamingAnalytics[idPlayer].sa.notifyEnd();
					//State
					this.myStreamingAnalytics[idPlayer].state = eventType;
					//CurrentTime
					this.myStreamingAnalytics[idPlayer].currentTime = currentTime;
				}
			}
		},
		facebook:{
			enabled: 1,
			dl: {},
			consents: -1,
			consentsID: "facebook",
			trackType: -1,
			trackedPV: false,
			eventRequired: false,
			eventRequiredFired: false,
			initialized: false,
			init: function(){
				//Enabled
				this.enabled = this.isEnabled();
				//Track type
				this.trackType = DTM.tools.TRACK_DELAY;
				//Consents
				this.consents = DTM.CONSENTS.DEFAULT;
				//Event Required, solamente se necesitar en pginas del paywall en web
				this.eventRequired = this.getEventRequired();
				//Creacin del Data Layer
				this.setDL({
					"id": "1461658713846525",
					"src": "https://www.facebook.com/tr",
					"trackingCode": _satellite.getVar("campaign") != "" ? _satellite.getVar("campaign") : "none",
					"campaign": _satellite.getVar("campaign") != "" ? _satellite.getVar("campaign") : "none"
				});
			},
			getDL: function(){
				return this.dl;
			},
			setDL: function(dl){
				this.dl = dl;
			},
			isEnabled: function(){
				var fbk_enabled = (typeof DTM.config.fbk_enabled != "undefined") ? DTM.config.fbk_enabled : DTM.tools.allowAll;

				//No AMP ni Widget
				if(fbk_enabled && (_satellite.getVar("platform") == DTM.PLATFORM.AMP || _satellite.getVar("platform") == DTM.PLATFORM.WIDGET))
					fbk_enabled = false;

				//Solo si es vlida y no es traducida
				fbk_enabled = fbk_enabled && _satellite.getVar("validPage") === true && _satellite.getVar("translatePage") === false;

				return fbk_enabled ? DTM.tools.ENABLED : DTM.tools.DISABLED;
			},
			getEventRequired: function(){
				var eventRequired = false;
				//Paywall
				if(typeof DTM.paywallActive != "undefined" && DTM.paywallActive === true)
					eventRequired = "DTMPaywallActive";
				//Signwall
				else if(_satellite.getVar("paywall:signwallType") == "reg" && _satellite.getVar("platform") != DTM.PLATFORM.AMP)
					eventRequired = "DTMSignwallActive";

				return eventRequired;
			},
			trackPV: function(){
				if(this.enabled != DTM.tools.ENABLED || this.trackedPV || (_satellite.getVar("platform") != DTM.PLATFORM.FBIA && this.consents !== DTM.CONSENTS.ACCEPT))
					return false;

				//Si se requiere un evento y no se ha lanzado o se ha lanzado antes de tiempo, no se marca
				if((this.eventRequired !== false && !this.eventRequiredFired) || (this.eventRequired !== false && !DTM.dataLayer.timeOutCompleted))
					return false;

				var facebook_dl = this.getDL();

				//Prisa PV
				//PageView
				DTM.utils.sendBeacon(facebook_dl.src, {
					"id": facebook_dl.id,
					"ev": "PageView",
					"dl": _satellite.getVar("destinationURL"),
					"rl": _satellite.getVar("referringURL")
				}, false, "ts");

				//ViewContent
				DTM.utils.sendBeacon(facebook_dl.src, {
					"id": facebook_dl.id,
					"ev": "ViewContent",
					"dl": _satellite.getVar("destinationURL"),
					"rl": _satellite.getVar("referringURL"),
					"cd[campaign]": facebook_dl.campaign,
					"cd[content_name]": _satellite.getVar("pageName"),
					"cd[content_category]": _satellite.getVar("primaryCategory"),
					"cd[registeredUser]": _satellite.getVar("user:registeredUser") == "1" ? "reg" : "anon",
					"cd[sysEnv]": _satellite.getVar("sysEnv"),
					"cd[trackingCode]": facebook_dl.trackingCode,
					"cd[userType]": _satellite.getVar("user:type")
				}, false, "ts");

				this.trackedPV = true;
			},
			trackEvent: function(eventID){

				if(this.enabled == DTM.tools.DISABLED || this.consents !== DTM.CONSENTS.ACCEPT){
					DTM.events.setEffect(eventID, "facebook", true);
					return false;
				}

				var facebook_dl = this.getDL();
				var trackedEvent = false;

				//Event from data layer
				if(typeof _satellite.getVar("event")[eventID] == "undefined"){
					DTM.notify("Facebook event past not valid <" + eventType + ">", "error");
					return false;
				}

				var eventType = _satellite.getVar("event")[eventID].eventInfo.eventName;
				var data = _satellite.getVar("event")[eventID].attributes;

				if(eventType == DTM.events.UUVINC || eventType == DTM.events.USERREGISTER){
					//Enviamos el pixel mediante sendBeacon
					trackedEvent = DTM.utils.sendBeacon(facebook_dl.src, {
						"id": facebook_dl.id,
						"ev": "CompleteRegistration",
						"dl": _satellite.getVar("destinationURL"),
						"rl": _satellite.getVar("referringURL"),
						"cd[campaign]": facebook_dl.campaign,
						"cd[content_name]": _satellite.getVar("pageName"),
						"cd[content_category]": _satellite.getVar("primaryCategory"),
						"cd[registeredUser]": _satellite.getVar("user:registeredUser") == "1" ? "reg" : "anon",
						"cd[sysEnv]": _satellite.getVar("sysEnv"),
						"cd[trackingCode]": facebook_dl.trackingCode,
						"cd[userType]": _satellite.getVar("user:type"),
						"cd[status]": eventType == DTM.events.USERREGISTER ? "register" : "vinculation",
						"cd[reg_origin]": typeof data.registerOrigin != "undefined" ? data.registerOrigin : "", 
						"cd[reg_prod_origin]": typeof data.registerProd != "undefined" ? data.registerProd : "",
						"cd[reg_type]": eventType == DTM.events.UUVINC ? "vinculation" : ((data.registerType != "undefined") ? (data.registerType == "clasico" ? "classic" : "social(" + data.registerType + ")") : "")
					}, false, "ts");

				}

				//Notify
				if(trackedEvent)
					DTM.notify("Event <" + eventType + "> tracked in tool <Facebook>");
				
				//Effect
				DTM.events.setEffect(eventID, "facebook", trackedEvent);

				return trackedEvent;
			}
		},
		elpais:{
			enabled: 1,
			dl: {},
			trackType: -1,
			trackedPV: false,
			eventQueue: [],
			eventRequired: false,
			eventRequiredFired: false,
			map:{
				events:{},
				vars:{}
			},
			init: function(){
				//Enabled
				this.enabled = this.isEnabled();
				//Map
				this.createMap();
				//Track type, siempre en el delay
				this.trackType = DTM.tools.TRACK_DELAY;
				//Event Required, solamente se necesitar en pginas del paywall en web
				this.eventRequired = this.getEventRequired();
				
				//Creacin del Data Layer
				this.setDL({
					"img": null,
					"src": {
						"realTime": (_satellite.environment.stage != "production" || !_satellite.getVar("validPage")) ? "https://tracker.dev.datanoticias.prisasd.com/pixel.png" : "https://tracker.datanoticias.prisasd.com/pixel.png",
						"pep": "//pxlctl.elpais.com/pxlctl.gif",
						"cloudfront": "//d30wo2lffetbp8.cloudfront.net/"
					},
					"realTime": {
						"piid": "not-set",
						"pn": _satellite.getVar("pageName"),
						"g": _satellite.getVar("destinationURL"),
						"ch": _satellite.getVar("primaryCategory"),
						"tit": _satellite.getVar("pageTitle"),
						"typ": _satellite.getVar("pageType"),
						"h": _satellite.getVar("server"),
						"r": _satellite.getVar("referringURL"),
						"cms": _satellite.getVar("cms"),
						"edc": "not-set",
						"edn": _satellite.getVar("editionNavigation"),
						"ts": this.getTimeStamp(),
						"co": "not-set",
						"sys": _satellite.getVar("sysEnv"),
						"arcid": "not-set",
						"uid": "not-set",
						"aid": "not-set",
						"ust": "not-set",
						"usty": "not-set",
						"ustamp": "not-set",
						"pwt": "not-set",
						"pws": "not-set",
						"pwp": "not-set",
						"pwstep": "not-set",
						"pwact": "not-set",
						"pwcou": "not-set",
						"pwad": "not-set",
						"pwmod": "not-set"
					}
				});
			},
			createMap: function(){
				this.map.events[DTM.events.PHOTOGALLERY] = "photogallery";
				this.map.events[DTM.events.SCROLLINF] = "scrollInf";
				this.map.events[DTM.events.RECOMMENDERIMPRESSION] = "r";
				this.map.events[DTM.events.INTERNALPIXEL] = "internalPixel";
				this.map.events[DTM.events.USERREGISTER] = "okreg";
				this.map.events[DTM.events.USERLOGIN] = "oklog";
				this.map.events[DTM.events.READARTICLE] = "readArticle";

				this.map.vars["recommenderTime1"] = "t1";
				this.map.vars["recommenderTime"] = "t";
				this.map.vars["recommenderError"] = "e";
				this.map.vars["recommenderTo"] = "to";
				this.map.vars["recommenderS"] = "s";
				this.map.vars["userID"] = "u";
				this.map.vars["registerType"] = "rgt";
				this.map.vars["registerOrigin"] = "rgo";
				this.map.vars["registerProd"] = "rgp";
			},
			getDL: function(){
				return this.dl;
			},
			setDL: function(dl){
				this.dl = dl;
			},
			isEnabled: function(){
				var ep_enabled = (typeof DTM.config.ep_enabled != "undefined") ? DTM.config.ep_enabled : DTM.tools.allowAll;

				//No Widgets
				if(ep_enabled && _satellite.getVar("platform") == DTM.PLATFORM.WIDGET)
					ep_enabled = false;
				ep_enabled = ep_enabled ? DTM.tools.ENABLED : DTM.tools.DISABLED;
				
				return ep_enabled;
			},
			getEventRequired: function(){
				var eventRequired = false;
				//Paywall
				if(typeof DTM.paywallActive != "undefined" && DTM.paywallActive === true)
					eventRequired = "DTMPaywallActive";
				//Signwall
				else if(_satellite.getVar("paywall:signwallType") == "reg" && _satellite.getVar("platform") != DTM.PLATFORM.AMP)
					eventRequired = "DTMSignwallActive";

				return eventRequired;
			},
			getTimeStamp: function(pv){
				var ts = "";
				if(pv)
					ts = _satellite.getVar("date:fullYear") + "/" + _satellite.getVar("date:month")  + "/" + _satellite.getVar("date:day") + "T" + _satellite.getVar("date:hours") + ":" + _satellite.getVar("date:minutes")  + ":" + _satellite.getVar("date:seconds");
				else{
					var dateEvent = new Date();
					ts = dateEvent.getFullYear() + "/" + DTM.utils.formatDate(dateEvent.getMonth() + 1)  + "/" + DTM.utils.formatDate(dateEvent.getDate()) + "T" + DTM.utils.formatDate(dateEvent.getHours()) + ":" + DTM.utils.formatDate(dateEvent.getMinutes()) + ":" + DTM.utils.formatDate(dateEvent.getSeconds());
				}
				return ts;
			},
			trackPV: function(){
				//Si no est habilitada o ya se ha marcado, no se marca
				if(this.enabled != DTM.tools.ENABLED || this.trackedPV)
					return false;
				//Si se requiere un evento y no se ha lanzado o se ha lanzado antes de tiempo, no se marca
				if((this.eventRequired !== false && !this.eventRequiredFired) || (this.eventRequired !== false && !DTM.dataLayer.timeOutCompleted))
					return false;

				var ep_dl = this.getDL();
				
				//Parmetros que no se pueden recoger en el init
				ep_dl.realTime.piid = _satellite.getVar("pageInstanceID");
				ep_dl.realTime.pn =_satellite.getVar("pageName");
				ep_dl.realTime.g = _satellite.getVar("destinationURL");
				ep_dl.realTime.ch = _satellite.getVar("primaryCategory");
				ep_dl.realTime.tit = _satellite.getVar("pageTitle");
				ep_dl.realTime.typ = _satellite.getVar("pageType");
				ep_dl.realTime.h = _satellite.getVar("server");
				ep_dl.realTime.r = _satellite.getVar("referringURL");
				ep_dl.realTime.cms = _satellite.getVar("cms");
				ep_dl.realTime.sys = _satellite.getVar("sysEnv");
				ep_dl.realTime.ts = this.getTimeStamp();
				ep_dl.realTime.edc = "";
				ep_dl.realTime.edn = _satellite.getVar("editionNavigation");
				//User
				ep_dl.realTime.aid = _satellite.getVar("user:experienceCloudID")
				ep_dl.realTime.uid =  _satellite.getVar("user:profileID");
				ep_dl.realTime.co = _satellite.getVar("user:country");
				ep_dl.realTime.ust = _satellite.getVar("user:registeredUser");
				ep_dl.realTime.ustamp = _satellite.getVar("user:registeredUserAMP");
				ep_dl.realTime.usty = _satellite.getVar("user:type");
				//Paywall
				ep_dl.realTime.pwt = _satellite.getVar("paywall:signwallType");
				ep_dl.realTime.pws = _satellite.getVar("paywall:contentBlocked") == "1" ? "cerrado" : "abierto";
				ep_dl.realTime.pwp = _satellite.getVar("user:subscriptions");
				ep_dl.realTime.pwstep = "";
				ep_dl.realTime.pwact = _satellite.getVar("paywall:active") === "1" ? "activo" : "inactivo";
				ep_dl.realTime.pwcou = _satellite.getVar("paywall:counter");
				ep_dl.realTime.pwad = _satellite.getVar("paywall:contentAdType");
				ep_dl.realTime.pwmod = _satellite.getVar("paywall:type") != "" ? _satellite.getVar("paywall:type") : "";

				//Formamos el objeto de datos a enviar
				var ep_params = DTM.utils.copyObject(ep_dl.realTime);
				ep_params["ev"] = "pageView";

				//Creacin y peticin
				//ViewContent
				this.trackedPV = DTM.utils.sendBeacon(ep_dl.src.realTime, ep_params, false, "rnd");

				//Vaciamos la cola de eventos
				for(var eventQ in this.eventQueue)
					this.trackEvent(eventQ);
				
			},
			trackEvent: function(eventID){

				//Marcaremos si no est deshabilitado
				if(this.enabled == DTM.tools.DISABLED){
					DTM.events.setEffect(eventID, "elpais", false);
					return false;
				}

				//Event from data layer
				if(typeof _satellite.getVar("event")[eventID] == "undefined"){
					DTM.notify("EL PAIS event past not valid <" + eventType + ">", "error");
					return false;
				}
				
				var eventType = _satellite.getVar("event")[eventID].eventInfo.eventName;
				var data = _satellite.getVar("event")[eventID].attributes;
				var ep_dl = this.getDL();
				var trackedEvent = false;

				//Mapping event, si no est mapeado no lo marcamos
				if(!this.map.events.hasOwnProperty(eventType)){
					DTM.events.setEffect(eventID, "elpais", false);
					return false;
				}

				var evento = this.map.events[eventType];

				switch(eventType){
					//Pixel para PEP
					case DTM.events.PHOTOGALLERY:
					case DTM.events.SCROLLINF:
						//Si existe user.js, si no existe lo lanzamos a mano (Wordpress)
						if(typeof PRISA != "undefined" && typeof PRISA.user != "undefined" && typeof PRISA.user.trackAgain != "undefined"){
							PRISA.user.trackAgain();
							trackedEvent = true;
						}else
							trackedEvent = DTM.utils.sendBeacon(ep_dl.src.pep, {}, false, "empty");
						
						break;
					//Solo para el pixel de Real-Time
					case DTM.events.USERREGISTER:
					case DTM.events.USERLOGIN:
					case DTM.events.READARTICLE:
						//Si la pgina no marc, lo aadimos a la cola de eventos.
						if(this.isEnabled == DTM.tools.ENABLED && !this.trackedPV){
							this.eventQueue.push(eventID);
							return false;
						}
						//Recargamos el timeStamp
						ep_dl.realTime.ts = this.getTimeStamp();

						//Formamos los parmetros del DL
						var ep_params = DTM.utils.copyObject(ep_dl.realTime);
						ep_params["ev"] = evento;

						//Mapeamos los que hayan podido llegar por DTM.trackEvent
						for(var dataKey in this.map.vars)
							if(data.hasOwnProperty(dataKey))
								ep_params[this.map.vars[dataKey]] = data[dataKey];

						trackedEvent = DTM.utils.sendBeacon(ep_dl.src.realTime, ep_params, false, "rnd");

						break;
					//Pixel de Cloudfront
					case DTM.events.INTERNALPIXEL:
					case DTM.events.RECOMMENDERIMPRESSION:
						//Objeto a enviar
						var ep_params = [];
						//Channel

						ep_params.ch = _satellite.getVar("primaryCategory");
						//PUCI, si no se pasa ponemos la del Data Layer
						if(!data.hasOwnProperty("userID"))
							data.userID = _satellite.getVar("user:profileID");
						//Parmetros extra
						if(typeof data.extraParams == "object")
							for(var extraParam in data.extraParams)
								ep_params[extraParam] = data.extraParams[extraParam]

						//vars from data, mapping
						for(var dataKey in this.map.vars)
							if(data.hasOwnProperty(dataKey))
								ep_params[this.map.vars[dataKey]] = (this.map.vars[dataKey] == "e" ? data[dataKey].toUpperCase() : data[dataKey]);

						//Nombre del GIF es el evento mapeado
						var evento = (data.hasOwnProperty("pixelName")) ? data.pixelName : "r";
						
						//Creacin y peticin
						trackedEvent = DTM.utils.sendBeacon(ep_dl.src.cloudfront + encodeURIComponent(evento) + ".gif", ep_params, false, false, false);

						break;
					default:
						trackedEvent = false;
				}

				//Notify
				if(trackedEvent)
					DTM.notify("Event <" + eventType + "> tracked in tool <EL PAIS>");

				DTM.events.setEffect(eventID, "elpais", trackedEvent);
			}
		},
		google:{
			enabled: true,
			dl: {},
			consents: -1,
			consentsID: "google",
			trackType: -1,
			trackedPV: false,
			init: function(){
				//Enabled
				this.enabled = this.isEnabled();
				//Track type
				this.trackType = DTM.tools.TRACK_TOP;
				//Consents
				this.consents = DTM.CONSENTS.DEFAULT;
				//Creacin del Data Layer
				this.setDL({
					"src": "//googleads.g.doubleclick.net/pagead/viewthroughconversion/",
					"id": 965296472,
					"idMX": 802913665
				});
			},
			getDL: function(){
				return this.dl;
			},
			setDL: function(dl){
				this.dl = dl;
			},
			isEnabled: function(){
				var goo_enabled = (typeof DTM.config.goo_enabled != "undefined") ? DTM.config.goo_enabled : DTM.tools.allowAll;

				//No AMP, IA ni Widget
				if(goo_enabled && (_satellite.getVar("platform") == DTM.PLATFORM.AMP || _satellite.getVar("platform") == DTM.PLATFORM.FBIA || _satellite.getVar("platform") == DTM.PLATFORM.WIDGET))
					goo_enabled = false;

				goo_enabled = (goo_enabled) ? DTM.tools.ENABLED : DTM.tools.DISABLED;
				
				return goo_enabled;
			},
			trackPV: function(){
				if(this.enabled != DTM.tools.ENABLED || this.consents !== DTM.CONSENTS.ACCEPT)
					return false;

				var google_dl = this.getDL();
				var trackedPV = false;

				//Pixel para todas las pginas de EP
				trackedPV = DTM.utils.sendBeacon(google_dl.src + google_dl.id + "/", {"value": "0", "guid": "ON", "script": "0"}, false, "rnd");

				//Pixel para IP Mxico
				if(_satellite.getVar("user:country") == "mx"){
					var trackedPVMX = DTM.utils.sendBeacon(google_dl.src + google_dl.idMX + "/", {"value": "0", "guid": "ON", "script": "0"}, false, "rnd");
					trackedPV = trackedPV && trackedPVMX;
				}

				this.trackedPV = trackedPV;
			}
		}
	},
	/**
	* Funcin para el marcado de pgina vista teniendo en cuenta los consentimientos GDPR
	* @param tool string con el nombre de la tool a marcar, la tool se buscar en DTM.tools
	* @param message mensaje a mostrar en DTM.notify tras el marcado de pgina vista
	*/
	trackGDPRPV: function(tool, message){
		//ID del vendor, extrado de la propiedad consents de cada tool
		var consentsID = DTM.tools[tool].consentsID;

		//El objeto Didomi puede estar cargado o no (asincrono), si est cargado marcamos
		if(typeof Didomi != "undefined" && typeof Didomi.getObservableOnUserConsentStatusForVendor == "function"){
			//Si est nos suscribimos al callback del vendor correspondiente
			Didomi.getObservableOnUserConsentStatusForVendor(consentsID).subscribe(function (consentStatus){
				//En la primera carga los consents son undefined
				DTM.tools[tool].consents = typeof consentStatus == "undefined" ? DTM.CONSENTS.WAITING : (consentStatus === true ? DTM.CONSENTS.ACCEPT : DTM.CONSENTS.REJECT);
				//Marcamos pgina vista una vez actualizado el DTM.tools[tool].consents
	        	var tracked = DTM.tools[tool].trackPV();
				if(tracked !== false)
					DTM.notify("PV tracked in tool <" + tool + "> (" + message + ")");	
		    });
		//Si no est, pero se le espera nos enganchamos a su onReady
		}else if(typeof window.gdprAppliesGlobally != "undefined"){
			(function(tool){
				//Didomi dispone de una cola de eventos, hacemos un push a esa cola con nuestro marcado de pgina. Cuando llegue Didomi ejecutar el cdigo
				window.didomiOnReady = window.didomiOnReady || [];
		        window.didomiOnReady.push(function(consentID){
		        	//En el callback suscribimos al callback del vendor correspondiente
		            Didomi.getObservableOnUserConsentStatusForVendor(consentsID).subscribe(function (consentStatus){
						//En la primera carga los consents son undefined
						DTM.tools[tool].consents = typeof consentStatus == "undefined" ? DTM.CONSENTS.WAITING : (consentStatus === true ? DTM.CONSENTS.ACCEPT : DTM.CONSENTS.REJECT);
			        	//Marcamos pgina vista una vez actualizado el DTM.tools[tool].consents
			        	var tracked = DTM.tools[tool].trackPV();
						if(tracked !== false)
							DTM.notify("PV tracked in tool <" + tool + "> (" + message + " delayed)");	
				    });
		        });
			})(tool);
		//Si no est y no se le espera (window.gdprAppliesGlobally no est en pgina) marcamos con los consentimientos por defecto
		}else{
			//Seteamos los consentimientos por defecto
			DTM.tools[tool].consents = DTM.CONSENTS.DEFAULT;
        	//Marcamos pgina vista una vez actualizado el DTM.tools[tool].consents
        	DTM.tools[tool].trackPV();
		}
	},
	trackPV: function(){
		if(!DTM.tools.initialized){
			this.notify("Uninitialized tools");
			return;
		}
		
		var trackDelay = {};

		//Las que marquen en el TOP lo hacen inmediatamente, las que sean delay las guardamos en un objeto para lanzarlas con el timeOut
		for(var tool in this.tools){
			if(typeof this.tools[tool] == "object"){
				switch(this.tools[tool].trackType){
					case DTM.tools.TRACK_TOP:
						//GDPR
						//La tool necesita conocer los consentimientos sobre GDPR (tiene el parmetro consentsID) asi que se liga la ejecucin al callback de Didomi
						//Necesitamos que la librera de Didomi est instalada en la pgina (antes de cargar DTM) lo comprobamos con la variable gdprAppliesGlobally
						if(typeof this.tools[tool].consentsID != "undefined" && typeof window.gdprAppliesGlobally != "undefined"){
							DTM.trackGDPRPV(tool, "consents");
						//Si no necesita consentimientos o Didomi no est instalado en la pgina, marcamos inmediatamente
						}else{
							var tracked = DTM.tools[tool].trackPV();
							if(tracked !== false)
								DTM.notify("PV tracked in tool <" + tool + "> (immediate)");	
						}
						break;
					case DTM.tools.TRACK_DELAY:
						trackDelay[tool] = tool;
						break;
				}

				//Evento requerido para marcar
				if(typeof this.tools[tool].eventRequired != "undefined" && this.tools[tool].eventRequired !== false){
					(function (tool) {
						window.DTM.utils.addEvent(document, DTM.tools[tool].eventRequired, function(){
							window.DTM.tools[tool].eventRequiredFired = true;
							//GDPR
							//La tool necesita conocer los consentimientos sobre GDPR (tiene el parmetro consentsID) asi que se liga la ejecucin al callback de Didomi
							//Necesitamos que la librera de Didomi est instalada en la pgina (antes de cargar DTM) lo comprobamos con la variable gdprAppliesGlobally
							if(typeof DTM.tools[tool].consentsID != "undefined" && typeof window.gdprAppliesGlobally != "undefined"){
								DTM.trackGDPRPV(tool, "eventRequired:" + window.DTM.tools[tool].eventRequired + " + consents");
							//Si no necesita consentimientos o Didomi no est instalado en la pgina, marcamos inmediatamente
							}else{
								var tracked = DTM.tools[tool].trackPV();
								if(tracked !== false)
									window.DTM.notify("PV tracked in tool <" + tool + "> (eventRequired: " + window.DTM.tools[tool].eventRequired + ")");
							}
						});
					}(tool));
				}
			}
		}
		
		//Tools que marcan con delay, todas juntas
		(function (trackDelay) {
			window.setTimeout(function(){
				DTM.dataLayer.timeOutCompleted = true;
				for(var tool in trackDelay){
					//GDPR
					//La tool necesita conocer los consentimientos sobre GDPR (tiene el parmetro consentsID) asi que se liga la ejecucin al callback de Didomi
					//Necesitamos que la librera de Didomi est instalada en la pgina (antes de cargar DTM) lo comprobamos con la variable gdprAppliesGlobally
					if(typeof DTM.tools[tool].consentsID != "undefined" && typeof window.gdprAppliesGlobally != "undefined"){
						DTM.trackGDPRPV(tool, "delayed + consents");
					//Si no necesita consentimientos o Didomi no est instalado en la pgina, marcamos inmediatamente
					}else{
						var tracked = DTM.tools[tool].trackPV();
						if(tracked !== false)
							window.DTM.notify("PV tracked in tool <" + tool + "> (delayed)");
					}
				}
			}, DTM.dataLayer.timeOutTime);
		}(trackDelay));		
	},
	//Signwall
	trackPaywallPage: function(data){
		if(typeof data != "object" && !data.hasOwnProperty("status"))
			return false;

		if(DTM.paywallActive === false){
			this.dataLayer.setParam("paywall.signwallType", "reg");
			this.dataLayer.setParam("paywall.contentBlocked", data.status == "abierto" ? "0" : "1");
			this.dataLayer.setParam("paywall.contentAdType", data.status == "abierto" ? "none" : "signwall");
		}

		this.utils.dispatchEvent("DTMSignwallActive");
	},
	//Paywall
	trackPaywall: function(data){
		if(typeof data != "object")
			return false;

		//Si ya estn calculados los datos de usuario calculamos el paywall
		if(DTM.dataLayer.userInfoCompleted === true){
			DTM.dataLayer.sync = "event";
			DTM.dataLayer.setPaywallInfo(data);
			DTM.utils.dispatchEvent("DTMPaywallActive");
		//Sino esperamos al user
		}else{
			DTM.utils.addEvent(document, "DTMUserInfoCompleted", function(){
				DTM.dataLayer.sync = "event";
				DTM.dataLayer.setPaywallInfo(data);
				DTM.utils.dispatchEvent("DTMPaywallActive");
			});
		}	
	},
	trackEvent: function(eventType, data){
		this.notify("DTM.trackEvent fired <" + eventType + ">", true);
		if(typeof eventType != "string" || (typeof data != "undefined" && typeof data != "object"))
			return;

		if(!this.events.validEvent(eventType)){
			DTM.notify("Event not valid <" + eventType + ">");
			return;
		}

		//Widgets - Si es un widget envamos los eventos al padre para marcarlos desde all (si fuese un widget por iframe)
		if(_satellite.getVar("platform") == DTM.PLATFORM.WIDGET){
		    if(window.parent && window.parent.postMessage){
		   		var popup = window.parent;
		    	data["videoIframe"] = "iframe";
				popup.postMessage({"eventType": eventType,"data" : data}, "*");
		    }
			return;
		}

		//Parmetros del player obsoletos, los mapeamos
		var legacy_mediaParams = {
			"videoCreateSection": "mediaCreateSection",
			"videoDuration": "mediaDuration",
			"videoID": "mediaID",
			"videoName": "mediaName",
			"videoOrder": "mediaOrder",
			"videoRepMode": "mediaRepMode",
			"videoRepType": "mediaRepType",
			"videoSource": "mediaSource"
		};

		var dataClean = {};
		for(var param in data){
			if(legacy_mediaParams.hasOwnProperty(param))
				dataClean[legacy_mediaParams[param]] = data[param]; 
			else
				dataClean[param] = data[param];
		}

		data = this.utils.formatData(dataClean);

		//Add event to data layer
		var eventID = window.digitalData.event.length;
		window.digitalData.event.push({
			eventInfo:{
				eventName: eventType,
				eventAction: eventType,
				timeStamp: new Date(),
				effect: []
			},
			category:{
				primaryCategory: _satellite.getVar("primaryCategory"),
				subCategory1: _satellite.getVar("subCategory1"),
				pageType: _satellite.getVar("pageType")
			},
			attributes: data
		});
		
		//Track event in tools
		for(var tool in DTM.tools)
			if(typeof DTM.tools[tool] == "object" && typeof DTM.tools[tool].trackEvent == "function")
				DTM.tools[tool].trackEvent(eventID);	
	}
}

/**
 * Old functions, compatibilty with DTM
 **/
window.trackPublicarComentario = function() {
	DTM.trackEvent(DTM.events.COMMENTS);
}

//Iniciar DTM
DTM.init();